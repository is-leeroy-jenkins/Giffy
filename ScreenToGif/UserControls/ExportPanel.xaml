<UserControl
    x:Class="ScreenToGif.UserControls.ExportPanel"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:c="clr-namespace:ScreenToGif.Util.Converters;assembly=ScreenToGif.Util"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:e="clr-namespace:ScreenToGif.Domain.Enums;assembly=ScreenToGif.Domain"
    xmlns:i="clr-namespace:ScreenToGif.Controls.Items"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:n="clr-namespace:ScreenToGif.Controls"
    xmlns:p="clr-namespace:ScreenToGif.ViewModel.UploadPresets;assembly=ScreenToGif.ViewModel"
    xmlns:t="clr-namespace:ScreenToGif.Util.Settings;assembly=ScreenToGif.Util"
    xmlns:u="clr-namespace:ScreenToGif.Util.Converters"
    xmlns:uc="clr-namespace:ScreenToGif.UserControls"
    x:Name="ThisPanel"
    d:DesignHeight="450"
    d:DesignWidth="300"
    Focusable="False"
    IsTabStop="False"
    Loaded="Panel_Loaded"
    Unloaded="ExportPanel_Unloaded"
    mc:Ignorable="d">

    <UserControl.Resources>
        <c:SelectionCountToDescription x:Key="SelectionCountToDescription" />
        <c:ContentToVisibility x:Key="ContentToVisibility" />
        <u:PresetToSubViewModelConverter x:Key="PresetToSubViewModel" />

        <x:Array
            x:Key="ExportItemArray"
            Type="{x:Type i:ExportItem}">
            <!--  Animated Image  -->
            <i:ExportItem
                Title="{DynamicResource S.SaveAs.Apng}"
                Description="{DynamicResource S.SaveAs.Apng.Info}"
                ExportType="{DynamicResource S.SaveAs.Type.Animated}"
                FileType="{x:Static e:ExportFormats.Apng}"
                ImageId="Vector.Apng" />

            <i:ExportItem
                Title="{DynamicResource S.SaveAs.Gif}"
                Description="{DynamicResource S.SaveAs.Gif.Info}"
                ExportType="{DynamicResource S.SaveAs.Type.Animated}"
                FileType="{x:Static e:ExportFormats.Gif}"
                ImageId="Vector.Gif" />

            <i:ExportItem
                Title="{DynamicResource S.SaveAs.Webp}"
                Description="{DynamicResource S.SaveAs.Webp.Info}"
                ExportType="{DynamicResource S.SaveAs.Type.Animated}"
                FileType="{x:Static e:ExportFormats.Webp}"
                ImageId="Vector.Webp" />

            <!--  Video  -->
            <i:ExportItem
                Title="{DynamicResource S.SaveAs.Avi}"
                Description="{DynamicResource S.SaveAs.Avi.Info}"
                ExportType="{DynamicResource S.SaveAs.Type.Video}"
                FileType="{x:Static e:ExportFormats.Avi}"
                ImageId="Vector.Video" />

            <i:ExportItem
                Title="{DynamicResource S.SaveAs.Mkv}"
                Description="{DynamicResource S.SaveAs.Mkv.Info}"
                ExportType="{DynamicResource S.SaveAs.Type.Video}"
                FileType="{x:Static e:ExportFormats.Mkv}"
                ImageId="Vector.Video" />

            <i:ExportItem
                Title="{DynamicResource S.SaveAs.Mov}"
                Description="{DynamicResource S.SaveAs.Mov.Info}"
                ExportType="{DynamicResource S.SaveAs.Type.Video}"
                FileType="{x:Static e:ExportFormats.Mov}"
                ImageId="Vector.Video" />

            <i:ExportItem
                Title="{DynamicResource S.SaveAs.Mp4}"
                Description="{DynamicResource S.SaveAs.Mp4.Info}"
                ExportType="{DynamicResource S.SaveAs.Type.Video}"
                FileType="{x:Static e:ExportFormats.Mp4}"
                ImageId="Vector.Video" />

            <i:ExportItem
                Title="{DynamicResource S.SaveAs.Webm}"
                Description="{DynamicResource S.SaveAs.Webm.Info}"
                ExportType="{DynamicResource S.SaveAs.Type.Video}"
                FileType="{x:Static e:ExportFormats.Webm}"
                ImageId="Vector.Video" />

            <!--  Frames  -->
            <i:ExportItem
                Title="{DynamicResource S.SaveAs.Bmp}"
                Description="{DynamicResource S.SaveAs.Bmp.Info}"
                ExportType="{DynamicResource S.SaveAs.Type.Frames}"
                FileType="{x:Static e:ExportFormats.Bmp}"
                ImageId="Vector.Bmp" />

            <i:ExportItem
                Title="{DynamicResource S.SaveAs.Jpeg}"
                Description="{DynamicResource S.SaveAs.Jpeg.Info}"
                ExportType="{DynamicResource S.SaveAs.Type.Frames}"
                FileType="{x:Static e:ExportFormats.Jpeg}"
                ImageId="Vector.Jpeg" />

            <i:ExportItem
                Title="{DynamicResource S.SaveAs.Png}"
                Description="{DynamicResource S.SaveAs.Png.Info}"
                ExportType="{DynamicResource S.SaveAs.Type.Frames}"
                FileType="{x:Static e:ExportFormats.Png}"
                ImageId="Vector.Apng" />

            <!--  Other  -->
            <i:ExportItem
                Title="{DynamicResource S.SaveAs.Project}"
                Description="{DynamicResource S.SaveAs.Project.Info}"
                ExportType="{DynamicResource S.SaveAs.Type.Other}"
                FileType="{x:Static e:ExportFormats.Stg}"
                ImageId="Vector.Project" />

            <i:ExportItem
                Title="{DynamicResource S.SaveAs.Psd}"
                Description="{DynamicResource S.SaveAs.Psd.Info}"
                ExportType="{DynamicResource S.SaveAs.Type.Other}"
                FileType="{x:Static e:ExportFormats.Psd}"
                ImageId="Vector.Psd" />
        </x:Array>

        <CollectionViewSource
            x:Key="CollectionViewSource"
            Source="{StaticResource ExportItemArray}">
            <CollectionViewSource.GroupDescriptions>
                <PropertyGroupDescription PropertyName="ExportType" />
            </CollectionViewSource.GroupDescriptions>
        </CollectionViewSource>
    </UserControl.Resources>

    <Grid
        x:Name="MainGrid"
        DataContext="{Binding ElementName=ThisPanel, Path=CurrentPreset, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <Expander
            Grid.Row="0"
            Header="{DynamicResource S.SaveAs.Type}"
            IsExpanded="{Binding IsSaveTypeExpanded, Source={x:Static t:UserSettings.All}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <ComboBox
                    x:Name="TypeComboBox"
                    Grid.Row="0"
                    Height="38"
                    Margin="10,3,5,3"
                    VerticalAlignment="Center"
                    ItemTemplate="{StaticResource Template.ComboBox.Simple}"
                    ItemsSource="{Binding Source={StaticResource CollectionViewSource}}"
                    SelectedValue="{Binding SaveType, Source={x:Static t:UserSettings.All}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                    SelectedValuePath="FileType"
                    SelectionChanged="TypeComboBox_SelectionChanged"
                    ToolTip="{DynamicResource S.SaveAs.Type.Format}">

                    <ComboBox.GroupStyle>
                        <GroupStyle>
                            <GroupStyle.HeaderTemplate>
                                <DataTemplate>
                                    <n:LabelSeparator Text="{Binding Name}" />
                                </DataTemplate>
                            </GroupStyle.HeaderTemplate>
                        </GroupStyle>
                    </ComboBox.GroupStyle>
                </ComboBox>

                <ComboBox
                    x:Name="PresetComboBox"
                    Grid.Row="1"
                    Height="38"
                    Margin="10,3,5,3"
                    VerticalAlignment="Center"
                    ItemTemplate="{StaticResource Template.ComboBox.Simple}"
                    SelectionChanged="PresetComboBox_SelectionChanged"
                    ToolTip="{DynamicResource S.SaveAs.Type.Preset}" />

                <Grid
                    Grid.Row="2"
                    Height="35"
                    Margin="5,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition Width="30" />
                        <ColumnDefinition Width="30" />
                        <ColumnDefinition Width="30" />
                        <ColumnDefinition Width="30" />
                        <ColumnDefinition Width="30" />
                    </Grid.ColumnDefinitions>

                    <Border
                        Grid.Column="0"
                        Margin="5,0"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center"
                        Background="{DynamicResource Brush.StatusBand.Info}"
                        CornerRadius="3"
                        ToolTip="{DynamicResource S.Preset.Autosave.Info}"
                        Visibility="{Binding ElementName=PresetComboBox, Path=SelectedItem.HasAutoSave, Converter={StaticResource Bool2Visibility}}">
                        <TextBlock
                            Margin="3,0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.Preset.Autosave}" />
                    </Border>

                    <n:ExtendedButton
                        x:Name="AddPresetButton"
                        Grid.Column="1"
                        Click="AddPreset_Click"
                        ContentHeight="15"
                        ContentWidth="15"
                        Icon="{StaticResource Vector.Add}"
                        Style="{StaticResource Style.Button.NoText}"
                        ToolTip="{DynamicResource S.SaveAs.Presets.Add}"
                        ToolTipService.Placement="Bottom" />
                    <n:ExtendedButton
                        x:Name="SavePresetButton"
                        Grid.Column="2"
                        Click="SavePreset_Click"
                        ContentHeight="15"
                        ContentWidth="15"
                        Icon="{StaticResource Vector.Save}"
                        IsEnabled="{Binding ElementName=PresetComboBox, Path=SelectedItem.HasAutoSave, Converter={StaticResource InvertedBool}}"
                        Style="{StaticResource Style.Button.NoText}"
                        ToolTip="{DynamicResource S.SaveAs.Presets.Save}"
                        ToolTipService.Placement="Bottom" />
                    <n:ExtendedButton
                        x:Name="EditPresetButton"
                        Grid.Column="3"
                        Click="EditPreset_Click"
                        ContentHeight="15"
                        ContentWidth="15"
                        Icon="{StaticResource Vector.Pen}"
                        Style="{StaticResource Style.Button.NoText}"
                        ToolTip="{DynamicResource S.SaveAs.Presets.Edit}"
                        ToolTipService.Placement="Bottom" />
                    <n:ExtendedButton
                        x:Name="RemovePresetButton"
                        Grid.Column="4"
                        Click="RemovePreset_Click"
                        ContentHeight="15"
                        ContentWidth="15"
                        Icon="{StaticResource Vector.Remove}"
                        IsEnabled="{Binding ElementName=PresetComboBox, Path=SelectedItem.IsDefault, Converter={StaticResource InvertedBool}}"
                        Style="{StaticResource Style.Button.NoText}"
                        ToolTip="{DynamicResource S.SaveAs.Presets.Remove}"
                        ToolTipService.Placement="Bottom" />
                    <n:ExtendedButton
                        x:Name="ResetPresetButton"
                        Grid.Column="5"
                        Click="ResetPreset_Click"
                        ContentHeight="15"
                        ContentWidth="15"
                        Icon="{StaticResource Vector.Repeat}"
                        IsEnabled="{Binding ElementName=PresetComboBox, Path=SelectedItem.IsDefault, FallbackValue=False}"
                        Style="{StaticResource Style.Button.NoText}"
                        ToolTip="{DynamicResource S.SaveAs.Presets.Reset}"
                        ToolTipService.Placement="Bottom" />
                </Grid>
            </Grid>
        </Expander>

        <Expander
            x:Name="EncoderExpander"
            Grid.Row="1"
            Header="{DynamicResource S.SaveAs.Encoder}"
            IsExpanded="{Binding IsEncoderExpanded, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <ComboBox
                    x:Name="EncoderComboBox"
                    Grid.Row="0"
                    Height="38"
                    Margin="10,3,5,3"
                    VerticalAlignment="Center"
                    ItemTemplate="{StaticResource Template.ComboBox.Simple}"
                    SelectedValuePath="Value"
                    SelectionChanged="EncoderComboBox_SelectionChanged"
                    ToolTip="{DynamicResource S.SaveAs.Encoder.Info}">
                    <ComboBox.ItemContainerStyle>
                        <Style TargetType="ComboBoxItem">
                            <Style.Triggers>
                                <DataTrigger
                                    Binding="{Binding IsEnabled}"
                                    Value="False">
                                    <Setter Property="Visibility" Value="Collapsed" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ComboBox.ItemContainerStyle>

                    <i:GenericItem
                        x:Name="EncoderScreenToGifItem"
                        Title="ScreenToGif"
                        Description="{DynamicResource S.SaveAs.Encoder.ScreenToGif.Info}"
                        ImageId="Vector.Logo"
                        Value="{x:Static e:EncoderTypes.ScreenToGif}" />

                    <i:GenericItem
                        x:Name="EncoderKGySoftItem"
                        Title="KGy SOFT"
                        Description="{DynamicResource S.SaveAs.Encoder.KGySoft.Info}"
                        ImageId="Vector.KGySoft"
                        Value="{x:Static e:EncoderTypes.KGySoft}" />

                    <i:GenericItem
                        x:Name="EncoderFfmpegItem"
                        Title="FFmpeg"
                        Description="{DynamicResource S.SaveAs.Encoder.Ffmpeg.Info}"
                        ImageId="Vector.Ffmpeg"
                        Value="{x:Static e:EncoderTypes.FFmpeg}" />

                    <i:GenericItem
                        x:Name="EncoderGifskiItem"
                        Title="Gifski"
                        Description="{DynamicResource S.SaveAs.Encoder.Gifski.Info}"
                        ImageId="Vector.Gifski"
                        Value="{x:Static e:EncoderTypes.Gifski}" />

                    <i:GenericItem
                        x:Name="EncoderSystemItem"
                        Title="System"
                        Description="{DynamicResource S.SaveAs.Encoder.System.Info}"
                        ImageId="Vector.Net"
                        Value="{x:Static e:EncoderTypes.System}" />
                </ComboBox>

                <ComboBox
                    x:Name="QuantizerComboBox"
                    Grid.Row="1"
                    Height="38"
                    Margin="10,3,5,3"
                    VerticalAlignment="Center"
                    ItemTemplate="{StaticResource Template.ComboBox.Simple}"
                    SelectedValue="{Binding Quantizer}"
                    SelectedValuePath="QuantizationType"
                    SelectionChanged="QuantizerComboBox_SelectionChanged"
                    ToolTip="{DynamicResource S.SaveAs.GifOptions.Quantizer.Info}"
                    Visibility="Collapsed">

                    <i:QuantizationMethodItem
                        Title="{DynamicResource S.SaveAs.GifOptions.Quantizer.Neural}"
                        Description="{DynamicResource S.SaveAs.GifOptions.Quantizer.Neural.Info}"
                        ImageId="Vector.Encoder.HighFidelity"
                        QuantizationType="{x:Static e:ColorQuantizationTypes.Neural}" />

                    <i:QuantizationMethodItem
                        Title="{DynamicResource S.SaveAs.GifOptions.Quantizer.Octree}"
                        Description="{DynamicResource S.SaveAs.GifOptions.Quantizer.Octree.Info}"
                        ImageId="Vector.Encoder.LowGraphics"
                        QuantizationType="{x:Static e:ColorQuantizationTypes.Octree}" />

                    <i:QuantizationMethodItem
                        Title="{DynamicResource S.SaveAs.GifOptions.Quantizer.MedianCut}"
                        Description="{DynamicResource S.SaveAs.GifOptions.Quantizer.MedianCut.Info}"
                        ImageId="Vector.Encoder.LowGraphics"
                        QuantizationType="{x:Static e:ColorQuantizationTypes.MedianCut}" />

                    <i:QuantizationMethodItem
                        Title="{DynamicResource S.SaveAs.GifOptions.Quantizer.Grayscale}"
                        Description="{DynamicResource S.SaveAs.GifOptions.Quantizer.Grayscale.Info}"
                        ImageId="Vector.Encoder.Grayscale"
                        QuantizationType="{x:Static e:ColorQuantizationTypes.Grayscale}" />

                    <i:QuantizationMethodItem
                        Title="{DynamicResource S.SaveAs.GifOptions.Quantizer.MostUsed}"
                        Description="{DynamicResource S.SaveAs.GifOptions.Quantizer.MostUsed.Info}"
                        ImageId="Vector.Encoder.MostUsed"
                        QuantizationType="{x:Static e:ColorQuantizationTypes.MostUsed}" />
                </ComboBox>
            </Grid>
        </Expander>

        <Expander
            x:Name="EncoderOptionsExpander"
            Grid.Row="2"
            Header="{DynamicResource S.SaveAs.Encoder.Options}"
            IsExpanded="{Binding IsEncoderOptionsExpanded, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
            <Grid x:Name="EncoderGrid">
                <!--  Apng  -->
                <Grid
                    x:Name="EmbeddedApngOptionsGrid"
                    Margin="10,0,0,0"
                    Visibility="Collapsed">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <n:ExtendedCheckBox
                        x:Name="ApngLoopedCheckBox"
                        Grid.Row="0"
                        Margin="0,3,3,3"
                        IsChecked="{Binding Looped}"
                        Text="{DynamicResource S.SaveAs.ApngOptions.Looped}" />

                    <Grid
                        Grid.Row="1"
                        Visibility="{Binding IsChecked, ElementName=ApngLoopedCheckBox, Converter={StaticResource Bool2Visibility}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="1*" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <n:ExtendedCheckBox
                            x:Name="ApngRepeatForeverCheckBox"
                            Grid.Row="0"
                            Grid.Column="0"
                            Grid.ColumnSpan="2"
                            Margin="10,3,3,3"
                            IsChecked="{Binding RepeatForever, Mode=TwoWay}"
                            Text="{DynamicResource S.SaveAs.GifOptions.RepeatForever}" />

                        <n:IntegerUpDown
                            x:Name="RepeatCountApngIntegerUpDown"
                            Grid.Row="1"
                            Grid.Column="0"
                            MinWidth="45"
                            Margin="10,3,3,3"
                            IsEnabled="{Binding IsChecked, ElementName=ApngRepeatForeverCheckBox, Converter={StaticResource InvertedBool}}"
                            Maximum="100"
                            Minimum="1"
                            StepValue="1"
                            Value="{Binding RepeatCount, Mode=TwoWay}" />
                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="1"
                            Margin="0,3"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            IsEnabled="{Binding IsChecked, ElementName=ApngRepeatForeverCheckBox, Converter={StaticResource InvertedBool}}"
                            Text="{DynamicResource S.SaveAs.GifOptions.RepeatCount}" />
                    </Grid>

                    <n:ExtendedCheckBox
                        x:Name="ApngDetectCheckBox"
                        Grid.Row="2"
                        Margin="0,3,3,3"
                        IsChecked="{Binding DetectUnchanged}"
                        Text="{DynamicResource S.SaveAs.ApngOptions.DetectUnchanged}" />

                    <n:ExtendedCheckBox
                        x:Name="ApngPaintTransparentCheckBox"
                        Grid.Row="3"
                        Margin="10,3,3,3"
                        IsChecked="{Binding PaintTransparent}"
                        Text="{DynamicResource S.SaveAs.ApngOptions.PaintTransparent}"
                        Visibility="{Binding ElementName=ApngDetectCheckBox, Path=IsChecked, Converter={StaticResource Bool2Visibility}}" />
                </Grid>

                <Grid
                    x:Name="FfmpegApngOptionsGrid"
                    Margin="10,0,0,0"
                    IsSharedSizeScope="True"
                    Visibility="Collapsed">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <!--  Mode  -->
                    <Grid Grid.Row="0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition
                                Width="Auto"
                                SharedSizeGroup="ModeSizeGroup" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>

                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.VideoOptions.Mode}" />
                        <ComboBox
                            Name="FfmpegApngModeComboBox"
                            Grid.Row="0"
                            Grid.Column="1"
                            Height="23"
                            Margin="5,3,3,3"
                            SelectedValue="{Binding SettingsMode}"
                            SelectedValuePath="Tag">
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Mode.Normal}"
                                Tag="{x:Static e:VideoSettingsModes.Normal}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Mode.Advanced}"
                                Tag="{x:Static e:VideoSettingsModes.Advanced}" />
                        </ComboBox>
                    </Grid>

                    <Grid
                        Grid.Row="1"
                        Visibility="{Binding SettingsMode, Converter={StaticResource EnumToVisibility}, ConverterParameter={x:Static e:VideoSettingsModes.Advanced}}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition
                                Width="Auto"
                                SharedSizeGroup="ModeSizeGroup" />
                            <ColumnDefinition />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="0"
                            Margin="0,6,0,0"
                            Padding="0"
                            VerticalAlignment="Top"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.Ffmpeg.Parameters}" />
                        <n:ExtendedTextBox
                            x:Name="FfmpegApngParameterTextBox"
                            Grid.Row="0"
                            Grid.Column="1"
                            MinHeight="23"
                            Margin="5,3,3,3"
                            VerticalContentAlignment="Top"
                            AcceptsReturn="True"
                            Text="{Binding Parameters}"
                            TextWrapping="Wrap"
                            ToolTip="{DynamicResource S.SaveAs.Ffmpeg.Parameters.Info}" />

                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="0"
                            Grid.ColumnSpan="3"
                            Margin="3,0"
                            VerticalAlignment="Center"
                            TextAlignment="Center">
                            <Hyperlink
                                NavigateUri="http://bing.com"
                                RequestNavigate="PreviewCommand_RequestNavigate"
                                ToolTip="{DynamicResource S.SaveAs.Ffmpeg.Preview.Info}">
                                <Run Text="{DynamicResource S.SaveAs.Ffmpeg.Preview}" />
                            </Hyperlink>
                            <Run
                                Foreground="{DynamicResource Element.Foreground}"
                                Text="/" />
                            <Hyperlink
                                NavigateUri="http://www.ffmpeg.org/ffmpeg-filters.html"
                                RequestNavigate="Hyperlink_RequestNavigate"
                                ToolTip="ffmpeg.org">
                                <Run Text="{DynamicResource S.SaveAs.Ffmpeg.Help.Filters}" />
                            </Hyperlink>
                        </TextBlock>
                    </Grid>

                    <Grid
                        Grid.Row="1"
                        Visibility="{Binding SettingsMode, Converter={StaticResource EnumToVisibility}, ConverterParameter={x:Static e:VideoSettingsModes.Normal}}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition
                                Width="Auto"
                                SharedSizeGroup="ModeSizeGroup" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <!--  Prediction methods  -->
                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.ApngOptions.Prediction}" />
                        <ComboBox
                            x:Name="FfmpegApngPreditionComboBox"
                            Grid.Row="0"
                            Grid.Column="1"
                            Grid.ColumnSpan="2"
                            Height="23"
                            Margin="5,3,3,3"
                            SelectedValue="{Binding PredictionMethod}"
                            SelectedValuePath="Tag">
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.ApngOptions.Prediction.None}"
                                Tag="{x:Static e:PredictionMethods.None}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.ApngOptions.Prediction.Sub}"
                                Tag="{x:Static e:PredictionMethods.Sub}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.ApngOptions.Prediction.Up}"
                                Tag="{x:Static e:PredictionMethods.Up}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.ApngOptions.Prediction.Average}"
                                Tag="{x:Static e:PredictionMethods.Avg}" />
                            <ComboBoxItem
                                Content="Paeth"
                                Tag="{x:Static e:PredictionMethods.Paeth}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.ApngOptions.Prediction.Mixed}"
                                Tag="{x:Static e:PredictionMethods.Mixed}" />
                        </ComboBox>
                        <n:ExtendedButton
                            x:Name="PredictionHelpButton"
                            Grid.Row="0"
                            Grid.Column="3"
                            Margin="0,3,3,3"
                            Click="PredictionHelpButton_Click"
                            ContentHeight="15"
                            ContentWidth="15"
                            Icon="{StaticResource Vector.Question}"
                            Style="{StaticResource Style.Button.NoText}"
                            ToolTip="{DynamicResource S.Documentation}" />

                        <!--  Pixel Format  -->
                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.VideoOptions.PixelFormat}" />
                        <ComboBox
                            x:Name="FfmpegApngPixelFormatComboBox"
                            Grid.Row="1"
                            Grid.Column="1"
                            Grid.ColumnSpan="3"
                            Height="23"
                            Margin="5,3,3,3"
                            SelectedValue="{Binding PixelFormat}"
                            SelectedValuePath="Tag">
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.PixelFormat.Auto}"
                                Tag="{x:Static e:VideoPixelFormats.Auto}" />
                            <ComboBoxItem
                                Content="Gray"
                                Tag="{x:Static e:VideoPixelFormats.Gray}" />
                            <ComboBoxItem
                                Content="Gray16Be"
                                Tag="{x:Static e:VideoPixelFormats.Gray16Be}" />
                            <ComboBoxItem
                                Content="MonoB"
                                Tag="{x:Static e:VideoPixelFormats.MonoB}" />
                            <ComboBoxItem
                                Content="Pal8"
                                Tag="{x:Static e:VideoPixelFormats.Pal8}" />
                            <ComboBoxItem
                                Content="Rgb24"
                                Tag="{x:Static e:VideoPixelFormats.Rgb24}" />
                            <ComboBoxItem
                                Content="RgbA"
                                Tag="{x:Static e:VideoPixelFormats.RgbA}" />
                            <ComboBoxItem
                                Content="Rgb48Be"
                                Tag="{x:Static e:VideoPixelFormats.Rgb48Be}" />
                            <ComboBoxItem
                                Content="Rgba64Be"
                                Tag="{x:Static e:VideoPixelFormats.Rgba64Be}" />
                            <ComboBoxItem
                                Content="Ya8"
                                Tag="{x:Static e:VideoPixelFormats.Ya8}" />
                            <ComboBoxItem
                                Content="Ya16Be"
                                Tag="{x:Static e:VideoPixelFormats.Ya16Be}" />
                        </ComboBox>

                        <!--  Framerate  -->
                        <TextBlock
                            Grid.Row="2"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.VideoOptions.Framerate}" />
                        <ComboBox
                            x:Name="FfmpegApngFramerateComboBox"
                            Grid.Row="2"
                            Grid.Column="1"
                            Grid.ColumnSpan="3"
                            Height="23"
                            Margin="5,3,3,3"
                            SelectedValue="{Binding Framerate}"
                            SelectedValuePath="Tag">
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.PixelFormat.Auto}"
                                Tag="{x:Static e:Framerates.Auto}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Framerate.Film}"
                                Tag="{x:Static e:Framerates.Film}" />
                            <ComboBoxItem
                                Content="PAL"
                                Tag="{x:Static e:Framerates.Pal}" />
                            <ComboBoxItem
                                Content="NTSC"
                                Tag="{x:Static e:Framerates.Ntsc}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Framerate.Custom}"
                                Tag="{x:Static e:Framerates.Custom}" />
                        </ComboBox>

                        <!--  Framerate  -->
                        <n:DoubleUpDown
                            x:Name="FfmpegApngFramerateIntegerUpDown"
                            Grid.Row="3"
                            Grid.Column="1"
                            MinWidth="80"
                            Margin="5,3,3,3"
                            Maximum="1000"
                            Minimum="1"
                            StepValue="1"
                            Visibility="{Binding Framerate, Converter={StaticResource EnumToVisibility}, ConverterParameter={x:Static e:Framerates.Custom}}"
                            Value="{Binding CustomFramerate, Mode=TwoWay}" />
                        <TextBlock
                            Grid.Row="3"
                            Grid.Column="2"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.Recorder.Fps.Short}"
                            Visibility="{Binding ElementName=FfmpegApngFramerateIntegerUpDown, Path=Visibility}" />

                        <!--  Loop  -->
                        <n:ExtendedCheckBox
                            x:Name="FfmpegApngLoopedCheckBox"
                            Grid.Row="4"
                            Grid.Column="0"
                            Grid.ColumnSpan="4"
                            Margin="0,3,3,3"
                            IsChecked="{Binding Looped}"
                            Text="{DynamicResource S.SaveAs.ApngOptions.Looped}" />

                        <Grid
                            Grid.Row="5"
                            Grid.Column="0"
                            Grid.ColumnSpan="4"
                            Visibility="{Binding IsChecked, ElementName=FfmpegApngLoopedCheckBox, Converter={StaticResource Bool2Visibility}}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="1*" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <n:ExtendedCheckBox
                                x:Name="FfmpegApngRepeatForeverCheckBox"
                                Grid.Row="0"
                                Grid.Column="0"
                                Grid.ColumnSpan="2"
                                Margin="10,3,3,3"
                                IsChecked="{Binding RepeatForever, Mode=TwoWay}"
                                Text="{DynamicResource S.SaveAs.GifOptions.RepeatForever}" />

                            <n:IntegerUpDown
                                x:Name="FfmpegRepeatCountApngIntegerUpDown"
                                Grid.Row="1"
                                Grid.Column="0"
                                MinWidth="45"
                                Margin="10,3,3,3"
                                IsEnabled="{Binding IsChecked, ElementName=FfmpegApngRepeatForeverCheckBox, Converter={StaticResource InvertedBool}}"
                                Maximum="100"
                                Minimum="1"
                                StepValue="1"
                                Value="{Binding RepeatCount, Mode=TwoWay}" />
                            <TextBlock
                                Grid.Row="1"
                                Grid.Column="1"
                                Margin="0,3"
                                Foreground="{DynamicResource Element.Foreground.Medium}"
                                IsEnabled="{Binding IsChecked, ElementName=FfmpegApngRepeatForeverCheckBox, Converter={StaticResource InvertedBool}}"
                                Text="{DynamicResource S.SaveAs.GifOptions.RepeatCount}" />
                        </Grid>
                    </Grid>
                </Grid>

                <!--  Gif  -->
                <Grid
                    x:Name="EmbeddedGifOptionsGrid"
                    Margin="10,0,0,0"
                    Visibility="Collapsed">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <!--  Sampling factor  -->
                    <TextBlock
                        x:Name="SamplingTextBlock"
                        Grid.Row="0"
                        Grid.Column="0"
                        Margin="0,3,3,3"
                        Padding="0"
                        VerticalAlignment="Center"
                        Foreground="{DynamicResource Element.Foreground.Medium}"
                        Text="{DynamicResource S.SaveAs.GifOptions.Sampling}"
                        ToolTip="{DynamicResource S.SaveAs.GifOptions.Sampling.Info}" />

                    <Slider
                        x:Name="SamplingFactorSlider"
                        Grid.Row="0"
                        Grid.Column="1"
                        Margin="0,3,3,0"
                        AutoToolTipPlacement="TopLeft"
                        IsMoveToPointEnabled="True"
                        IsSnapToTickEnabled="True"
                        Maximum="20"
                        Minimum="1"
                        SmallChange="1"
                        TickPlacement="BottomRight"
                        ToolTip="{DynamicResource S.SaveAs.GifOptions.Sampling.Info}"
                        Visibility="{Binding Visibility, ElementName=SamplingTextBlock, Mode=OneWay}"
                        Value="{Binding SamplingFactor, Mode=TwoWay}" />

                    <Grid
                        x:Name="SamplingFactorGrid"
                        Grid.Row="1"
                        Grid.Column="1"
                        Margin="0,0,3,3">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <TextBlock
                            Grid.Column="0"
                            FontSize="11">
                            <Run Text="1" />
                            <Run Text="•" />
                            <Run Text="{DynamicResource S.SaveAs.GifOptions.Best}" />
                        </TextBlock>

                        <TextBlock
                            Grid.Column="2"
                            FontSize="11">
                            <Run Text="{DynamicResource S.SaveAs.GifOptions.Fastest}" />
                            <Run Text="•" />
                            <Run Text="20" />
                        </TextBlock>
                    </Grid>

                    <!--  Color count  -->
                    <TextBlock
                        Grid.Row="2"
                        Grid.Column="0"
                        Margin="0,3,3,3"
                        Padding="0"
                        VerticalAlignment="Center"
                        Foreground="{DynamicResource Element.Foreground.Medium}"
                        Text="{DynamicResource S.SaveAs.GifOptions.Colors}" />
                    <n:IntegerUpDown
                        Grid.Row="2"
                        Grid.Column="1"
                        Width="80"
                        Margin="5"
                        HorizontalAlignment="Left"
                        Maximum="256"
                        Minimum="2"
                        ToolTip="{DynamicResource S.SaveAs.GifOptions.Colors.Info}"
                        Value="{Binding MaximumColorCount, Mode=TwoWay}" />

                    <!--  Global color table  -->
                    <n:ExtendedCheckBox
                        x:Name="GlobalColorTableCheckBox"
                        Grid.Row="3"
                        Grid.Column="0"
                        Grid.ColumnSpan="2"
                        Margin="0,3,3,3"
                        IsChecked="{Binding UseGlobalColorTable}"
                        Text="{DynamicResource S.SaveAs.GifOptions.GlobalColorTable}"
                        TextWrapping="Wrap"
                        ToolTip="{DynamicResource S.SaveAs.GifOptions.GlobalColorTable.Info}">
                        <n:ExtendedCheckBox.Visibility>
                            <MultiBinding Converter="{StaticResource BoolAndToVisibility}">
                                <Binding
                                    Converter="{StaticResource InvertedEnumToBool}"
                                    ConverterParameter="{x:Static e:ColorQuantizationTypes.Octree}"
                                    Path="ColorQuantization" />
                                <Binding
                                    Converter="{StaticResource InvertedEnumToBool}"
                                    ConverterParameter="{x:Static e:ColorQuantizationTypes.Grayscale}"
                                    Path="ColorQuantization" />
                            </MultiBinding>
                        </n:ExtendedCheckBox.Visibility>
                    </n:ExtendedCheckBox>

                    <!--  Loop  -->
                    <n:ExtendedCheckBox
                        x:Name="LoopedCheckBox"
                        Grid.Row="4"
                        Grid.Column="0"
                        Grid.ColumnSpan="2"
                        Margin="0,3,3,3"
                        IsChecked="{Binding Looped}"
                        Text="{DynamicResource S.SaveAs.GifOptions.Looped}" />

                    <Grid
                        Grid.Row="5"
                        Grid.Column="0"
                        Grid.ColumnSpan="2"
                        Visibility="{Binding ElementName=LoopedCheckBox, Path=IsChecked, Converter={StaticResource Bool2Visibility}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="1*" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <n:ExtendedCheckBox
                            x:Name="RepeatForeverCheckBox"
                            Grid.Row="0"
                            Grid.Column="0"
                            Grid.ColumnSpan="2"
                            Margin="10,3,3,3"
                            IsChecked="{Binding RepeatForever}"
                            Text="{DynamicResource S.SaveAs.GifOptions.RepeatForever}" />

                        <n:IntegerUpDown
                            x:Name="RepeatCountNumericUpDown"
                            Grid.Row="1"
                            Grid.Column="0"
                            MinWidth="45"
                            Margin="10,3,3,3"
                            IsEnabled="{Binding IsChecked, ElementName=RepeatForeverCheckBox, Converter={StaticResource InvertedBool}}"
                            Maximum="100"
                            Minimum="1"
                            StepValue="1"
                            Value="{Binding RepeatCount, Mode=TwoWay}" />
                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="1"
                            Margin="0,3"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            IsEnabled="{Binding IsChecked, ElementName=RepeatForeverCheckBox, Converter={StaticResource InvertedBool}}"
                            Text="{DynamicResource S.SaveAs.GifOptions.RepeatCount}" />
                    </Grid>

                    <!--  Transparency  -->
                    <n:ExtendedCheckBox
                        x:Name="EnableTransparencyCheckBox"
                        Grid.Row="6"
                        Grid.Column="0"
                        Grid.ColumnSpan="2"
                        Margin="0,3,3,3"
                        CheckedChanged="EnableTransparencyCheckBox_CheckedChanged"
                        IsChecked="{Binding EnableTransparency}"
                        Text="{DynamicResource S.SaveAs.GifOptions.Transparency.Enable}"
                        ToolTip="{DynamicResource S.SaveAs.GifOptions.Transparency.Enable.Info}" />

                    <Grid
                        Grid.Row="7"
                        Grid.Column="0"
                        Grid.ColumnSpan="2"
                        Margin="10,0,0,0"
                        Visibility="{Binding ElementName=EnableTransparencyCheckBox, Path=IsChecked, Converter={StaticResource Bool2Visibility}}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>

                        <n:ExtendedCheckBox
                            x:Name="SelectTransparentColorCheckBox"
                            Grid.Row="0"
                            Grid.Column="0"
                            Grid.ColumnSpan="3"
                            Margin="0,3,3,3"
                            IsChecked="{Binding SelectTransparencyColor}"
                            Text="{DynamicResource S.SaveAs.GifOptions.Transparency.Pick}"
                            ToolTip="{DynamicResource S.SaveAs.GifOptions.Transparency.Pick.Info}" />

                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="0"
                            Margin="10,0,0,0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.Caption.Color}"
                            Visibility="{Binding IsChecked, ElementName=SelectTransparentColorCheckBox, Converter={StaticResource Bool2Visibility}, Mode=OneWay}" />
                        <n:ColorBox
                            x:Name="TransparencyColorBox"
                            Grid.Row="1"
                            Grid.Column="1"
                            Width="100"
                            Margin="10,5"
                            SelectedColor="{Binding TransparencyColor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                            Visibility="{Binding IsChecked, ElementName=SelectTransparentColorCheckBox, Converter={StaticResource Bool2Visibility}, Mode=OneWay}" />
                    </Grid>

                    <!--  Detect unchanged pixels  -->
                    <n:ExtendedCheckBox
                        x:Name="DetectCheckBox"
                        Grid.Row="8"
                        Grid.Column="0"
                        Grid.ColumnSpan="2"
                        Margin="0,3,3,3"
                        IsChecked="{Binding DetectUnchanged}"
                        IsEnabled="{Binding EnableTransparency, Converter={StaticResource InvertedBool}}"
                        Text="{DynamicResource S.SaveAs.GifOptions.DetectUnchanged}"
                        ToolTip="{DynamicResource S.SaveAs.GifOptions.DetectUnchanged.Info}" />

                    <Grid
                        Grid.Row="9"
                        Grid.Column="0"
                        Grid.ColumnSpan="2"
                        Margin="10,0,0,0"
                        Visibility="{Binding ElementName=DetectCheckBox, Path=IsChecked, Converter={StaticResource Bool2Visibility}}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>

                        <n:ExtendedCheckBox
                            x:Name="PaintWithChromaCheckBox"
                            Grid.Row="0"
                            Grid.Column="0"
                            Grid.ColumnSpan="3"
                            Margin="0,3,3,3"
                            IsChecked="{Binding PaintTransparent}"
                            Text="{DynamicResource S.SaveAs.GifOptions.PaintWithChroma}"
                            TextWrapping="Wrap"
                            ToolTip="{DynamicResource S.SaveAs.GifOptions.PaintWithChroma.Info}" />

                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="0"
                            Margin="10,0,0,0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.GifOptions.ChromaKey}"
                            Visibility="{Binding IsChecked, ElementName=PaintWithChromaCheckBox, Converter={StaticResource Bool2Visibility}, Mode=OneWay}" />
                        <n:ColorBox
                            x:Name="ChromaKeyColorBox"
                            Grid.Row="1"
                            Grid.Column="1"
                            Width="100"
                            Margin="10,5"
                            SelectedColor="{Binding ChromaKey, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                            Visibility="{Binding IsChecked, ElementName=PaintWithChromaCheckBox, Converter={StaticResource Bool2Visibility}, Mode=OneWay}" />
                    </Grid>
                </Grid>

                <uc:KGySoftGifOptionsPanel
                    x:Name="KGySoftGifOptionsPanel"
                    Margin="10,0,0,0"
                    CurrentFrame="{Binding ElementName=ThisPanel, Path=CurrentFrame, Mode=OneWay}"
                    DataContext="{Binding Converter={StaticResource PresetToSubViewModel}}"
                    Visibility="Collapsed" />

                <Grid
                    x:Name="FfmpegGifOptionsGrid"
                    Margin="10,0,0,0"
                    IsSharedSizeScope="True"
                    Visibility="Collapsed">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <!--  Mode  -->
                    <Grid Grid.Row="0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition
                                Width="Auto"
                                SharedSizeGroup="ModeSizeGroup" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>

                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.VideoOptions.Mode}" />
                        <ComboBox
                            Name="FfmpegGifModeComboBox"
                            Grid.Row="0"
                            Grid.Column="1"
                            Height="23"
                            Margin="5,3,3,3"
                            SelectedValue="{Binding SettingsMode}"
                            SelectedValuePath="Tag"
                            ToolTip="{DynamicResource S.SaveAs.VideoOptions.Mode.Info}">
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Mode.Normal}"
                                Tag="{x:Static e:VideoSettingsModes.Normal}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Mode.Advanced}"
                                Tag="{x:Static e:VideoSettingsModes.Advanced}" />
                        </ComboBox>
                    </Grid>

                    <Grid
                        Grid.Row="1"
                        Visibility="{Binding SettingsMode, Converter={StaticResource EnumToVisibility}, ConverterParameter={x:Static e:VideoSettingsModes.Advanced}, FallbackValue=Collapsed}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition
                                Width="Auto"
                                SharedSizeGroup="ModeSizeGroup" />
                            <ColumnDefinition />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="0"
                            Margin="0,6,0,0"
                            Padding="0"
                            VerticalAlignment="Top"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.Ffmpeg.Parameters}" />
                        <n:ExtendedTextBox
                            x:Name="FfmpegGifParameterTextBox"
                            Grid.Row="0"
                            Grid.Column="1"
                            MinHeight="23"
                            Margin="5,3,3,3"
                            VerticalContentAlignment="Top"
                            AcceptsReturn="True"
                            Text="{Binding Parameters}"
                            TextWrapping="Wrap"
                            ToolTip="{DynamicResource S.SaveAs.Ffmpeg.Parameters.Info}" />

                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="0"
                            Grid.ColumnSpan="3"
                            Margin="3,0"
                            VerticalAlignment="Center"
                            TextAlignment="Center"
                            TextWrapping="Wrap">
                            <Hyperlink
                                NavigateUri="http://bing.com"
                                RequestNavigate="PreviewCommand_RequestNavigate"
                                ToolTip="{DynamicResource S.SaveAs.Ffmpeg.Preview.Info}">
                                <Run Text="{DynamicResource S.SaveAs.Ffmpeg.Preview}" />
                            </Hyperlink>
                            <Run
                                Foreground="{DynamicResource Element.Foreground}"
                                Text="/" />
                            <Hyperlink
                                NavigateUri="https://ffmpeg.org/ffmpeg-formats.html#gif-2"
                                RequestNavigate="Hyperlink_RequestNavigate">
                                <Run Text="{DynamicResource S.SaveAs.Ffmpeg.Help.Format}" />
                            </Hyperlink>
                            <Run
                                Foreground="{DynamicResource Element.Foreground}"
                                Text="/" />
                            <Hyperlink
                                NavigateUri="http://www.ffmpeg.org/ffmpeg-filters.html#palettegen-1"
                                RequestNavigate="Hyperlink_RequestNavigate">
                                <Run Text="{DynamicResource S.SaveAs.Ffmpeg.Help.Filters}" />
                            </Hyperlink>
                        </TextBlock>
                    </Grid>

                    <Grid
                        Grid.Row="1"
                        Visibility="{Binding SettingsMode, Converter={StaticResource EnumToVisibility}, ConverterParameter={x:Static e:VideoSettingsModes.Normal}}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition
                                Width="Auto"
                                SharedSizeGroup="ModeSizeGroup" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <!--  Dither  -->
                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.GifOptions.Dither}" />
                        <ComboBox
                            x:Name="FfmpegGifDitherComboBox"
                            Grid.Row="0"
                            Grid.Column="1"
                            Grid.ColumnSpan="2"
                            Height="23"
                            Margin="5,3,3,3"
                            SelectedValue="{Binding Dither}"
                            SelectedValuePath="Tag">
                            <ComboBoxItem
                                Content="Bayer"
                                Tag="{x:Static e:DitherMethods.Bayer}" />
                            <ComboBoxItem
                                Content="Heckbert"
                                Tag="{x:Static e:DitherMethods.Heckbert}" />
                            <ComboBoxItem
                                Content="Floyd Steinberg"
                                Tag="{x:Static e:DitherMethods.FloydSteinberg}" />
                            <ComboBoxItem
                                Content="Sierra 2"
                                Tag="{x:Static e:DitherMethods.Sierra2}" />
                            <ComboBoxItem
                                Content="Sierra 2 Lite"
                                Tag="{x:Static e:DitherMethods.Sierra2Lite}" />
                        </ComboBox>

                        <!--  Bayer scale  -->
                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.GifOptions.Dither.Scale}"
                            Visibility="{Binding ElementName=BayerScaleUpDown, Path=Visibility}" />
                        <n:IntegerUpDown
                            x:Name="BayerScaleUpDown"
                            Grid.Row="1"
                            Grid.Column="1"
                            Width="80"
                            Margin="5,3,3,3"
                            HorizontalAlignment="Left"
                            Maximum="5"
                            Minimum="0"
                            ToolTip="{DynamicResource S.SaveAs.GifOptions.Colors.Info}"
                            Visibility="{Binding Dither, Converter={StaticResource EnumToVisibility}, ConverterParameter={x:Static e:DitherMethods.Bayer}}"
                            Value="{Binding BayerScale, Mode=TwoWay}" />

                        <!--  Pixel Format  -->
                        <TextBlock
                            Grid.Row="2"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.VideoOptions.PixelFormat}" />
                        <ComboBox
                            x:Name="FfmpegGifPixelFormatComboBox"
                            Grid.Row="2"
                            Grid.Column="1"
                            Grid.ColumnSpan="2"
                            Height="23"
                            Margin="5,3,3,3"
                            SelectedValue="{Binding PixelFormat}"
                            SelectedValuePath="Tag">
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.PixelFormat.Auto}"
                                Tag="{x:Static e:VideoPixelFormats.Auto}" />
                            <ComboBoxItem
                                Content="Bgr4Byte"
                                Tag="{x:Static e:VideoPixelFormats.Bgr4Byte}" />
                            <ComboBoxItem
                                Content="Bgr8"
                                Tag="{x:Static e:VideoPixelFormats.Bgr8}" />
                            <ComboBoxItem
                                Content="Gray"
                                Tag="{x:Static e:VideoPixelFormats.Gray}" />
                            <ComboBoxItem
                                Content="Pal8"
                                Tag="{x:Static e:VideoPixelFormats.Pal8}" />
                            <ComboBoxItem
                                Content="Rgb4Byte"
                                Tag="{x:Static e:VideoPixelFormats.Rgb4Byte}" />
                            <ComboBoxItem
                                Content="Rgb8"
                                Tag="{x:Static e:VideoPixelFormats.Rgb8}" />
                        </ComboBox>

                        <!--  Vsync  -->
                        <TextBlock
                            Grid.Row="3"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.VideoOptions.Vsync}" />
                        <ComboBox
                            x:Name="FfmpegGifVsyncComboBox"
                            Grid.Row="3"
                            Grid.Column="1"
                            Grid.ColumnSpan="2"
                            Height="23"
                            Margin="5,3,3,3"
                            SelectedValue="{Binding Vsync}"
                            SelectedValuePath="Tag"
                            ToolTip="{DynamicResource S.SaveAs.VideoOptions.Vsync.Info}">
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.HardwareAcceleration.Off}"
                                Tag="{x:Static e:Vsyncs.Off}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.PixelFormat.Auto}"
                                Tag="{x:Static e:Vsyncs.Auto}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Vsync.Passthrough}"
                                Tag="{x:Static e:Vsyncs.Passthrough}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Vsync.Cfr}"
                                Tag="{x:Static e:Vsyncs.Cfr}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Vsync.Vfr}"
                                Tag="{x:Static e:Vsyncs.Vfr}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Vsync.Drop}"
                                Tag="{x:Static e:Vsyncs.Drop}" />
                        </ComboBox>

                        <!--  Framerate  -->
                        <TextBlock
                            Grid.Row="4"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.VideoOptions.Framerate}" />
                        <ComboBox
                            x:Name="FfmpegGifFramerateComboBox"
                            Grid.Row="4"
                            Grid.Column="1"
                            Grid.ColumnSpan="2"
                            Height="23"
                            Margin="5,3,3,3"
                            SelectedValue="{Binding Framerate}"
                            SelectedValuePath="Tag">
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.PixelFormat.Auto}"
                                Tag="{x:Static e:Framerates.Auto}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Framerate.Film}"
                                Tag="{x:Static e:Framerates.Film}" />
                            <ComboBoxItem
                                Content="PAL"
                                Tag="{x:Static e:Framerates.Pal}" />
                            <ComboBoxItem
                                Content="NTSC"
                                Tag="{x:Static e:Framerates.Ntsc}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Framerate.Custom}"
                                Tag="{x:Static e:Framerates.Custom}" />
                        </ComboBox>

                        <!--  Custom Framerate  -->
                        <n:DoubleUpDown
                            x:Name="FfmpegGifFramerateIntegerUpDown"
                            Grid.Row="5"
                            Grid.Column="1"
                            MinWidth="80"
                            Margin="5,3,3,3"
                            Maximum="1000"
                            Minimum="1"
                            StepValue="1"
                            Visibility="{Binding Framerate, Converter={StaticResource EnumToVisibility}, ConverterParameter={x:Static e:Framerates.Custom}}"
                            Value="{Binding CustomFramerate, Mode=TwoWay}" />
                        <TextBlock
                            Grid.Row="5"
                            Grid.Column="2"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.Recorder.Fps.Short}"
                            Visibility="{Binding ElementName=FfmpegGifFramerateIntegerUpDown, Path=Visibility}" />

                        <!--  Global color table  -->
                        <n:ExtendedCheckBox
                            x:Name="FfmpegGifGlobalColorTableCheckBox"
                            Grid.Row="6"
                            Grid.Column="0"
                            Grid.ColumnSpan="3"
                            Margin="0,3,3,3"
                            IsChecked="{Binding UseGlobalColorTable}"
                            Text="{DynamicResource S.SaveAs.GifOptions.GlobalColorTable}"
                            TextWrapping="Wrap"
                            ToolTip="{DynamicResource S.SaveAs.GifOptions.GlobalColorTable.Info}" />
                        <!--  Loop  -->
                        <n:ExtendedCheckBox
                            x:Name="FfmpegGifLoopedCheckBox"
                            Grid.Row="7"
                            Grid.Column="0"
                            Grid.ColumnSpan="3"
                            Margin="0,3,3,3"
                            IsChecked="{Binding Looped}"
                            Text="{DynamicResource S.SaveAs.GifOptions.Looped}" />

                        <Grid
                            Grid.Row="8"
                            Grid.Column="0"
                            Grid.ColumnSpan="3"
                            Visibility="{Binding Looped, Converter={StaticResource Bool2Visibility}, FallbackValue={x:Static Visibility.Collapsed}}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="1*" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <n:ExtendedCheckBox
                                x:Name="FfmpegGifRepeatForeverCheckBox"
                                Grid.Row="0"
                                Grid.Column="0"
                                Grid.ColumnSpan="2"
                                Margin="10,3,3,3"
                                IsChecked="{Binding RepeatForever, Mode=TwoWay}"
                                Text="{DynamicResource S.SaveAs.GifOptions.RepeatForever}" />

                            <n:IntegerUpDown
                                x:Name="FfmpegRepeatCountGifIntegerUpDown"
                                Grid.Row="1"
                                Grid.Column="0"
                                MinWidth="45"
                                Margin="10,3,3,3"
                                IsEnabled="{Binding RepeatForever, Converter={StaticResource InvertedBool}}"
                                Maximum="100"
                                Minimum="1"
                                StepValue="1"
                                Value="{Binding RepeatCount, Mode=TwoWay}" />
                            <TextBlock
                                Grid.Row="1"
                                Grid.Column="1"
                                Margin="0,3"
                                Foreground="{DynamicResource Element.Foreground.Medium}"
                                IsEnabled="{Binding RepeatForever, Converter={StaticResource InvertedBool}}"
                                Text="{DynamicResource S.SaveAs.GifOptions.RepeatCount}" />
                        </Grid>
                    </Grid>
                </Grid>

                <Grid
                    x:Name="GifskiGifOptionsGrid"
                    Margin="10,0,0,0"
                    Visibility="Collapsed">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <!--  Quality  -->
                    <TextBlock
                        Grid.Row="0"
                        Grid.Column="0"
                        Margin="0,3,3,3"
                        Padding="0"
                        VerticalAlignment="Center"
                        Foreground="{DynamicResource Element.Foreground.Medium}"
                        Text="{DynamicResource S.SaveAs.GifOptions.Quality}" />

                    <Slider
                        x:Name="GifskiQualitySlider"
                        Grid.Row="0"
                        Grid.Column="1"
                        Margin="0,3,3,0"
                        AutoToolTipPlacement="TopLeft"
                        IsMoveToPointEnabled="True"
                        IsSnapToTickEnabled="True"
                        Maximum="100"
                        Minimum="1"
                        SmallChange="1"
                        TickPlacement="BottomRight"
                        Value="{Binding Quality}" />

                    <Grid
                        Grid.Row="1"
                        Grid.Column="1"
                        Margin="0,0,3,3">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <TextBlock
                            Grid.Column="0"
                            FontSize="11">
                            <Run Text="1" />
                            <Run Text="•" />
                            <Run Text="{DynamicResource S.SaveAs.GifOptions.Fastest}" />
                        </TextBlock>

                        <TextBlock
                            Grid.Column="2"
                            FontSize="11">
                            <Run Text="{DynamicResource S.SaveAs.GifOptions.Best}" />
                            <Run Text="•" />
                            <Run Text="100" />
                        </TextBlock>
                    </Grid>

                    <!--  Faster encoding  -->
                    <n:ExtendedCheckBox
                        x:Name="GifskiFastCheckBox"
                        Grid.Row="2"
                        Grid.Column="0"
                        Grid.ColumnSpan="2"
                        Margin="0,3,3,3"
                        IsChecked="{Binding Fast}"
                        Text="{DynamicResource S.SaveAs.GifOptions.Gifski.Faster}"
                        TextWrapping="Wrap"
                        ToolTip="{DynamicResource S.SaveAs.GifOptions.Gifski.Faster.Info}" />

                    <!--  Loop  -->
                    <n:ExtendedCheckBox
                        x:Name="GifskiRepeatForeverCheckBox"
                        Grid.Row="3"
                        Grid.Column="0"
                        Grid.ColumnSpan="2"
                        Margin="0,3,3,3"
                        IsChecked="{Binding RepeatForever}"
                        Text="{DynamicResource S.SaveAs.GifOptions.RepeatForever}" />
                </Grid>

                <Grid
                    x:Name="SystemGifOptionsGrid"
                    Margin="10,0,0,0"
                    Visibility="Collapsed">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <!--  Loop  -->
                    <n:ExtendedCheckBox
                        x:Name="SystemGifLoopedCheckBox"
                        Grid.Row="0"
                        Margin="0,3,3,3"
                        IsChecked="{Binding Looped}"
                        Text="{DynamicResource S.SaveAs.GifOptions.Looped}" />

                    <Grid
                        Grid.Row="1"
                        Visibility="{Binding ElementName=SystemGifLoopedCheckBox, Path=IsChecked, Converter={StaticResource Bool2Visibility}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="1*" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <n:ExtendedCheckBox
                            x:Name="SystemGifRepeatForeverCheckBox"
                            Grid.Row="0"
                            Grid.Column="0"
                            Grid.ColumnSpan="2"
                            Margin="10,3,3,3"
                            IsChecked="{Binding RepeatForever}"
                            Text="{DynamicResource S.SaveAs.GifOptions.RepeatForever}" />

                        <n:IntegerUpDown
                            x:Name="SystemGifRepeatCountNumericUpDown"
                            Grid.Row="1"
                            Grid.Column="0"
                            MinWidth="45"
                            Margin="10,3,3,3"
                            IsEnabled="{Binding IsChecked, ElementName=FfmpegGifRepeatForeverCheckBox, Converter={StaticResource InvertedBool}}"
                            Maximum="100"
                            Minimum="1"
                            StepValue="1"
                            Value="{Binding Path=RepeatCount, Mode=TwoWay}" />
                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="1"
                            Margin="0,3"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            IsEnabled="{Binding IsChecked, ElementName=FfmpegGifRepeatForeverCheckBox, Converter={StaticResource InvertedBool}}"
                            Text="{DynamicResource S.SaveAs.GifOptions.RepeatCount}" />
                    </Grid>
                </Grid>

                <!--  Webp  -->
                <Grid
                    x:Name="FfmpegWebpOptionsGrid"
                    Margin="10,0,0,0"
                    IsSharedSizeScope="True"
                    Visibility="Collapsed">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <!--  Mode  -->
                    <Grid Grid.Row="0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition
                                Width="Auto"
                                SharedSizeGroup="WebpModeSizeGroup" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>

                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.VideoOptions.Mode}" />
                        <ComboBox
                            Name="FfmpegWebpModeComboBox"
                            Grid.Row="0"
                            Grid.Column="1"
                            Height="23"
                            Margin="5,3,3,3"
                            SelectedValue="{Binding SettingsMode}"
                            SelectedValuePath="Tag">
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Mode.Normal}"
                                Tag="{x:Static e:VideoSettingsModes.Normal}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Mode.Advanced}"
                                Tag="{x:Static e:VideoSettingsModes.Advanced}" />
                        </ComboBox>
                    </Grid>

                    <Grid
                        Grid.Row="1"
                        Visibility="{Binding SettingsMode, Converter={StaticResource EnumToVisibility}, ConverterParameter={x:Static e:VideoSettingsModes.Advanced}, FallbackValue=Collapsed}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition
                                Width="Auto"
                                SharedSizeGroup="WebpModeSizeGroup" />
                            <ColumnDefinition />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="0"
                            Margin="0,6,0,0"
                            Padding="0"
                            VerticalAlignment="Top"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.Ffmpeg.Parameters}" />
                        <n:ExtendedTextBox
                            x:Name="FfmpegWebpParameterTextBox"
                            Grid.Row="0"
                            Grid.Column="1"
                            MinHeight="23"
                            Margin="5,3,3,3"
                            VerticalContentAlignment="Top"
                            AcceptsReturn="True"
                            Text="{Binding Parameters}"
                            TextWrapping="Wrap"
                            ToolTip="{DynamicResource S.SaveAs.Ffmpeg.Parameters.Info}" />

                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="0"
                            Grid.ColumnSpan="3"
                            Margin="3,0"
                            VerticalAlignment="Center"
                            TextAlignment="Center"
                            TextWrapping="Wrap">
                            <Hyperlink
                                NavigateUri="http://bing.com"
                                RequestNavigate="PreviewCommand_RequestNavigate"
                                ToolTip="{DynamicResource S.SaveAs.Ffmpeg.Preview.Info}">
                                <Run Text="{DynamicResource S.SaveAs.Ffmpeg.Preview}" />
                            </Hyperlink>
                            <Run
                                Foreground="{DynamicResource Element.Foreground}"
                                Text="/" />
                            <Hyperlink
                                NavigateUri="https://ffmpeg.org/ffmpeg-formats.html#libwebp"
                                RequestNavigate="Hyperlink_RequestNavigate">
                                <Run Text="{DynamicResource S.SaveAs.Ffmpeg.Help.Format}" />
                            </Hyperlink>
                            <Run
                                Foreground="{DynamicResource Element.Foreground}"
                                Text="/" />
                            <Hyperlink
                                NavigateUri="http://www.ffmpeg.org/ffmpeg-filters.html"
                                RequestNavigate="Hyperlink_RequestNavigate">
                                <Run Text="{DynamicResource S.SaveAs.Ffmpeg.Help.Filters}" />
                            </Hyperlink>
                        </TextBlock>
                    </Grid>

                    <Grid
                        Grid.Row="1"
                        Visibility="{Binding SettingsMode, Converter={StaticResource EnumToVisibility}, ConverterParameter={x:Static e:VideoSettingsModes.Normal}}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition
                                Width="Auto"
                                SharedSizeGroup="WebpModeSizeGroup" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <!--  Codec Preset  -->
                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.WebpOptions.CodecPreset}" />
                        <ComboBox
                            x:Name="FfmpegWebpPresetComboBox"
                            Grid.Row="0"
                            Grid.Column="1"
                            Grid.ColumnSpan="3"
                            Height="23"
                            Margin="5,3,3,3"
                            SelectedValue="{Binding CodecPreset}"
                            SelectedValuePath="Tag">
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.WebpOptions.CodecPreset.None}"
                                Tag="{x:Static e:VideoCodecPresets.None}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.WebpOptions.CodecPreset.Default}"
                                Tag="{x:Static e:VideoCodecPresets.Default}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.WebpOptions.CodecPreset.Drawing}"
                                Tag="{x:Static e:VideoCodecPresets.Drawing}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.WebpOptions.CodecPreset.Icon}"
                                Tag="{x:Static e:VideoCodecPresets.Icon}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.WebpOptions.CodecPreset.Picture}"
                                Tag="{x:Static e:VideoCodecPresets.Picture}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.WebpOptions.CodecPreset.Photo}"
                                Tag="{x:Static e:VideoCodecPresets.Photo}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.WebpOptions.CodecPreset.Text}"
                                Tag="{x:Static e:VideoCodecPresets.Text}" />
                        </ComboBox>

                        <!--  Pixel Format  -->
                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.VideoOptions.PixelFormat}" />
                        <ComboBox
                            x:Name="FfmpegWebpPixelFormatComboBox"
                            Grid.Row="1"
                            Grid.Column="1"
                            Grid.ColumnSpan="3"
                            Height="23"
                            Margin="5,3,3,3"
                            SelectedValue="{Binding PixelFormat}"
                            SelectedValuePath="Tag">
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.PixelFormat.Auto}"
                                Tag="{x:Static e:VideoPixelFormats.Auto}" />
                            <ComboBoxItem
                                Content="BgrA"
                                Tag="{x:Static e:VideoPixelFormats.BgrA}" />
                            <ComboBoxItem
                                Content="Yuv420p"
                                Tag="{x:Static e:VideoPixelFormats.Yuv420p}" />
                            <ComboBoxItem
                                Content="Yuva420p"
                                Tag="{x:Static e:VideoPixelFormats.Yuva420p}" />
                        </ComboBox>

                        <!--  Vsync  -->
                        <TextBlock
                            Grid.Row="2"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.VideoOptions.Vsync}" />
                        <ComboBox
                            x:Name="FfmpegWebpVsyncComboBox"
                            Grid.Row="2"
                            Grid.Column="1"
                            Grid.ColumnSpan="2"
                            Height="23"
                            Margin="5,3,3,3"
                            SelectedValue="{Binding Vsync}"
                            SelectedValuePath="Tag"
                            ToolTip="{DynamicResource S.SaveAs.VideoOptions.Vsync.Info}">
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.HardwareAcceleration.Off}"
                                Tag="{x:Static e:Vsyncs.Off}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.PixelFormat.Auto}"
                                Tag="{x:Static e:Vsyncs.Auto}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Vsync.Passthrough}"
                                Tag="{x:Static e:Vsyncs.Passthrough}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Vsync.Cfr}"
                                Tag="{x:Static e:Vsyncs.Cfr}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Vsync.Vfr}"
                                Tag="{x:Static e:Vsyncs.Vfr}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Vsync.Drop}"
                                Tag="{x:Static e:Vsyncs.Drop}" />
                        </ComboBox>

                        <!--  Framerate  -->
                        <TextBlock
                            Grid.Row="3"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.VideoOptions.Framerate}" />
                        <ComboBox
                            x:Name="FfmpegWebpFramerateComboBox"
                            Grid.Row="3"
                            Grid.Column="1"
                            Grid.ColumnSpan="3"
                            Height="23"
                            Margin="5,3,3,3"
                            SelectedValue="{Binding Framerate}"
                            SelectedValuePath="Tag">
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.PixelFormat.Auto}"
                                Tag="{x:Static e:Framerates.Auto}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Framerate.Film}"
                                Tag="{x:Static e:Framerates.Film}" />
                            <ComboBoxItem
                                Content="PAL"
                                Tag="{x:Static e:Framerates.Pal}" />
                            <ComboBoxItem
                                Content="NTSC"
                                Tag="{x:Static e:Framerates.Ntsc}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Framerate.Custom}"
                                Tag="{x:Static e:Framerates.Custom}" />
                        </ComboBox>

                        <!--  Framerate  -->
                        <n:DoubleUpDown
                            x:Name="FfmpegWebpFramerateIntegerUpDown"
                            Grid.Row="4"
                            Grid.Column="1"
                            MinWidth="80"
                            Margin="5,3,3,3"
                            Maximum="1000"
                            Minimum="1"
                            StepValue="1"
                            Visibility="{Binding Framerate, Converter={StaticResource EnumToVisibility}, ConverterParameter={x:Static e:Framerates.Custom}}"
                            Value="{Binding CustomFramerate, Mode=TwoWay}" />
                        <TextBlock
                            Grid.Row="4"
                            Grid.Column="2"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.Recorder.Fps.Short}"
                            Visibility="{Binding ElementName=FfmpegGifFramerateIntegerUpDown, Path=Visibility}" />

                        <!--  Quality  -->
                        <TextBlock
                            Grid.Row="5"
                            Grid.Column="0"
                            Margin="0,3,3,3"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.GifOptions.Quality}" />

                        <Slider
                            x:Name="WebpQualitySlider"
                            Grid.Row="5"
                            Grid.Column="1"
                            Grid.ColumnSpan="3"
                            Margin="5,3,3,0"
                            AutoToolTipPlacement="TopLeft"
                            IsMoveToPointEnabled="True"
                            IsSnapToTickEnabled="True"
                            Maximum="100"
                            Minimum="0"
                            SmallChange="1"
                            TickPlacement="BottomRight"
                            Value="{Binding Quality, Mode=TwoWay}" />

                        <Grid
                            x:Name="WebpQualityGrid"
                            Grid.Row="6"
                            Grid.Column="1"
                            Grid.ColumnSpan="3"
                            Margin="0,0,3,3">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>

                            <TextBlock
                                Grid.Column="0"
                                FontSize="11">
                                <Run Text="0" />
                                <Run Text="•" />
                                <Run Text="{DynamicResource S.SaveAs.GifOptions.Fastest}" />
                            </TextBlock>

                            <TextBlock
                                Grid.Column="2"
                                FontSize="11">
                                <Run Text="{DynamicResource S.SaveAs.GifOptions.Best}" />
                                <Run Text="•" />
                                <Run Text="100" />
                            </TextBlock>
                        </Grid>

                        <!--  Lossless  -->
                        <n:ExtendedCheckBox
                            x:Name="FfmpegWebpLosslessCheckBox"
                            Grid.Row="7"
                            Grid.Column="0"
                            Grid.ColumnSpan="3"
                            Margin="0,3,3,3"
                            IsChecked="{Binding Lossless}"
                            Text="{DynamicResource S.SaveAs.WebpOptions.Lossless}"
                            TextWrapping="Wrap" />

                        <!--  Loop  -->
                        <n:ExtendedCheckBox
                            x:Name="FfmpegWebpLoopedCheckBox"
                            Grid.Row="8"
                            Grid.Column="0"
                            Grid.ColumnSpan="4"
                            Margin="0,3,3,3"
                            IsChecked="{Binding Looped}"
                            Text="{DynamicResource S.SaveAs.GifOptions.Looped}" />

                        <Grid
                            Grid.Row="9"
                            Grid.Column="0"
                            Grid.ColumnSpan="4"
                            Visibility="{Binding Looped, Converter={StaticResource Bool2Visibility}, FallbackValue={x:Static Visibility.Collapsed}}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="1*" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <n:ExtendedCheckBox
                                x:Name="FfmpegWebpRepeatForeverCheckBox"
                                Grid.Row="0"
                                Grid.Column="0"
                                Grid.ColumnSpan="2"
                                Margin="10,3,3,3"
                                IsChecked="{Binding RepeatForever, Mode=TwoWay}"
                                Text="{DynamicResource S.SaveAs.GifOptions.RepeatForever}" />

                            <n:IntegerUpDown
                                x:Name="FfmpegRepeatCountWebpIntegerUpDown"
                                Grid.Row="1"
                                Grid.Column="0"
                                MinWidth="45"
                                Margin="10,3,3,3"
                                IsEnabled="{Binding RepeatForever, Converter={StaticResource InvertedBool}}"
                                Maximum="100"
                                Minimum="1"
                                StepValue="1"
                                Value="{Binding RepeatCount, Mode=TwoWay}" />
                            <TextBlock
                                Grid.Row="1"
                                Grid.Column="1"
                                Margin="0,3"
                                Foreground="{DynamicResource Element.Foreground.Medium}"
                                IsEnabled="{Binding RepeatForever, Converter={StaticResource InvertedBool}}"
                                Text="{DynamicResource S.SaveAs.GifOptions.RepeatCount}" />
                        </Grid>
                    </Grid>
                </Grid>

                <!--  Videos  -->
                <Grid
                    x:Name="FfmpegVideoOptionsGrid"
                    Margin="10,0,0,0"
                    IsSharedSizeScope="True"
                    Visibility="Collapsed">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <!--  Mode  -->
                    <Grid Grid.Row="0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition
                                Width="Auto"
                                SharedSizeGroup="ModeSizeGroup" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>

                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.VideoOptions.Mode}" />
                        <ComboBox
                            Name="FfmpegVideoModeComboBox"
                            Grid.Row="0"
                            Grid.Column="1"
                            Height="23"
                            Margin="5,3,3,3"
                            SelectedValue="{Binding SettingsMode, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                            SelectedValuePath="Tag"
                            ToolTip="{DynamicResource S.SaveAs.VideoOptions.Mode.Info}">
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Mode.Normal}"
                                Tag="{x:Static e:VideoSettingsModes.Normal}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Mode.Advanced}"
                                Tag="{x:Static e:VideoSettingsModes.Advanced}" />
                        </ComboBox>
                    </Grid>

                    <Grid
                        Grid.Row="1"
                        Visibility="{Binding SettingsMode, Converter={StaticResource EnumToVisibility}, ConverterParameter={x:Static e:VideoSettingsModes.Advanced}}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition
                                Width="Auto"
                                SharedSizeGroup="ModeSizeGroup" />
                            <ColumnDefinition />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="0"
                            Margin="0,6,0,0"
                            Padding="0"
                            VerticalAlignment="Top"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.Ffmpeg.Parameters}" />
                        <n:ExtendedTextBox
                            x:Name="FfmpegVideoParameterTextBox"
                            Grid.Row="0"
                            Grid.Column="1"
                            MinHeight="23"
                            Margin="5,3,3,3"
                            VerticalContentAlignment="Top"
                            AcceptsReturn="True"
                            Text="{Binding Parameters, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                            TextWrapping="Wrap"
                            ToolTip="{DynamicResource S.SaveAs.Ffmpeg.Parameters.Info}" />

                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="0"
                            Grid.ColumnSpan="3"
                            Margin="3,0"
                            VerticalAlignment="Center"
                            TextAlignment="Center"
                            TextWrapping="Wrap">
                            <Hyperlink
                                NavigateUri="http://bing.com"
                                RequestNavigate="PreviewCommand_RequestNavigate"
                                ToolTip="{DynamicResource S.SaveAs.Ffmpeg.Preview.Info}">
                                <Run Text="{DynamicResource S.SaveAs.Ffmpeg.Preview}" />
                            </Hyperlink>
                            <Run
                                Foreground="{DynamicResource Element.Foreground}"
                                Text="/" />
                            <Hyperlink
                                NavigateUri="https://ffmpeg.org/ffmpeg-formats.html"
                                RequestNavigate="Hyperlink_RequestNavigate">
                                <Run Text="{DynamicResource S.SaveAs.Ffmpeg.Help.Format}" />
                            </Hyperlink>
                            <Run
                                Foreground="{DynamicResource Element.Foreground}"
                                Text="/" />
                            <Hyperlink
                                NavigateUri="http://www.ffmpeg.org/ffmpeg-filters.html"
                                RequestNavigate="Hyperlink_RequestNavigate">
                                <Run Text="{DynamicResource S.SaveAs.Ffmpeg.Help.Filters}" />
                            </Hyperlink>
                        </TextBlock>

                        <Grid
                            Grid.Row="2"
                            Grid.Column="0"
                            Grid.ColumnSpan="2"
                            Margin="10,10,5,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>

                            <Border
                                Grid.Column="0"
                                Width="15"
                                Height="15"
                                Background="{StaticResource Vector.Info}"
                                Opacity="{DynamicResource Element.Opacity}" />
                            <TextBlock
                                Grid.Column="1"
                                Padding="3"
                                FontSize="12"
                                FontStyle="Italic"
                                Foreground="{DynamicResource Element.Foreground.Detail}"
                                Text="{DynamicResource S.SaveAs.Ffmpeg.Parameters.Pass}"
                                TextWrapping="WrapWithOverflow" />
                        </Grid>
                    </Grid>

                    <Grid
                        Grid.Row="1"
                        Visibility="{Binding SettingsMode, Converter={StaticResource EnumToVisibility}, ConverterParameter={x:Static e:VideoSettingsModes.Normal}}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition
                                Width="Auto"
                                SharedSizeGroup="ModeSizeGroup" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <!--  Codec  -->
                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.VideoOptions.Codec}" />
                        <ComboBox
                            x:Name="FfmpegCodecComboBox"
                            Grid.Row="0"
                            Grid.Column="1"
                            Grid.ColumnSpan="2"
                            Height="23"
                            Margin="5,3,3,3"
                            ItemTemplate="{StaticResource Template.ComboBox.Item}"
                            SelectedValue="{Binding VideoCodec, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                            SelectedValuePath="Type"
                            ToolTip="{DynamicResource S.SaveAs.VideoOptions.Codec.Info}" />

                        <!--  Codec Presets  -->
                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.WebpOptions.CodecPreset}" />
                        <ComboBox
                            x:Name="FfmpegVideoPresetComboBox"
                            Grid.Row="1"
                            Grid.Column="1"
                            Grid.ColumnSpan="2"
                            Height="23"
                            Margin="5,3,3,3"
                            ItemTemplate="{StaticResource Template.ComboBox.Item}"
                            ItemsSource="{Binding ElementName=FfmpegCodecComboBox, Path=SelectedItem.CodecPresets}"
                            SelectedValue="{Binding CodecPreset, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                            SelectedValuePath="Type"
                            ToolTip="{DynamicResource S.SaveAs.VideoOptions.CodecPreset.Info}" />

                        <!--  Acceleration Engine  -->
                        <TextBlock
                            Grid.Row="2"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.VideoOptions.HardwareAcceleration}" />
                        <ComboBox
                            x:Name="FfmpegAccelerationComboBox"
                            Grid.Row="2"
                            Grid.Column="1"
                            Grid.ColumnSpan="2"
                            Height="23"
                            Margin="5,3,3,3"
                            SelectedValue="{Binding HardwareAcceleration, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                            SelectedValuePath="Tag"
                            ToolTip="{DynamicResource S.SaveAs.VideoOptions.HardwareAcceleration.Info}">
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.HardwareAcceleration.Off}"
                                Tag="{x:Static e:HardwareAccelerationModes.Off}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.HardwareAcceleration.On}"
                                Tag="{x:Static e:HardwareAccelerationModes.On}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.HardwareAcceleration.Auto}"
                                Tag="{x:Static e:HardwareAccelerationModes.Auto}" />
                        </ComboBox>

                        <!--  Pixel Format  -->
                        <TextBlock
                            Grid.Row="3"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.VideoOptions.PixelFormat}" />
                        <ComboBox
                            x:Name="FfmpegPixelFormatComboBox"
                            Grid.Row="3"
                            Grid.Column="1"
                            Grid.ColumnSpan="2"
                            Height="23"
                            Margin="5,3,3,3"
                            ItemTemplate="{StaticResource Template.ComboBox.Item}"
                            ItemsSource="{Binding ElementName=FfmpegCodecComboBox, Path=SelectedItem.PixelFormats}"
                            SelectedValue="{Binding PixelFormat, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                            SelectedValuePath="Type" />

                        <!--  Vsync  -->
                        <TextBlock
                            Grid.Row="4"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.VideoOptions.Vsync}" />
                        <ComboBox
                            x:Name="FfmpegVsyncComboBox"
                            Grid.Row="4"
                            Grid.Column="1"
                            Grid.ColumnSpan="2"
                            Height="23"
                            Margin="5,3,3,3"
                            SelectedValue="{Binding Vsync, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                            SelectedValuePath="Tag"
                            ToolTip="{DynamicResource S.SaveAs.VideoOptions.Vsync.Info}">
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.HardwareAcceleration.Off}"
                                Tag="{x:Static e:Vsyncs.Off}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.PixelFormat.Auto}"
                                Tag="{x:Static e:Vsyncs.Auto}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Vsync.Passthrough}"
                                Tag="{x:Static e:Vsyncs.Passthrough}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Vsync.Cfr}"
                                Tag="{x:Static e:Vsyncs.Cfr}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Vsync.Vfr}"
                                Tag="{x:Static e:Vsyncs.Vfr}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Vsync.Drop}"
                                Tag="{x:Static e:Vsyncs.Drop}" />
                        </ComboBox>

                        <!--  Framerate  -->
                        <TextBlock
                            Grid.Row="5"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.VideoOptions.Framerate}" />
                        <ComboBox
                            x:Name="FfmpegFramerateComboBox"
                            Grid.Row="5"
                            Grid.Column="1"
                            Grid.ColumnSpan="2"
                            Height="23"
                            Margin="5,3,3,3"
                            SelectedValue="{Binding Framerate, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                            SelectedValuePath="Tag">
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.PixelFormat.Auto}"
                                Tag="{x:Static e:Framerates.Auto}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Framerate.Film}"
                                Tag="{x:Static e:Framerates.Film}" />
                            <ComboBoxItem
                                Content="PAL"
                                Tag="{x:Static e:Framerates.Pal}" />
                            <ComboBoxItem
                                Content="NTSC"
                                Tag="{x:Static e:Framerates.Ntsc}" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Framerate.Custom}"
                                Tag="{x:Static e:Framerates.Custom}" />
                        </ComboBox>

                        <!--  Framerate  -->
                        <n:DecimalUpDown
                            x:Name="FfmpegFramerateDoubleUpDown"
                            Grid.Row="6"
                            Grid.Column="1"
                            MinWidth="80"
                            Margin="5,3,3,3"
                            Maximum="1000"
                            Minimum="1"
                            StepValue="1"
                            Visibility="{Binding Framerate, Converter={StaticResource EnumToVisibility}, ConverterParameter={x:Static e:Framerates.Custom}}"
                            Value="{Binding CustomFramerate, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />
                        <TextBlock
                            Grid.Row="6"
                            Grid.Column="2"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.Recorder.Fps.Short}"
                            Visibility="{Binding ElementName=FfmpegFramerateDoubleUpDown, Path=Visibility}" />

                        <!--  Pass  -->
                        <TextBlock
                            Grid.Row="7"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.VideoOptions.Pass}" />
                        <n:IntegerUpDown
                            x:Name="FfmpegPassIntegerUpDown"
                            Grid.Row="7"
                            Grid.Column="1"
                            MinWidth="80"
                            Margin="5,3,3,3"
                            Maximum="2"
                            Minimum="1"
                            StepValue="1"
                            Value="{Binding Pass, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />

                        <!--  CRF  -->
                        <TextBlock
                            Grid.Row="8"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="CRF:"
                            Visibility="{Binding ElementName=FfmpegCrfDecimalUpDown, Path=Visibility}" />
                        <n:NullableIntegerUpDown
                            x:Name="FfmpegCrfDecimalUpDown"
                            Grid.Row="8"
                            Grid.Column="1"
                            MinWidth="80"
                            Margin="5,3,3,3"
                            Maximum="{Binding ElementName=FfmpegCodecComboBox, Path=SelectedItem.MaximumCrf}"
                            Minimum="{Binding ElementName=FfmpegCodecComboBox, Path=SelectedItem.MinimumCrf}"
                            StepValue="1"
                            ToolTip="{DynamicResource S.SaveAs.VideoOptions.Crf.Info}"
                            Visibility="{Binding ElementName=FfmpegCodecComboBox, Path=SelectedItem.CanSetCrf, Converter={StaticResource Bool2Visibility}}"
                            Value="{Binding ConstantRateFactor, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />

                        <!--  Bitrate Mode  -->
                        <TextBlock
                            Grid.Row="9"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.VideoOptions.Bitrate.Mode}" />
                        <ComboBox
                            x:Name="FfmpegBitrateComboBox"
                            Grid.Row="9"
                            Grid.Column="1"
                            Grid.ColumnSpan="2"
                            Height="23"
                            Margin="5,3,3,3"
                            SelectedValue="{Binding IsVariableBitRate, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                            SelectedValuePath="Tag">
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Bitrate.Mode.Constant}"
                                Tag="False" />
                            <ComboBoxItem
                                Content="{DynamicResource S.SaveAs.VideoOptions.Bitrate.Mode.Variable}"
                                Tag="True" />
                        </ComboBox>

                        <!--  Quality Level  -->
                        <TextBlock
                            Grid.Row="10"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.VideoOptions.QualityLevel}"
                            Visibility="{Binding ElementName=FfmpegQualityLevelIntegerUpDown, Path=Visibility}" />
                        <n:IntegerUpDown
                            x:Name="FfmpegQualityLevelIntegerUpDown"
                            Grid.Row="10"
                            Grid.Column="1"
                            MinWidth="80"
                            Margin="5,3,3,3"
                            EmptyIfValue="0"
                            Maximum="31"
                            Minimum="0"
                            StepValue="1"
                            ToolTip="{DynamicResource S.SaveAs.VideoOptions.QualityLevel.Info}"
                            Visibility="{Binding IsVariableBitRate, Converter={StaticResource Bool2Visibility}}"
                            Value="{Binding QualityLevel, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />

                        <!--  Bitrate  -->
                        <TextBlock
                            Grid.Row="10"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.VideoOptions.Bitrate}"
                            Visibility="{Binding ElementName=FfmpegBitrateDecimalUpDown, Path=Visibility}" />
                        <n:DecimalUpDown
                            x:Name="FfmpegBitrateDecimalUpDown"
                            Grid.Row="10"
                            Grid.Column="1"
                            MinWidth="80"
                            Margin="5,3,3,3"
                            EmptyIfValue="0"
                            Maximum="999999"
                            Minimum="0"
                            StepValue="1"
                            ToolTip="{DynamicResource S.SaveAs.VideoOptions.Bitrate.Info}"
                            Visibility="{Binding IsVariableBitRate, Converter={StaticResource InvertedBoolToVisibility}}"
                            Value="{Binding BitRate, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />
                        <ComboBox
                            x:Name="FfmpegBitrateUnitComboBox"
                            Grid.Row="10"
                            Grid.Column="2"
                            Height="23"
                            Margin="5,3,3,3"
                            SelectedValue="{Binding BitRateUnit, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                            SelectedValuePath="Tag"
                            Visibility="{Binding ElementName=FfmpegBitrateDecimalUpDown, Path=Visibility}">
                            <ComboBoxItem
                                Content="Bits"
                                Tag="{x:Static e:RateUnits.Bits}" />
                            <ComboBoxItem
                                Content="Kilobits"
                                Tag="{x:Static e:RateUnits.Kilobits}" />
                            <ComboBoxItem
                                Content="Megabits"
                                Tag="{x:Static e:RateUnits.Megabits}" />
                        </ComboBox>

                        <!--  Minimum rate  -->
                        <TextBlock
                            Grid.Row="11"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.VideoOptions.Bitrate.Minimum}" />
                        <n:DecimalUpDown
                            x:Name="FfmpegMinBitrateDecimalUpDown"
                            Grid.Row="11"
                            Grid.Column="1"
                            MinWidth="80"
                            Margin="5,3,3,3"
                            EmptyIfValue="0"
                            Maximum="999999"
                            Minimum="0"
                            StepValue="1"
                            ToolTip="{DynamicResource S.SaveAs.VideoOptions.Bitrate.Minimum.Info}"
                            Value="{Binding MinimumBitRate, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />
                        <ComboBox
                            x:Name="FfmpegMinBitrateUnitComboBox"
                            Grid.Row="11"
                            Grid.Column="2"
                            Height="23"
                            Margin="5,3,3,3"
                            SelectedValue="{Binding MinimumBitRateUnit, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                            SelectedValuePath="Tag">
                            <ComboBoxItem
                                Content="Bits"
                                Tag="{x:Static e:RateUnits.Bits}" />
                            <ComboBoxItem
                                Content="Kilobits"
                                Tag="{x:Static e:RateUnits.Kilobits}" />
                            <ComboBoxItem
                                Content="Megabits"
                                Tag="{x:Static e:RateUnits.Megabits}" />
                        </ComboBox>

                        <!--  Maximum rate  -->
                        <TextBlock
                            Grid.Row="12"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.VideoOptions.Bitrate.Maximum}" />
                        <n:DecimalUpDown
                            x:Name="FfmpegMaxBitrateDecimalUpDown"
                            Grid.Row="12"
                            Grid.Column="1"
                            MinWidth="80"
                            Margin="5,3,3,3"
                            EmptyIfValue="0"
                            Maximum="999999"
                            Minimum="0"
                            StepValue="1"
                            ToolTip="{DynamicResource S.SaveAs.VideoOptions.Bitrate.Maximum.Info}"
                            Value="{Binding MaximumBitRate, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />
                        <ComboBox
                            x:Name="FfmpegMaxBitrateUnitComboBox"
                            Grid.Row="12"
                            Grid.Column="2"
                            Height="23"
                            Margin="5,3,3,3"
                            SelectedValue="{Binding MaximumBitRateUnit, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                            SelectedValuePath="Tag">
                            <ComboBoxItem
                                Content="Bits"
                                Tag="{x:Static e:RateUnits.Bits}" />
                            <ComboBoxItem
                                Content="Kilobits"
                                Tag="{x:Static e:RateUnits.Kilobits}" />
                            <ComboBoxItem
                                Content="Megabits"
                                Tag="{x:Static e:RateUnits.Megabits}" />
                        </ComboBox>

                        <!--  Buffer size  -->
                        <TextBlock
                            Grid.Row="13"
                            Grid.Column="0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.VideoOptions.Bitrate.Buffer}" />
                        <n:DecimalUpDown
                            x:Name="FfmpegBufferBitrateDecimalUpDown"
                            Grid.Row="13"
                            Grid.Column="1"
                            MinWidth="80"
                            Margin="5,3,3,3"
                            EmptyIfValue="0"
                            Maximum="999999"
                            Minimum="0"
                            StepValue="1"
                            ToolTip="{DynamicResource S.SaveAs.VideoOptions.Bitrate.Buffer.Info}"
                            Value="{Binding RateControlBuffer, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />
                        <ComboBox
                            x:Name="FfmpegBufferBitrateUnitComboBox"
                            Grid.Row="13"
                            Grid.Column="2"
                            Height="23"
                            Margin="5,3,3,3"
                            SelectedValue="{Binding RateControlBufferUnit, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                            SelectedValuePath="Tag">
                            <ComboBoxItem
                                Content="Bits"
                                Tag="{x:Static e:RateUnits.Bits}" />
                            <ComboBoxItem
                                Content="Kilobits"
                                Tag="{x:Static e:RateUnits.Kilobits}" />
                            <ComboBoxItem
                                Content="Megabits"
                                Tag="{x:Static e:RateUnits.Megabits}" />
                        </ComboBox>
                    </Grid>
                </Grid>

                <!--  Images  -->
                <Grid
                    x:Name="EmbeddedImageOptionsGrid"
                    Margin="10,0,0,0"
                    Visibility="Collapsed">
                    <n:ExtendedCheckBox
                        x:Name="ImagesZipCheckBox"
                        Grid.Row="0"
                        Margin="0,3,3,3"
                        CheckedChanged="ImagesZipCheckBox_CheckedChanged"
                        IsChecked="{Binding ZipFiles, FallbackValue=False}"
                        Text="{DynamicResource S.SaveAs.ImageOptions.Zip}"
                        ToolTip="{DynamicResource S.SaveAs.ImageOptions.Zip.Info}" />
                </Grid>

                <!--  Project  -->
                <Grid
                    x:Name="EmbeddedStgOptionsGrid"
                    Margin="10,0,0,0"
                    Visibility="Collapsed">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <TextBlock
                        Grid.Column="0"
                        Padding="0"
                        VerticalAlignment="Center"
                        Foreground="{DynamicResource Element.Foreground.Medium}"
                        Text="{DynamicResource S.Options.Recorder.Compression}" />
                    <ComboBox
                        x:Name="ProjectCompressionComboBox"
                        Grid.Column="1"
                        MinWidth="120"
                        Margin="5,3"
                        VerticalAlignment="Center"
                        SelectedIndex="{Binding CompressionLevel, Converter={StaticResource EnumToInt}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                        <ComboBoxItem Content="{DynamicResource S.Options.Recorder.Compression.Optimal}" />
                        <ComboBoxItem Content="{DynamicResource S.Options.Recorder.Compression.Fastest}" />
                        <ComboBoxItem Content="{DynamicResource S.Options.Recorder.Compression.NoCompression}" />
                    </ComboBox>
                </Grid>

                <!--  Photoshop  -->
                <Grid
                    x:Name="EmbeddedPsdOptionsGrid"
                    Margin="10,0,0,0"
                    Visibility="Collapsed">
                    <n:ExtendedCheckBox
                        x:Name="PsdCompressImageCheckBox"
                        Grid.Row="0"
                        Margin="0,3,3,3"
                        IsChecked="{Binding CompressImage, FallbackValue=False}"
                        Text="{DynamicResource S.SaveAs.PsdOptions.Compress}"
                        ToolTip="{DynamicResource S.SaveAs.PsdOptions.Compress.Info}" />
                </Grid>
            </Grid>
        </Expander>

        <Expander
            x:Name="SaveOptionsExpander"
            Grid.Row="3"
            Header="{DynamicResource S.SaveAs.SaveOptions}"
            IsExpanded="{Binding IsExportOptionsExpanded, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
            <Grid x:Name="SaveGrid">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <n:ExtendedCheckBox
                    x:Name="PartialExportCheckBox"
                    Grid.Row="0"
                    Margin="10,3,3,3"
                    IsChecked="{Binding ExportPartially, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, FallbackValue=False}"
                    Text="{DynamicResource S.SaveAs.SaveOptions.Partial}" />

                <n:ExtendedCheckBox
                    x:Name="SaveFileCheckBox"
                    Grid.Row="1"
                    Margin="10,3,3,3"
                    CheckedChanged="SaveType_Checked"
                    IsChecked="{Binding PickLocation, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, FallbackValue=False}"
                    Text="{DynamicResource S.SaveAs.SaveOptions.PickFolder}" />

                <Grid
                    Grid.Row="2"
                    Visibility="{Binding ElementName=SaveFileCheckBox, Path=IsChecked, Converter={StaticResource Bool2Visibility}}">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <StackPanel
                        Margin="20,0,0,0"
                        Orientation="Horizontal">
                        <TextBlock
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{DynamicResource S.SaveAs.SaveOptions.OverwriteMode}" />

                        <WrapPanel Margin="5,0,0,0">
                            <n:ExtendedRadioButton
                                x:Name="OverwriteWarnRadioButton"
                                Padding="0,2,2,2"
                                ContentHeight="0"
                                ContentWidth="0"
                                IsChecked="{Binding OverwriteMode, Converter={StaticResource EnumToBool}, ConverterParameter={x:Static e:OverwriteModes.Warn}}"
                                Text="{DynamicResource S.SaveAs.SaveOptions.OverwriteMode.Warn}"
                                ToolTip="{DynamicResource S.SaveAs.SaveOptions.OverwriteMode.Warn.Info}" />
                            <Separator Width="1" />
                            <n:ExtendedRadioButton
                                x:Name="OverwritePromptRadioButton"
                                Padding="0,2,2,2"
                                ContentHeight="0"
                                ContentWidth="0"
                                IsChecked="{Binding OverwriteMode, Converter={StaticResource EnumToBool}, ConverterParameter={x:Static e:OverwriteModes.Prompt}}"
                                Text="{DynamicResource S.SaveAs.SaveOptions.OverwriteMode.Prompt}"
                                ToolTip="{DynamicResource S.SaveAs.SaveOptions.OverwriteMode.Prompt.Info}" />
                            <Separator Width="1" />
                            <n:ExtendedRadioButton
                                x:Name="OverwriteAllowRadioButton"
                                Padding="0,2,2,2"
                                ContentHeight="0"
                                ContentWidth="0"
                                IsChecked="{Binding OverwriteMode, Converter={StaticResource EnumToBool}, ConverterParameter={x:Static e:OverwriteModes.Allow}}"
                                Text="{DynamicResource S.SaveAs.SaveOptions.OverwriteMode.Allow}"
                                ToolTip="{DynamicResource S.SaveAs.SaveOptions.OverwriteMode.Allow.Info}" />
                        </WrapPanel>
                    </StackPanel>

                    <n:ExtendedCheckBox
                        x:Name="SaveAsProjectTooCheckBox"
                        Grid.Row="1"
                        Margin="20,3,3,3"
                        IsChecked="{Binding ExportAsProjectToo, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                        Text="{DynamicResource S.SaveAs.SaveOptions.ProjectToo}" />
                </Grid>

                <n:ExtendedCheckBox
                    x:Name="UploadFileCheckBox"
                    Grid.Row="3"
                    Margin="10,3,3,3"
                    IsChecked="{Binding UploadFile, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, FallbackValue=False}"
                    Text="{DynamicResource S.SaveAs.SaveOptions.UploadFile}"
                    Unchecked="UploadFileCheckBox_Unchecked" />

                <n:ExtendedCheckBox
                    x:Name="CopyFileCheckBox"
                    Grid.Row="4"
                    Margin="10,3,3,3"
                    IsChecked="{Binding SaveToClipboard, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                    Text="{DynamicResource S.SaveAs.SaveOptions.CopyToClipboard}" />

                <WrapPanel
                    Grid.Row="5"
                    Margin="20,0,0,0"
                    Visibility="{Binding IsChecked, ElementName=CopyFileCheckBox, Converter={StaticResource Bool2Visibility}}">
                    <n:ExtendedRadioButton
                        x:Name="CopyFileRadioButton"
                        Padding="0,2,2,2"
                        ContentHeight="0"
                        ContentWidth="0"
                        IsChecked="{Binding CopyType, Converter={StaticResource EnumToBool}, ConverterParameter={x:Static e:CopyModes.File}}"
                        Text="{DynamicResource S.SaveAs.SaveOptions.CopyToClipboard.File}"
                        ToolTip="{DynamicResource S.SaveAs.SaveOptions.CopyToClipboard.File.Info}" />
                    <Separator Width="1" />
                    <n:ExtendedRadioButton
                        x:Name="CopyFolderPathRadioButton"
                        Padding="0,2,2,2"
                        ContentHeight="0"
                        ContentWidth="0"
                        IsChecked="{Binding CopyType, Converter={StaticResource EnumToBool}, ConverterParameter={x:Static e:CopyModes.FolderPath}}"
                        Text="{DynamicResource S.SaveAs.SaveOptions.CopyToClipboard.FolderPath}"
                        ToolTip="{DynamicResource S.SaveAs.SaveOptions.CopyToClipboard.FolderPath.Info}" />
                    <Separator Width="1" />
                    <n:ExtendedRadioButton
                        x:Name="CopyFilePathRadioButton"
                        Padding="0,2,2,2"
                        ContentHeight="0"
                        ContentWidth="0"
                        IsChecked="{Binding CopyType, Converter={StaticResource EnumToBool}, ConverterParameter={x:Static e:CopyModes.FilePath}}"
                        Text="{DynamicResource S.SaveAs.SaveOptions.CopyToClipboard.FilePath}"
                        ToolTip="{DynamicResource S.SaveAs.SaveOptions.CopyToClipboard.FilePath.Info}" />
                    <Separator
                        Width="1"
                        Visibility="{Binding ElementName=CopyLinkRadioButton, Path=Visibility}" />
                    <n:ExtendedRadioButton
                        x:Name="CopyLinkRadioButton"
                        Padding="0,2,2,2"
                        ContentHeight="0"
                        ContentWidth="0"
                        IsChecked="{Binding CopyType, Converter={StaticResource EnumToBool}, ConverterParameter={x:Static e:CopyModes.Link}}"
                        Text="{DynamicResource S.SaveAs.SaveOptions.CopyToClipboard.Link}"
                        ToolTip="{DynamicResource S.SaveAs.SaveOptions.CopyToClipboard.Link.Info}"
                        Visibility="{Binding ElementName=UploadFileCheckBox, Path=IsChecked, Converter={StaticResource Bool2Visibility}}" />
                </WrapPanel>

                <n:ExtendedCheckBox
                    x:Name="CustomCommandsCheckBox"
                    Grid.Row="6"
                    Margin="10,3,3,3"
                    IsChecked="{Binding ExecuteCustomCommands, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                    Text="{DynamicResource S.SaveAs.SaveOptions.ExecuteCommands}" />

                <n:ExtendedTextBox
                    x:Name="CustomCommandsTextBox"
                    Grid.Row="7"
                    MinHeight="23"
                    Margin="20,3,3,3"
                    VerticalContentAlignment="Top"
                    AcceptsReturn="True"
                    Text="{Binding CustomCommands, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                    TextWrapping="WrapWithOverflow"
                    ToolTip="{DynamicResource S.SaveAs.SaveOptions.ExecuteCommands.Info}"
                    Visibility="{Binding IsChecked, ElementName=CustomCommandsCheckBox, Converter={StaticResource Bool2Visibility}}" />
            </Grid>
        </Expander>

        <Expander
            x:Name="PartialExportExpander"
            Grid.Row="4"
            Header="{DynamicResource S.SaveAs.Partial}"
            IsExpanded="{Binding IsPartialExportExpanded, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, FallbackValue=False}"
            Visibility="{Binding ElementName=PartialExportCheckBox, Path=IsChecked, Converter={StaticResource Bool2Visibility}}">
            <Grid Margin="10,0,0,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <ComboBox
                    x:Name="PartialExportComboBox"
                    Grid.Row="0"
                    Height="38"
                    Margin="0,3,5,3"
                    VerticalAlignment="Center"
                    ItemTemplate="{StaticResource Template.ComboBox.Simple}"
                    SelectedValue="{Binding PartialExport, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, FallbackValue={x:Static e:PartialExportModes.FrameRange}}"
                    SelectedValuePath="Value"
                    SelectionChanged="EncoderComboBox_SelectionChanged"
                    ToolTip="{DynamicResource S.SaveAs.Partial.Mode.Info}">
                    <i:GenericItem
                        Title="{DynamicResource S.SaveAs.Partial.Mode.Selection}"
                        Description="{DynamicResource S.SaveAs.Partial.Mode.Selection.Info}"
                        ImageId="Vector.Cursor"
                        Value="{x:Static e:PartialExportModes.Selection}" />

                    <i:GenericItem
                        Title="{DynamicResource S.SaveAs.Partial.Mode.Frames}"
                        Description="{DynamicResource S.SaveAs.Partial.Mode.Frames.Info}"
                        ImageId="Vector.Number"
                        Value="{x:Static e:PartialExportModes.FrameRange}" />

                    <i:GenericItem
                        Title="{DynamicResource S.SaveAs.Partial.Mode.Time}"
                        Description="{DynamicResource S.SaveAs.Partial.Mode.Time.Info}"
                        ImageId="Vector.Clock"
                        Value="{x:Static e:PartialExportModes.TimeRange}" />

                    <i:GenericItem
                        Title="{DynamicResource S.SaveAs.Partial.Mode.Expression}"
                        Description="{DynamicResource S.SaveAs.Partial.Mode.Expression.Info}"
                        ImageId="Vector.Expression"
                        Value="{x:Static e:PartialExportModes.FrameExpression}" />
                </ComboBox>

                <Grid
                    x:Name="SelectionGrid"
                    Grid.Row="1"
                    Visibility="{Binding PartialExport, Converter={StaticResource EnumToVisibility}, ConverterParameter={x:Static e:PartialExportModes.Selection}}">
                    <TextBlock
                        Grid.Row="0"
                        Grid.Column="0"
                        Margin="5"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Foreground="{DynamicResource Element.Foreground.Medium}"
                        Text="{Binding ElementName=ThisPanel, Path=SelectionCount, Converter={StaticResource SelectionCountToDescription}}" />
                </Grid>

                <Grid
                    x:Name="FrameRangeGrid"
                    Grid.Row="1"
                    Visibility="{Binding PartialExport, Converter={StaticResource EnumToVisibility}, ConverterParameter={x:Static e:PartialExportModes.FrameRange}, FallbackValue={x:Static Visibility.Collapsed}}">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <n:RangeSlider
                        x:Name="FrameRangeSlider"
                        Grid.Row="0"
                        Grid.Column="0"
                        Grid.ColumnSpan="5"
                        Margin="0,3,5,3"
                        LowerValue="{Binding PartialExportFrameStart, Mode=TwoWay}"
                        Maximum="{Binding ElementName=ThisPanel, Path=FrameCount}"
                        TickPlacement="BottomRight"
                        UpperValue="{Binding PartialExportFrameEnd, Mode=TwoWay}" />

                    <TextBlock
                        Grid.Row="1"
                        Grid.Column="0"
                        Margin="5,3"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Foreground="{DynamicResource Element.Foreground.Medium}"
                        Text="{DynamicResource S.SaveAs.Partial.From}" />
                    <n:IntegerUpDown
                        x:Name="FrameRangeStartIntegerUpDown"
                        Grid.Row="1"
                        Grid.Column="1"
                        MinWidth="50"
                        Margin="3,3,3,3"
                        Maximum="{Binding ElementName=FrameRangeSlider, Path=Maximum, Mode=TwoWay}"
                        Minimum="0"
                        StepValue="1"
                        Value="{Binding PartialExportFrameStart, Mode=TwoWay}" />

                    <TextBlock
                        Grid.Row="1"
                        Grid.Column="3"
                        Margin="5,3"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Foreground="{DynamicResource Element.Foreground.Medium}"
                        Text="{DynamicResource S.SaveAs.Partial.To}" />
                    <n:IntegerUpDown
                        x:Name="FrameRangeEndIntegerUpDown"
                        Grid.Row="1"
                        Grid.Column="4"
                        MinWidth="50"
                        Margin="3,3,5,3"
                        Maximum="{Binding ElementName=FrameRangeSlider, Path=Maximum, Mode=TwoWay}"
                        Minimum="0"
                        StepValue="1"
                        Value="{Binding PartialExportFrameEnd, Mode=TwoWay}" />
                </Grid>

                <Grid
                    x:Name="TimeRangeGrid"
                    Grid.Row="1"
                    Visibility="{Binding PartialExport, Converter={StaticResource EnumToVisibility}, ConverterParameter={x:Static e:PartialExportModes.TimeRange}, FallbackValue={x:Static Visibility.Collapsed}}">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <TextBlock
                        Grid.Row="1"
                        Grid.Column="0"
                        Margin="5,3"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Foreground="{DynamicResource Element.Foreground.Medium}"
                        Text="{DynamicResource S.SaveAs.Partial.From}" />
                    <n:TimeBox
                        x:Name="TimeRangeStartIntegerUpDown"
                        Grid.Row="1"
                        Grid.Column="1"
                        MinWidth="75"
                        Margin="3,3,3,3"
                        DisplayMilliseconds="True"
                        Maximum="{Binding ElementName=ThisPanel, Path=TotalTime}"
                        Minimum="0"
                        Selected="{Binding PartialExportTimeStart, Mode=TwoWay}" />

                    <TextBlock
                        Grid.Row="1"
                        Grid.Column="3"
                        Margin="5,3"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Foreground="{DynamicResource Element.Foreground.Medium}"
                        Text="{DynamicResource S.SaveAs.Partial.To}" />
                    <n:TimeBox
                        x:Name="TimeRangeEndIntegerUpDown"
                        Grid.Row="1"
                        Grid.Column="4"
                        MinWidth="75"
                        Margin="3,3,5,3"
                        DisplayMilliseconds="True"
                        Maximum="{Binding ElementName=ThisPanel, Path=TotalTime}"
                        Minimum="0"
                        Selected="{Binding PartialExportTimeEnd, Mode=TwoWay}" />
                </Grid>

                <Grid
                    x:Name="ExpressionRangeGrid"
                    Grid.Row="1"
                    Visibility="{Binding PartialExport, Converter={StaticResource EnumToVisibility}, ConverterParameter={x:Static e:PartialExportModes.FrameExpression}}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>

                    <TextBlock
                        Grid.Row="0"
                        Grid.Column="0"
                        Margin="5,3"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Foreground="{DynamicResource Element.Foreground.Medium}"
                        Text="{DynamicResource S.SaveAs.Partial.Expression}" />
                    <n:ExtendedTextBox
                        x:Name="FrameRangeTextBox"
                        Grid.Row="0"
                        Grid.Column="1"
                        Margin="3,3,5,3"
                        AllowSpacing="True"
                        AllowedCharacters="0123456789-,"
                        Text="{Binding PartialExportFrameExpression}"
                        ToolTip="{DynamicResource S.SaveAs.Partial.Expression.Info}" />
                </Grid>
            </Grid>
        </Expander>

        <Expander
            x:Name="OutputExpander"
            Grid.Row="5"
            Header="{DynamicResource S.SaveAs.File}"
            IsExpanded="{Binding IsOutputExpanded, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
            Visibility="{Binding ElementName=SaveFileCheckBox, Path=IsChecked, Converter={StaticResource Bool2Visibility}}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <!--  Folder  -->
                <Grid
                    Grid.Row="0"
                    Margin="10,0,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition Width="30" />
                    </Grid.ColumnDefinitions>

                    <n:ExtendedTextBox
                        x:Name="FolderTextBox"
                        Grid.Column="0"
                        Height="Auto"
                        MinHeight="23"
                        Margin="1,3"
                        VerticalContentAlignment="Top"
                        Text="{Binding OutputFolder, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                        TextChanged="FilenameTextBox_TextChanged"
                        TextWrapping="Wrap"
                        ToolTip="{DynamicResource S.SaveAs.File.Location}"
                        ToolTipService.HorizontalOffset="-5"
                        ToolTipService.Placement="Top" />

                    <n:ExtendedButton
                        x:Name="ChooseLocatioButton"
                        Grid.Column="1"
                        Click="ChooseLocation_Click"
                        ContentHeight="20"
                        ContentWidth="20"
                        Icon="{StaticResource Vector.Open}"
                        Style="{StaticResource Style.Button.NoText}"
                        ToolTip="{DynamicResource S.SaveAs.File.Choose}"
                        ToolTipService.HorizontalOffset="-5"
                        ToolTipService.Placement="Top" />
                </Grid>

                <!--  Filename  -->
                <Grid
                    Grid.Row="1"
                    Margin="10,0,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="25" />
                        <ColumnDefinition Width="25" />
                    </Grid.ColumnDefinitions>

                    <n:ExtendedTextBox
                        x:Name="FilenameTextBox"
                        Grid.Column="0"
                        MinHeight="23"
                        Margin="1,3"
                        VerticalContentAlignment="Center"
                        Text="{Binding OutputFilename, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                        TextChanged="FilenameTextBox_TextChanged"
                        TextWrapping="Wrap"
                        ToolTip="{DynamicResource S.SaveAs.File.Name}"
                        ToolTipService.HorizontalOffset="-5"
                        ToolTipService.Placement="Bottom" />

                    <ComboBox
                        Name="ExtensionComboBox"
                        Grid.Column="1"
                        MinHeight="25"
                        Margin="1,3"
                        SelectedItem="{Binding Extension, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                        SelectionChanged="Extension_SelectionChanged"
                        ToolTip="{DynamicResource S.SaveAs.File.Format}" />

                    <n:ExtendedButton
                        x:Name="IncreaseCountButton"
                        Grid.Column="2"
                        Click="IncreaseNumber_Click"
                        ContentHeight="15"
                        ContentWidth="15"
                        Icon="{StaticResource Vector.Add}"
                        Style="{StaticResource Style.Button.NoText}"
                        ToolTip="{DynamicResource S.SaveAs.File.Increase}"
                        ToolTipService.Placement="Bottom" />

                    <n:ExtendedButton
                        x:Name="DecreaseCountButton"
                        Grid.Column="3"
                        Click="DecreaseNumber_Click"
                        ContentHeight="15"
                        ContentWidth="15"
                        Icon="{StaticResource Vector.Subtract}"
                        Style="{StaticResource Style.Button.NoText}"
                        ToolTip="{DynamicResource S.SaveAs.File.Decrease}"
                        ToolTipService.Placement="Bottom" />
                </Grid>

                <!--  File already exists  -->
                <Grid
                    Name="FileExistsGrid"
                    Grid.Row="2"
                    Margin="10,0,0,0"
                    Visibility="Collapsed">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>

                    <Border
                        Grid.Column="0"
                        Width="15"
                        Height="15"
                        Background="{StaticResource Vector.Warning}"
                        Opacity="{DynamicResource Element.Opacity}" />
                    <TextBlock
                        Grid.Row="0"
                        Grid.Column="1"
                        Padding="3"
                        FontSize="11"
                        FontStyle="Italic"
                        TextWrapping="WrapWithOverflow">
                        <Hyperlink
                            Cursor="Hand"
                            NavigateUri="bing.com"
                            RequestNavigate="FileHyperlink_RequestNavigate"
                            ToolTip="{DynamicResource S.Encoder.OpenFile}">
                            <Run Text="{DynamicResource S.SaveAs.File.Exists}" />
                        </Hyperlink>
                    </TextBlock>
                </Grid>
            </Grid>
        </Expander>

        <Expander
            x:Name="UploadExpander"
            Grid.Row="6"
            Header="{DynamicResource S.SaveAs.Upload}"
            IsExpanded="{Binding IsUploadExpanded, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, FallbackValue=True}"
            Visibility="{Binding ElementName=UploadFileCheckBox, Path=IsChecked, Converter={StaticResource Bool2Visibility}}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <n:ExtendedComboBox
                    x:Name="UploadPresetComboBox"
                    Grid.Row="0"
                    Height="38"
                    Margin="10,3,5,3"
                    VerticalAlignment="Center"
                    ItemTemplate="{StaticResource Template.ComboBox.Simple}"
                    SelectedValue="{Binding UploadService, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                    SelectedValuePath="Title"
                    ToolTip="{DynamicResource S.SaveAs.Upload.Info}">
                    <n:ExtendedComboBox.GroupStyle>
                        <GroupStyle>
                            <GroupStyle.HeaderTemplate>
                                <DataTemplate>
                                    <n:LabelSeparator
                                        x:Name="Separator"
                                        Text="{Binding Name}" />

                                    <DataTemplate.Triggers>
                                        <Trigger Property="Name" Value="{x:Null}">
                                            <Setter TargetName="Separator" Property="Visibility" Value="Collapsed" />
                                        </Trigger>
                                    </DataTemplate.Triggers>
                                </DataTemplate>
                            </GroupStyle.HeaderTemplate>
                        </GroupStyle>
                    </n:ExtendedComboBox.GroupStyle>

                    <n:ExtendedComboBox.EmptyItem>
                        <p:UploadPreset
                            Title="{StaticResource S.SaveAs.Upload.Unavailable.Title}"
                            Description="{StaticResource S.SaveAs.Upload.Unavailable.Description}"
                            ImageId="Vector.Info" />
                    </n:ExtendedComboBox.EmptyItem>

                    <n:ExtendedComboBox.NoSelectionItem>
                        <p:UploadPreset
                            Title="{StaticResource S.SaveAs.Upload.Select.Title}"
                            Description="{StaticResource S.SaveAs.Upload.Select.Description}"
                            ImageId="Vector.Info" />
                    </n:ExtendedComboBox.NoSelectionItem>
                </n:ExtendedComboBox>

                <Grid
                    Grid.Row="1"
                    Height="35"
                    Margin="5,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition Width="30" />
                        <ColumnDefinition Width="30" />
                        <ColumnDefinition Width="30" />
                        <ColumnDefinition Width="30" />
                    </Grid.ColumnDefinitions>

                    <Border
                        Grid.Column="0"
                        Margin="5,0"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center"
                        Background="{DynamicResource Brush.StatusBand.Error}"
                        CornerRadius="3"
                        ToolTip="{DynamicResource S.SaveAs.Upload.Limit}"
                        Visibility="{Binding ElementName=UploadPresetComboBox, Path=SelectedItem.HasLimit, Converter={StaticResource Bool2Visibility}, FallbackValue={x:Static Visibility.Collapsed}}">
                        <TextBlock
                            Margin="3,0"
                            Padding="0"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Medium}"
                            Text="{Binding ElementName=UploadPresetComboBox, Path=SelectedItem.Limit}" />
                    </Border>

                    <n:ExtendedButton
                        x:Name="AddUploadPresetButton"
                        Grid.Column="1"
                        Click="AddUploadPreset_Click"
                        ContentHeight="15"
                        ContentWidth="15"
                        Icon="{StaticResource Vector.Add}"
                        Style="{StaticResource Style.Button.NoText}"
                        ToolTip="{DynamicResource S.SaveAs.Upload.Add}"
                        ToolTipService.Placement="Bottom" />
                    <n:ExtendedButton
                        x:Name="EditUploadPresetButton"
                        Grid.Column="2"
                        Click="EditUploadPreset_Click"
                        ContentHeight="15"
                        ContentWidth="15"
                        Icon="{StaticResource Vector.Pen}"
                        IsEnabled="{Binding ElementName=UploadPresetComboBox, Path=SelectedItem, Converter={StaticResource ContentToVisibility}}"
                        Style="{StaticResource Style.Button.NoText}"
                        ToolTip="{DynamicResource S.SaveAs.Upload.Edit}"
                        ToolTipService.Placement="Bottom" />
                    <n:ExtendedButton
                        x:Name="HistoryUploadPresetButton"
                        Grid.Column="3"
                        Click="HistoryUploadPreset_Click"
                        ContentHeight="15"
                        ContentWidth="15"
                        Icon="{StaticResource Vector.Clock}"
                        IsEnabled="{Binding ElementName=UploadPresetComboBox, Path=SelectedItem, Converter={StaticResource ContentToVisibility}}"
                        Style="{StaticResource Style.Button.NoText}"
                        ToolTip="{DynamicResource S.SaveAs.Upload.History}"
                        ToolTipService.Placement="Bottom" />
                    <n:ExtendedButton
                        x:Name="RemoveUploadPresetButton"
                        Grid.Column="4"
                        Click="RemoveUploadPreset_Click"
                        ContentHeight="15"
                        ContentWidth="15"
                        Icon="{StaticResource Vector.Remove}"
                        IsEnabled="{Binding ElementName=UploadPresetComboBox, Path=SelectedItem, Converter={StaticResource ContentToVisibility}}"
                        Style="{StaticResource Style.Button.NoText}"
                        ToolTip="{DynamicResource S.SaveAs.Presets.Remove}"
                        ToolTipService.Placement="Bottom" />
                </Grid>
            </Grid>
        </Expander>
    </Grid>
</UserControl>