<n:ExWindow
    x:Class="ScreenToGif.Windows.Editor"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:c="clr-namespace:ScreenToGif.Util.Converters;assembly=ScreenToGif.Util"
    xmlns:cm="clr-namespace:System.ComponentModel;assembly=WindowsBase"
    xmlns:e="clr-namespace:ScreenToGif.Domain.Enums;assembly=ScreenToGif.Domain"
    xmlns:gl="clr-namespace:System.Globalization;assembly=mscorlib"
    xmlns:h="clr-namespace:ScreenToGif.Controls.Shapes"
    xmlns:l="clr-namespace:ScreenToGif.Windows"
    xmlns:n="clr-namespace:ScreenToGif.Controls"
    xmlns:o="clr-namespace:ScreenToGif.UserControls"
    xmlns:t="clr-namespace:ScreenToGif.Util.Settings;assembly=ScreenToGif.Util"
    x:Name="EditorWindow"
    Title="{DynamicResource S.Editor.Title}"
    MinWidth="700"
    MinHeight="500"
    Activated="Window_Activated"
    Background="{DynamicResource Panel.Background.Level3}"
    Closing="Window_Closing"
    Deactivated="Window_Deactivated"
    DpiChanged="Window_DpiChanged"
    FocusManager.FocusedElement="{Binding RelativeSource={x:Static RelativeSource.Self}, Mode=OneTime}"
    Icon="/Resources/Logo.ico"
    KeyUp="Window_KeyUp"
    Loaded="Window_Loaded"
    UseLayoutRounding="True">

    <Window.Resources>
        <c:DoubleToInt x:Key="DoubleToIntConverter" />
        <c:InvertedBool x:Key="InvertedBoolConverter" />
        <c:InvertedVisibility x:Key="InvertedVisibilityConverter" />
        <c:MaximumValue x:Key="MaximumValueConverter" />
        <c:DoubleTimesAHundredToInt x:Key="DoubleTimesAHundredToIntConverter" />
        <c:UriToBitmap x:Key="UriToBitmapConverter" />
        <c:PathToFilename x:Key="PathToFilenameConverter" />
        <c:DoubleToThickness x:Key="DoubleToThicknessConverter" />
        <c:SelectionToEditingMode x:Key="SelectionToEditingModeConverter" />
        <c:SelectionToDrawingAttributes x:Key="SelectionToDrawingAttributesConverter" />
        <c:SelectionToStylusShape x:Key="SelectionToStylusShapeConverter" />
        <c:StylusTipToBool x:Key="StylusTipToBoolConverter" />
        <c:FontToSupportedGliph x:Key="FontToSupportedGliphConverter" />
        <c:FormatConverter x:Key="FormatConverter" />
        <c:BoolAndToVisibility x:Key="BoolAndToVisibility" />
        <c:IntToBool x:Key="IntToBool" />
        <c:BoolAndOrOrToVisibility x:Key="BoolAndOrOrToVisibility" />

        <Storyboard x:Key="ShowPanelStoryboard">
            <BooleanAnimationUsingKeyFrames
                Storyboard.TargetName="ActionGrid"
                Storyboard.TargetProperty="IsHitTestVisible"
                Duration="0:0:0">
                <DiscreteBooleanKeyFrame
                    KeyTime="0:0:0"
                    Value="True" />
            </BooleanAnimationUsingKeyFrames>

            <DoubleAnimation
                Storyboard.TargetName="ActionGrid"
                Storyboard.TargetProperty="(Grid.MinWidth)"
                From="{Binding ElementName=ActionGrid, Path=ActualWidth}"
                To="280"
                Duration="0:0:1">
                <DoubleAnimation.EasingFunction>
                    <PowerEase Power="8" />
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation
                Storyboard.TargetName="ActionGrid"
                Storyboard.TargetProperty="(Grid.Width)"
                From="{Binding ElementName=ActionGrid, Path=ActualWidth}"
                To="280"
                Duration="0:0:1">
                <DoubleAnimation.EasingFunction>
                    <PowerEase Power="8" />
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation
                Storyboard.TargetName="ActionGrid"
                Storyboard.TargetProperty="(Grid.Opacity)"
                From="{Binding ElementName=ActionGrid, Path=Opacity}"
                To="1"
                Duration="0:0:1">
                <DoubleAnimation.EasingFunction>
                    <PowerEase Power="8" />
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>

        <Storyboard x:Key="ShowExtendedPanelStoryboard">
            <BooleanAnimationUsingKeyFrames
                Storyboard.TargetName="ActionGrid"
                Storyboard.TargetProperty="IsHitTestVisible"
                Duration="0:0:0">
                <DiscreteBooleanKeyFrame
                    KeyTime="0:0:0"
                    Value="True" />
            </BooleanAnimationUsingKeyFrames>

            <DoubleAnimation
                Storyboard.TargetName="ActionGrid"
                Storyboard.TargetProperty="(Grid.MinWidth)"
                From="{Binding ElementName=ActionGrid, Path=ActualWidth}"
                To="320"
                Duration="0:0:1">
                <DoubleAnimation.EasingFunction>
                    <PowerEase Power="8" />
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation
                Storyboard.TargetName="ActionGrid"
                Storyboard.TargetProperty="(Grid.Width)"
                From="{Binding ElementName=ActionGrid, Path=ActualWidth}"
                To="320"
                Duration="0:0:1">
                <DoubleAnimation.EasingFunction>
                    <PowerEase Power="8" />
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation
                Storyboard.TargetName="ActionGrid"
                Storyboard.TargetProperty="(Grid.Opacity)"
                From="{Binding ElementName=ActionGrid, Path=Opacity}"
                To="1"
                Duration="0:0:1">
                <DoubleAnimation.EasingFunction>
                    <PowerEase Power="8" />
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>

        <Storyboard x:Key="HidePanelStoryboard">
            <BooleanAnimationUsingKeyFrames
                Storyboard.TargetName="ActionGrid"
                Storyboard.TargetProperty="IsHitTestVisible"
                Duration="0:0:0">
                <DiscreteBooleanKeyFrame
                    KeyTime="0:0:0"
                    Value="False" />
            </BooleanAnimationUsingKeyFrames>

            <DoubleAnimation
                Storyboard.TargetName="ActionGrid"
                Storyboard.TargetProperty="(Grid.MinWidth)"
                From="{Binding ElementName=ActionGrid, Path=ActualWidth}"
                To="0"
                Duration="0:0:1">
                <DoubleAnimation.EasingFunction>
                    <PowerEase Power="8" />
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation
                Storyboard.TargetName="ActionGrid"
                Storyboard.TargetProperty="(Grid.Width)"
                From="{Binding ElementName=ActionGrid, Path=ActualWidth}"
                To="0"
                Duration="0:0:1">
                <DoubleAnimation.EasingFunction>
                    <PowerEase Power="8" />
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation
                Storyboard.TargetName="ActionGrid"
                Storyboard.TargetProperty="(Grid.Opacity)"
                From="{Binding ElementName=ActionGrid, Path=Opacity}"
                To="0"
                Duration="0:0:1">
                <DoubleAnimation.EasingFunction>
                    <PowerEase Power="8" />
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>

        <Storyboard x:Key="HideWelcomeBorderStoryboard">
            <DoubleAnimation
                Storyboard.TargetName="WelcomeGrid"
                Storyboard.TargetProperty="(Grid.Opacity)"
                From="{Binding ElementName=WelcomeGrid, Path=Opacity}"
                To="0"
                Duration="0:0:1">
                <DoubleAnimation.EasingFunction>
                    <PowerEase Power="8" />
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>

            <ObjectAnimationUsingKeyFrames
                Storyboard.TargetName="WelcomeGrid"
                Storyboard.TargetProperty="Visibility"
                Duration="0:0:1">
                <DiscreteObjectKeyFrame
                    KeyTime="0:0:1"
                    Value="{x:Static Visibility.Collapsed}" />
            </ObjectAnimationUsingKeyFrames>
        </Storyboard>

        <Storyboard x:Key="ShowWelcomeBorderStoryboard">
            <ObjectAnimationUsingKeyFrames
                Storyboard.TargetName="WelcomeGrid"
                Storyboard.TargetProperty="Visibility"
                Duration="0:0:0">
                <DiscreteObjectKeyFrame
                    KeyTime="0:0:0"
                    Value="{x:Static Visibility.Visible}" />
            </ObjectAnimationUsingKeyFrames>

            <DoubleAnimation
                Storyboard.TargetName="WelcomeGrid"
                Storyboard.TargetProperty="(Grid.Opacity)"
                From="0"
                To="1"
                Duration="0:0:1">
                <DoubleAnimation.EasingFunction>
                    <PowerEase Power="8" />
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>

        <Storyboard x:Key="HideOverlayGridStoryboard">
            <DoubleAnimation
                Storyboard.TargetName="OverlayGrid"
                Storyboard.TargetProperty="(Grid.Opacity)"
                From="{Binding ElementName=OverlayGrid, Path=Opacity}"
                To="0"
                Duration="0:0:1">
                <DoubleAnimation.EasingFunction>
                    <PowerEase Power="8" />
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>

            <ObjectAnimationUsingKeyFrames
                Storyboard.TargetName="OverlayGrid"
                Storyboard.TargetProperty="Visibility"
                Duration="0:0:1">
                <DiscreteObjectKeyFrame
                    KeyTime="0:0:1"
                    Value="{x:Static Visibility.Collapsed}" />
            </ObjectAnimationUsingKeyFrames>
        </Storyboard>

        <Storyboard x:Key="ShowOverlayGridStoryboard">
            <ObjectAnimationUsingKeyFrames
                Storyboard.TargetName="OverlayGrid"
                Storyboard.TargetProperty="Visibility"
                Duration="0:0:0">
                <DiscreteObjectKeyFrame
                    KeyTime="0:0:0"
                    Value="{x:Static Visibility.Visible}" />
            </ObjectAnimationUsingKeyFrames>

            <DoubleAnimation
                Storyboard.TargetName="OverlayGrid"
                Storyboard.TargetProperty="(Grid.Opacity)"
                From="0"
                To="1"
                Duration="0:0:1">
                <DoubleAnimation.EasingFunction>
                    <PowerEase Power="8" />
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>

        <Storyboard x:Key="ShowHintStoryboard">
            <ObjectAnimationUsingKeyFrames
                Storyboard.TargetName="HintStackPanel"
                Storyboard.TargetProperty="Visibility"
                Duration="0:0:0">
                <DiscreteObjectKeyFrame
                    KeyTime="0:0:0"
                    Value="{x:Static Visibility.Visible}" />
            </ObjectAnimationUsingKeyFrames>

            <DoubleAnimation
                Storyboard.TargetName="HintStackPanel"
                Storyboard.TargetProperty="Opacity"
                From="0"
                To="1"
                Duration="0:0:1.5">
                <DoubleAnimation.EasingFunction>
                    <PowerEase Power="8" />
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>

            <DoubleAnimation
                BeginTime="0:0:7"
                Storyboard.TargetName="HintStackPanel"
                Storyboard.TargetProperty="Opacity"
                From="{Binding ElementName=HintStackPanel, Path=Opacity}"
                To="0"
                Duration="0:0:3">
                <DoubleAnimation.EasingFunction>
                    <PowerEase Power="8" />
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>

            <ObjectAnimationUsingKeyFrames
                BeginTime="0:0:7"
                Storyboard.TargetName="HintStackPanel"
                Storyboard.TargetProperty="Visibility"
                Duration="0:0:3">
                <DiscreteObjectKeyFrame
                    KeyTime="0:0:3"
                    Value="{x:Static Visibility.Collapsed}" />
            </ObjectAnimationUsingKeyFrames>
        </Storyboard>

        <Storyboard x:Key="ShowPermanentHintStoryboard">
            <ObjectAnimationUsingKeyFrames
                Storyboard.TargetName="HintStackPanel"
                Storyboard.TargetProperty="Visibility"
                Duration="0:0:0">
                <DiscreteObjectKeyFrame
                    KeyTime="0:0:0"
                    Value="{x:Static Visibility.Visible}" />
            </ObjectAnimationUsingKeyFrames>

            <DoubleAnimation
                Storyboard.TargetName="HintStackPanel"
                Storyboard.TargetProperty="Opacity"
                From="0"
                To="1"
                Duration="0:0:1.5">
                <DoubleAnimation.EasingFunction>
                    <PowerEase Power="8" />
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>

        <Storyboard x:Key="HideHintStoryboard">
            <DoubleAnimation
                Storyboard.TargetName="HintStackPanel"
                Storyboard.TargetProperty="(Grid.Opacity)"
                From="{Binding ElementName=HintStackPanel, Path=Opacity}"
                To="0"
                Duration="0:0:1">
                <DoubleAnimation.EasingFunction>
                    <PowerEase Power="8" />
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>

            <ObjectAnimationUsingKeyFrames
                Storyboard.TargetName="HintStackPanel"
                Storyboard.TargetProperty="Visibility"
                Duration="0:0:1">
                <DiscreteObjectKeyFrame
                    KeyTime="0:0:1"
                    Value="{x:Static Visibility.Collapsed}" />
            </ObjectAnimationUsingKeyFrames>
        </Storyboard>

        <CollectionViewSource
            x:Key="MyFonts"
            x:Shared="False"
            Source="{Binding Source={x:Static Fonts.SystemFontFamilies}, Converter={StaticResource FontToSupportedGliphConverter}}">
            <CollectionViewSource.SortDescriptions>
                <cm:SortDescription PropertyName="Source" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>

        <DataTemplate x:Key="FontTemplate">
            <!--  x:Shared="False"  -->
            <VirtualizingStackPanel
                IsVirtualizing="True"
                ScrollViewer.IsDeferredScrollingEnabled="True"
                VirtualizationMode="Recycling">
                <TextBlock
                    FontFamily="{Binding .}"
                    FontSize="16"
                    Text="{Binding .}"
                    ToolTip="{Binding Path=.Source}" />
            </VirtualizingStackPanel>
        </DataTemplate>
    </Window.Resources>

    <Window.CommandBindings>
        <CommandBinding
            CanExecute="NewRecording_CanExecute"
            Command="{StaticResource Command.NewRecording}"
            Executed="NewRecording_Executed" />
        <CommandBinding
            CanExecute="NewRecording_CanExecute"
            Command="{StaticResource Command.NewWebcamRecording}"
            Executed="NewWebcamRecording_Executed" />
        <CommandBinding
            CanExecute="NewRecording_CanExecute"
            Command="{StaticResource Command.NewBoardRecording}"
            Executed="NewBoardRecording_Executed" />
        <CommandBinding
            CanExecute="NewProject_CanExecute"
            Command="{StaticResource Command.NewAnimation}"
            Executed="NewProject_Executed" />

        <!--  Insert  -->
        <CommandBinding
            CanExecute="Insert_CanExecute"
            Command="{StaticResource Command.InsertRecording}"
            Executed="InsertRecording_Executed" />
        <CommandBinding
            CanExecute="Insert_CanExecute"
            Command="{StaticResource Command.InsertWebcamRecording}"
            Executed="InsertWebcamRecording_Executed" />
        <CommandBinding
            CanExecute="Insert_CanExecute"
            Command="{StaticResource Command.InsertBoardRecording}"
            Executed="InsertBoardRecording_Executed" />
        <CommandBinding
            CanExecute="InsertFromMedia_CanExecute"
            Command="{StaticResource Command.InsertFromMedia}"
            Executed="InsertFromMedia_Executed" />

        <!--  File  -->
        <CommandBinding
            CanExecute="File_CanExecute"
            Command="{StaticResource Command.SaveAs}"
            Executed="SaveAs_Executed" />
        <CommandBinding
            CanExecute="NewProject_CanExecute"
            Command="{StaticResource Command.Load}"
            Executed="Load_Executed" />
        <CommandBinding
            CanExecute="NewProject_CanExecute"
            Command="{StaticResource Command.LoadRecent}"
            Executed="LoadRecent_Executed" />
        <CommandBinding
            CanExecute="File_CanExecute"
            Command="{StaticResource Command.DiscardProject}"
            Executed="DiscardProject_Executed" />

        <!--  Action Stack  -->
        <CommandBinding
            CanExecute="Undo_CanExecute"
            Command="{StaticResource Command.Undo}"
            Executed="Undo_Executed" />
        <CommandBinding
            CanExecute="Reset_CanExecute"
            Command="{StaticResource Command.Reset}"
            Executed="Reset_Executed" />
        <CommandBinding
            CanExecute="Redo_CanExecute"
            Command="{StaticResource Command.Redo}"
            Executed="Redo_Executed" />

        <!--  Clipboard  -->
        <CommandBinding
            CanExecute="ClipBoard_CanExecute"
            Command="{StaticResource Command.Cut}"
            Executed="Cut_Executed" />
        <CommandBinding
            CanExecute="ClipBoard_CanExecute"
            Command="{StaticResource Command.Copy}"
            Executed="Copy_Executed" />
        <CommandBinding
            CanExecute="Paste_CanExecute"
            Command="{StaticResource Command.Paste}"
            Executed="Paste_Executed" />
        <CommandBinding
            CanExecute="ClipBoardSelection_CanExecute"
            Command="{StaticResource Command.ExploreClipboard}"
            Executed="ExploreClipBoard_Executed" />
        <CommandBinding
            CanExecute="ClipBoardSelection_CanExecute"
            Command="{StaticResource Command.RemoveClipboardEntry}"
            Executed="RemoveClipboard_Executed" />

        <!--  Zoom  -->
        <CommandBinding
            CanExecute="Zoom_CanExecute"
            Command="{StaticResource Command.Zoom100}"
            Executed="Zoom100_Executed" />
        <CommandBinding
            x:Name="SizeToContentCommand"
            CanExecute="Zoom_CanExecute"
            Command="{StaticResource Command.SizeToContent}"
            Executed="SizeToContent_Executed" />
        <CommandBinding
            x:Name="FitImageCommand"
            CanExecute="Zoom_CanExecute"
            Command="{StaticResource Command.FitImage}"
            Executed="FitImage_Executed" />

        <!--  Select  -->
        <CommandBinding
            CanExecute="Selection_CanExecute"
            Command="{StaticResource Command.SelectAll}"
            Executed="SelectAll_Executed" />
        <CommandBinding
            CanExecute="Selection_CanExecute"
            Command="{StaticResource Command.GoTo}"
            Executed="GoTo_Executed" />
        <CommandBinding
            CanExecute="Selection_CanExecute"
            Command="{StaticResource Command.InverseSelection}"
            Executed="InverseSelection_Executed" />
        <CommandBinding
            CanExecute="Image_CanExecute"
            Command="{StaticResource Command.Unselect}"
            Executed="DeselectAll_Executed" />

        <!--  Playback  -->
        <CommandBinding
            CanExecute="Playback_CanExecute"
            Command="{StaticResource Command.FirstFrame}"
            Executed="FirstFrame_Executed" />
        <CommandBinding
            CanExecute="Playback_CanExecute"
            Command="{StaticResource Command.PreviousFrame}"
            Executed="PreviousFrame_Executed" />
        <CommandBinding
            CanExecute="Playback_CanExecute"
            Command="{StaticResource Command.Play}"
            Executed="Play_Executed" />
        <CommandBinding
            CanExecute="Playback_CanExecute"
            Command="{StaticResource Command.NextFrame}"
            Executed="NextFrame_Executed" />
        <CommandBinding
            CanExecute="Playback_CanExecute"
            Command="{StaticResource Command.LastFrame}"
            Executed="LastFrame_Executed" />

        <!--  Frames  -->
        <CommandBinding
            CanExecute="Delete_CanExecute"
            Command="{StaticResource Command.Delete}"
            Executed="Delete_Executed" />
        <CommandBinding
            CanExecute="DeletePrevious_CanExecute"
            Command="{StaticResource Command.DeletePrevious}"
            Executed="DeletePrevious_Executed" />
        <CommandBinding
            CanExecute="DeleteNext_CanExecute"
            Command="{StaticResource Command.DeleteNext}"
            Executed="DeleteNext_Executed" />
        <CommandBinding
            CanExecute="RemoveDuplicates_CanExecute"
            Command="{StaticResource Command.RemoveDuplicates}"
            Executed="RemoveDuplicates_Executed" />
        <CommandBinding
            CanExecute="Reduce_CanExecute"
            Command="{StaticResource Command.Reduce}"
            Executed="Reduce_Executed" />
        <CommandBinding
            CanExecute="RemoveDuplicates_CanExecute"
            Command="{StaticResource Command.SmoothLoop}"
            Executed="SmoothLoop_Executed" />

        <!--  Reordering  -->
        <CommandBinding
            CanExecute="Reordering_CanExecute"
            Command="{StaticResource Command.Reverse}"
            Executed="Reverse_Executed" />
        <CommandBinding
            CanExecute="Reordering_CanExecute"
            Command="{StaticResource Command.Yoyo}"
            Executed="Yoyo_Executed" />
        <CommandBinding
            CanExecute="Reordering_CanExecute"
            Command="{StaticResource Command.MoveLeft}"
            Executed="MoveLeft_Executed" />
        <CommandBinding
            CanExecute="Reordering_CanExecute"
            Command="{StaticResource Command.MoveRight}"
            Executed="MoveRight_Executed" />

        <!--  Delay (Duration)  -->
        <CommandBinding
            CanExecute="Image_CanExecute"
            Command="{StaticResource Command.OverrideDelay}"
            Executed="OverrideDelay_Executed" />
        <CommandBinding
            CanExecute="Image_CanExecute"
            Command="{StaticResource Command.IncreaseDecreaseDelay}"
            Executed="IncreaseDecreaseDelay_Executed" />
        <CommandBinding
            CanExecute="Image_CanExecute"
            Command="{StaticResource Command.ScaleDelay}"
            Executed="ScaleDelay_Executed" />

        <!--  Image  -->
        <CommandBinding
            CanExecute="Image_CanExecute"
            Command="{StaticResource Command.Resize}"
            Executed="Resize_Executed" />
        <CommandBinding
            CanExecute="Image_CanExecute"
            Command="{StaticResource Command.Crop}"
            Executed="Crop_Executed" />
        <CommandBinding
            CanExecute="Image_CanExecute"
            Command="{StaticResource Command.FlipRotate}"
            Executed="FlipRotate_Executed" />

        <CommandBinding
            CanExecute="Image_CanExecute"
            Command="{StaticResource Command.Caption}"
            Executed="Caption_Executed" />
        <CommandBinding
            CanExecute="Image_CanExecute"
            Command="{StaticResource Command.FreeText}"
            Executed="FreeText_Executed" />
        <CommandBinding
            CanExecute="Image_CanExecute"
            Command="{StaticResource Command.TitleFrame}"
            Executed="TitleFrame_Executed" />
        <CommandBinding
            CanExecute="Image_CanExecute"
            Command="{StaticResource Command.KeyStrokes}"
            Executed="KeyStrokes_Executed" />

        <CommandBinding
            CanExecute="Image_CanExecute"
            Command="{StaticResource Command.FreeDrawing}"
            Executed="FreeDrawing_Executed" />
        <CommandBinding
            CanExecute="Image_CanExecute"
            Command="{StaticResource Command.Shapes}"
            Executed="Shapes_Executed" />
        <CommandBinding
            CanExecute="Image_CanExecute"
            Command="{StaticResource Command.MouseEvents}"
            Executed="MouseEvents_Executed" />
        <CommandBinding
            CanExecute="Image_CanExecute"
            Command="{StaticResource Command.Watermark}"
            Executed="Watermark_Executed" />
        <CommandBinding
            CanExecute="Image_CanExecute"
            Command="{StaticResource Command.Border}"
            Executed="Border_Executed" />
        <CommandBinding
            CanExecute="Image_CanExecute"
            Command="{StaticResource Command.Shadow}"
            Executed="Shadow_Executed" />
        <CommandBinding
            CanExecute="Image_CanExecute"
            Command="{StaticResource Command.Obfuscate}"
            Executed="Obfuscate_Executed" />
        <CommandBinding
            CanExecute="Image_CanExecute"
            Command="{StaticResource Command.Cinemagraph}"
            Executed="Cinemagraph_Executed" />
        <CommandBinding
            CanExecute="Image_CanExecute"
            Command="{StaticResource Command.Progress}"
            Executed="Progress_Executed" />

        <!--  Transitions  -->
        <CommandBinding
            CanExecute="Transition_CanExecute"
            Command="{StaticResource Command.Fade}"
            Executed="Fade_Executed" />
        <CommandBinding
            CanExecute="Transition_CanExecute"
            Command="{StaticResource Command.Slide}"
            Executed="Slide_Executed" />

        <!--  Apply and Cancel  -->
        <CommandBinding
            x:Name="OkCommandBinding2"
            CanExecute="PanelAction_CanExecute"
            Command="{StaticResource Command.Ok}"
            Executed="Ok_Executed" />
        <CommandBinding
            x:Name="CancelCommandBinding"
            CanExecute="PanelAction_CanExecute"
            Command="{StaticResource Command.Cancel}"
            Executed="Cancel_Executed" />

        <!--  Frame list  -->
        <CommandBinding
            CanExecute="ListFramesSelection_CanExecute"
            Command="{StaticResource Command.OpenImage}"
            Executed="OpenImage_Executed" />
        <CommandBinding
            CanExecute="ListFramesSelection_CanExecute"
            Command="{StaticResource Command.ExploreFolder}"
            Executed="ExploreFolder_Executed" />
    </Window.CommandBindings>

    <Window.TaskbarItemInfo>
        <TaskbarItemInfo Description="{DynamicResource S.Editor.Title}">
            <!--<TaskbarItemInfo.ThumbButtonInfos>
                <ThumbButtonInfoCollection>
                    <ThumbButtonInfo x:Name="NewRecordingThumbInfo" Command="u:Commands.NewRecording" DismissWhenClicked="True"
                                     Description="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureTextConverter}}"
                                     CommandTarget="{Binding ElementName=NewRecordingButton}">
                        <ThumbButtonInfo.ImageSource>
                            <DrawingImage>
                                <DrawingImage.Drawing>
                                    <GeometryDrawing>
                                        <GeometryDrawing.Geometry>
                                            <RectangleGeometry Rect="0,0,20,20"/>
                                        </GeometryDrawing.Geometry>
                                        <GeometryDrawing.Brush>
                                            <VisualBrush Visual="{StaticResource Vector.Record.New}" Stretch="Uniform"/>
                                        </GeometryDrawing.Brush>
                                    </GeometryDrawing>
                                </DrawingImage.Drawing>
                            </DrawingImage>
                        </ThumbButtonInfo.ImageSource>
                    </ThumbButtonInfo>

                    <ThumbButtonInfo x:Name="NewWebcamRecordingThumbInfo" Command="u:Commands.NewWebcamRecording" DismissWhenClicked="True"
                                     Description="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureTextConverter}}"
                                     CommandTarget="{Binding ElementName=NewWebcamRecordingButton}">
                        <ThumbButtonInfo.ImageSource>
                            <DrawingImage>
                                <DrawingImage.Drawing>
                                    <GeometryDrawing>
                                        <GeometryDrawing.Geometry>
                                            <RectangleGeometry Rect="0,0,20,20"/>
                                        </GeometryDrawing.Geometry>
                                        <GeometryDrawing.Brush>
                                            <VisualBrush Visual="{StaticResource Vector.Camera.New}" Stretch="Uniform"/>
                                        </GeometryDrawing.Brush>
                                    </GeometryDrawing>
                                </DrawingImage.Drawing>
                            </DrawingImage>
                        </ThumbButtonInfo.ImageSource>
                    </ThumbButtonInfo>

                    <ThumbButtonInfo x:Name="NewBoardRecordingThumbInfo" Command="u:Commands.NewBoardRecording" DismissWhenClicked="True"
                                     Description="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureTextConverter}}"
                                     CommandTarget="{Binding ElementName=NewBoardRecordingButton}">
                        <ThumbButtonInfo.ImageSource>
                            <DrawingImage>
                                <DrawingImage.Drawing>
                                    <GeometryDrawing>
                                        <GeometryDrawing.Geometry>
                                            <RectangleGeometry Rect="0,0,20,20"/>
                                        </GeometryDrawing.Geometry>
                                        <GeometryDrawing.Brush>
                                            <VisualBrush Visual="{StaticResource Vector.Board.New}" Stretch="Uniform"/>
                                        </GeometryDrawing.Brush>
                                    </GeometryDrawing>
                                </DrawingImage.Drawing>
                            </DrawingImage>
                        </ThumbButtonInfo.ImageSource>
                    </ThumbButtonInfo>

                    <ThumbButtonInfo x:Name="NewFromMediaProjectThumbInfo" Command="u:Commands.NewFromMediaProject" DismissWhenClicked="True"
                                     Description="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureTextConverter}}"
                                     CommandTarget="{Binding ElementName=OpenMediaProjectButton}">
                        <ThumbButtonInfo.ImageSource>
                            <DrawingImage>
                                <DrawingImage.Drawing>
                                    <GeometryDrawing>
                                        <GeometryDrawing.Geometry>
                                            <RectangleGeometry Rect="0,0,20,20"/>
                                        </GeometryDrawing.Geometry>
                                        <GeometryDrawing.Brush>
                                            <VisualBrush Visual="{StaticResource Vector.Open}" Stretch="Uniform"/>
                                        </GeometryDrawing.Brush>
                                    </GeometryDrawing>
                                </DrawingImage.Drawing>
                            </DrawingImage>
                        </ThumbButtonInfo.ImageSource>
                    </ThumbButtonInfo>

                    <ThumbButtonInfo Visibility="Hidden"/>

                    <ThumbButtonInfo x:Name="DiscardThumbInfo" Command="u:Commands.DiscardProject" DismissWhenClicked="True"
                                     Description="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureTextConverter}}"
                                     CommandTarget="{Binding ElementName=DiscardProjectButton}">
                        <ThumbButtonInfo.ImageSource>
                            <DrawingImage>
                                <DrawingImage.Drawing>
                                    <GeometryDrawing>
                                        <GeometryDrawing.Geometry>
                                            <RectangleGeometry Rect="0,0,20,20"/>
                                        </GeometryDrawing.Geometry>
                                        <GeometryDrawing.Brush>
                                            <VisualBrush Visual="{StaticResource Vector.Remove}" Stretch="Uniform"/>
                                        </GeometryDrawing.Brush>
                                    </GeometryDrawing>
                                </DrawingImage.Drawing>
                            </DrawingImage>
                        </ThumbButtonInfo.ImageSource>
                    </ThumbButtonInfo>
                </ThumbButtonInfoCollection>
            </TaskbarItemInfo.ThumbButtonInfos>-->
        </TaskbarItemInfo>
    </Window.TaskbarItemInfo>

    <Grid
        x:Name="MainGrid"
        DataContext="{Binding ElementName=FrameListView, Path=SelectedItem}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="20" />
        </Grid.RowDefinitions>

        <n:HideableTabControl
            x:Name="RibbonTabControl"
            Grid.Row="0"
            Effect="{StaticResource Shadow.Border.Tiny}"
            FeedbackCommand="{Binding Source={StaticResource AppViewModel}, Path=OpenFeedback}"
            Focusable="False"
            FontSize="13"
            HelpCommand="{Binding Source={StaticResource AppViewModel}, Path=OpenHelp}"
            IsTabStop="False"
            OptionsCommand="{Binding Source={StaticResource AppViewModel}, Path=OpenOptions}"
            TroubleshootCommand="{Binding Source={StaticResource AppViewModel}, Path=OpenTroubleshoot}">

            <n:AwareTabItem
                Header="{DynamicResource S.Editor.File}"
                Icon="{StaticResource Vector.Save}">
                <Grid
                    Height="94"
                    Margin="2"
                    Background="{DynamicResource Panel.Background.Level2}"
                    Effect="{StaticResource Shadow.Invariant}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="7" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="7" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="7" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>

                    <Grid
                        Grid.Column="0"
                        Margin="0,1,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition Height="16" />
                        </Grid.RowDefinitions>

                        <Label
                            Grid.Row="1"
                            Grid.Column="0"
                            Grid.ColumnSpan="4"
                            Padding="0"
                            HorizontalContentAlignment="Center"
                            VerticalContentAlignment="Center"
                            Content="{DynamicResource S.Editor.File.New}"
                            FontSize="12"
                            Foreground="{DynamicResource Element.Foreground.Gray112}" />

                        <n:ExtendedButton
                            x:Name="NewRecordingButton"
                            Grid.Row="0"
                            Grid.Column="0"
                            MinWidth="55"
                            Command="{StaticResource Command.NewRecording}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.Record.New}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.File.New.Recording}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedButton
                            x:Name="NewWebcamRecordingButton"
                            Grid.Row="0"
                            Grid.Column="1"
                            MinWidth="55"
                            Command="{StaticResource Command.NewWebcamRecording}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.Camera.New}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.File.New.Webcam}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedButton
                            x:Name="NewBoardRecordingButton"
                            Grid.Row="0"
                            Grid.Column="2"
                            MinWidth="55"
                            Command="{StaticResource Command.NewBoardRecording}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.Board.New}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.File.New.Board}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedButton
                            x:Name="NewAnimationButton"
                            Grid.Row="0"
                            Grid.Column="3"
                            MinWidth="55"
                            Command="{StaticResource Command.NewAnimation}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.File.New}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.File.Blank}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />
                    </Grid>

                    <Separator
                        Grid.Row="0"
                        Grid.Column="1"
                        Width="1"
                        Height="Auto"
                        Margin="3,2"
                        HorizontalAlignment="Left" />

                    <Grid
                        Grid.Column="2"
                        Margin="0,1,0,0"
                        IsEnabled="{Binding FilledList, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type l:Editor}}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition Height="16" />
                        </Grid.RowDefinitions>

                        <Label
                            Grid.Row="1"
                            Grid.Column="0"
                            Grid.ColumnSpan="4"
                            Padding="0"
                            HorizontalContentAlignment="Center"
                            VerticalContentAlignment="Center"
                            Content="{DynamicResource S.Editor.File.Insert}"
                            FontSize="12"
                            Foreground="{DynamicResource Element.Foreground.Gray112}" />

                        <n:ExtendedButton
                            x:Name="InsertRecordingButton"
                            Grid.Row="0"
                            Grid.Column="0"
                            MinWidth="55"
                            Command="{StaticResource Command.InsertRecording}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.Record.Add}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.File.Insert.Recording}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedButton
                            x:Name="InsertWebcamRecordingButton"
                            Grid.Row="0"
                            Grid.Column="1"
                            MinWidth="55"
                            Command="{StaticResource Command.InsertWebcamRecording}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.Camera.Add}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.File.Insert.Webcam}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedButton
                            x:Name="InsertBoardRecordingButton"
                            Grid.Row="0"
                            Grid.Column="2"
                            MinWidth="55"
                            Command="{StaticResource Command.InsertBoardRecording}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.Board.Add}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.File.Insert.Board}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedButton
                            x:Name="InsertImageButton"
                            Grid.Row="0"
                            Grid.Column="3"
                            MinWidth="55"
                            Command="{StaticResource Command.InsertFromMedia}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.Open}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.File.Insert.Media}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />
                    </Grid>

                    <Separator
                        Grid.Row="0"
                        Grid.Column="3"
                        Width="1"
                        Height="Auto"
                        Margin="3,2"
                        HorizontalAlignment="Left" />

                    <Grid
                        Grid.Column="4"
                        Margin="0,1,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition Height="16" />
                        </Grid.RowDefinitions>

                        <Label
                            Grid.Row="1"
                            Grid.Column="0"
                            Grid.ColumnSpan="4"
                            Padding="0"
                            HorizontalContentAlignment="Center"
                            VerticalContentAlignment="Center"
                            Content="{DynamicResource S.Editor.File}"
                            FontSize="12"
                            Foreground="{DynamicResource Element.Foreground.Gray112}" />

                        <n:ExtendedButton
                            x:Name="SaveButton"
                            Grid.Row="0"
                            Grid.Column="0"
                            MinWidth="55"
                            Command="{StaticResource Command.SaveAs}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.Save}"
                            IsEnabled="{Binding FilledList, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type l:Editor}}}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.File.Save}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedButton
                            x:Name="LoadButton"
                            Grid.Row="0"
                            Grid.Column="1"
                            MinWidth="55"
                            Command="{StaticResource Command.Load}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.Open}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.File.Load}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedButton
                            x:Name="RecentButton"
                            Grid.Row="0"
                            Grid.Column="2"
                            MinWidth="55"
                            Command="{StaticResource Command.LoadRecent}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.Project}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.File.LoadRecent}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedButton
                            x:Name="DiscardProjectButton"
                            Grid.Row="0"
                            Grid.Column="3"
                            MinWidth="55"
                            Command="{StaticResource Command.DiscardProject}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.Remove}"
                            IsEnabled="{Binding FilledList, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type l:Editor}}}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.File.Discard}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />
                    </Grid>

                    <Separator
                        Grid.Row="0"
                        Grid.Column="5"
                        Width="1"
                        Height="Auto"
                        Margin="3,2"
                        HorizontalAlignment="Left" />
                </Grid>
            </n:AwareTabItem>

            <n:AwareTabItem
                Header="{DynamicResource S.Editor.Home}"
                Icon="{StaticResource Vector.Editor}"
                IsSelected="True">
                <Grid
                    Height="94"
                    Margin="2"
                    Background="{DynamicResource Panel.Background.Level2}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="7" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="7" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="7" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="7" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>

                    <!--  Action Stack  -->
                    <Grid
                        Grid.Column="0"
                        Margin="0,1,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition Height="16" />
                        </Grid.RowDefinitions>

                        <Label
                            Grid.Row="1"
                            Grid.Column="0"
                            Grid.ColumnSpan="2"
                            Padding="0"
                            HorizontalContentAlignment="Center"
                            VerticalContentAlignment="Center"
                            Content="{DynamicResource S.Editor.Home.ActionStack}"
                            FontSize="12"
                            Foreground="{DynamicResource Element.Foreground.Gray112}" />

                        <n:ExtendedButton
                            x:Name="UndoButton"
                            Grid.Row="0"
                            Grid.Column="0"
                            MinWidth="55"
                            Command="{StaticResource Command.Undo}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.Undo}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Home.Undo}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <Grid
                            Grid.Row="0"
                            Grid.Column="1">
                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition />
                            </Grid.RowDefinitions>

                            <n:ExtendedButton
                                x:Name="ResetButton"
                                Grid.Row="0"
                                MinWidth="60"
                                Padding="3"
                                Command="{StaticResource Command.Reset}"
                                ContentHeight="25"
                                ContentWidth="25"
                                Icon="{StaticResource Vector.Repeat}"
                                Style="{StaticResource Style.Button.Horizontal}"
                                Text="{DynamicResource S.Editor.Home.Reset}"
                                ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                                ToolTipService.HorizontalOffset="-5"
                                ToolTipService.Placement="Top" />

                            <n:ExtendedButton
                                x:Name="RedoButton"
                                Grid.Row="1"
                                MinWidth="60"
                                Padding="3"
                                Command="{StaticResource Command.Redo}"
                                ContentHeight="25"
                                ContentWidth="25"
                                Icon="{StaticResource Vector.Redo}"
                                Style="{StaticResource Style.Button.Horizontal}"
                                Text="{DynamicResource S.Editor.Home.Redo}"
                                ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                                ToolTipService.HorizontalOffset="-5"
                                ToolTipService.Placement="Bottom" />
                        </Grid>
                    </Grid>

                    <Separator
                        Grid.Row="0"
                        Grid.Column="1"
                        Width="1"
                        Height="Auto"
                        Margin="3,2"
                        HorizontalAlignment="Left" />

                    <!--  Clipboard  -->
                    <Grid
                        Grid.Column="2"
                        Margin="0,1,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition Height="16" />
                        </Grid.RowDefinitions>

                        <Grid
                            Grid.Row="1"
                            Grid.Column="0"
                            Grid.ColumnSpan="2">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>

                            <Label
                                Grid.Column="0"
                                Padding="0"
                                HorizontalContentAlignment="Center"
                                VerticalContentAlignment="Center"
                                Content="{DynamicResource S.Editor.Home.Clipboard}"
                                FontSize="12"
                                Foreground="{DynamicResource Element.Foreground.Gray112}" />

                            <n:ExtendedButton
                                x:Name="ShowClipboardButton"
                                Grid.Column="1"
                                MinWidth="10"
                                Margin="0,0,-2,-2"
                                Padding="5,0"
                                Click="ShowClipboardButton_Click"
                                ContentHeight="8"
                                ContentWidth="8"
                                Icon="{StaticResource Vector.Launcher}"
                                Style="{StaticResource Style.Button.NoText}"
                                ToolTip="{DynamicResource S.Editor.Home.Clipboard.Show}"
                                ToolTipService.Placement="Bottom" />
                        </Grid>

                        <n:ExtendedButton
                            x:Name="PasteButton"
                            Grid.Row="0"
                            Grid.Column="0"
                            MinWidth="55"
                            Command="{StaticResource Command.Paste}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.Paste}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Home.Paste}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <Grid
                            Grid.Row="0"
                            Grid.Column="1">
                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition />
                            </Grid.RowDefinitions>

                            <n:ExtendedButton
                                x:Name="CopyButton"
                                Grid.Row="0"
                                Grid.Column="0"
                                MinWidth="60"
                                Padding="2"
                                Command="{StaticResource Command.Copy}"
                                ContentHeight="25"
                                ContentWidth="25"
                                Icon="{StaticResource Vector.Copy}"
                                Style="{StaticResource Style.Button.Horizontal}"
                                Text="{DynamicResource S.Editor.Home.Copy}"
                                ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                                ToolTipService.HorizontalOffset="-5"
                                ToolTipService.Placement="Top" />

                            <n:ExtendedButton
                                x:Name="CutButton"
                                Grid.Row="1"
                                MinWidth="60"
                                Padding="2"
                                Command="{StaticResource Command.Cut}"
                                ContentHeight="25"
                                ContentWidth="25"
                                Icon="{StaticResource Vector.Cut}"
                                Style="{StaticResource Style.Button.Horizontal}"
                                Text="{DynamicResource S.Editor.Home.Cut}"
                                ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                                ToolTipService.HorizontalOffset="-5"
                                ToolTipService.Placement="Bottom" />
                        </Grid>
                    </Grid>

                    <Separator
                        Grid.Row="0"
                        Grid.Column="3"
                        Width="1"
                        Height="Auto"
                        Margin="3,2"
                        HorizontalAlignment="Left" />

                    <!--  Zoom  -->
                    <Grid
                        Grid.Column="4"
                        Margin="0,1,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition Height="16" />
                        </Grid.RowDefinitions>

                        <Label
                            Grid.Row="1"
                            Grid.Column="0"
                            Grid.ColumnSpan="3"
                            Padding="0"
                            HorizontalContentAlignment="Center"
                            VerticalContentAlignment="Center"
                            Content="{DynamicResource S.Editor.Home.Zoom}"
                            FontSize="12"
                            Foreground="{DynamicResource Element.Foreground.Gray112}" />

                        <n:ExtendedButton
                            x:Name="Zoom100Button"
                            Grid.Row="0"
                            Grid.Column="0"
                            MinWidth="55"
                            Command="{StaticResource Command.Zoom100}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.Fit}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="100%"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedButton
                            x:Name="FitOnContentButton"
                            Grid.Row="0"
                            Grid.Column="1"
                            MinWidth="55"
                            Command="{StaticResource Command.SizeToContent}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.SizeToContent}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Home.SizeToContent}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <Grid
                            Grid.Row="0"
                            Grid.Column="2">
                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition />
                            </Grid.RowDefinitions>

                            <StackPanel
                                Grid.Row="0"
                                Margin="0,5"
                                IsEnabled="{Binding ElementName=Zoom100Button, Path=IsEnabled}"
                                Orientation="Horizontal">
                                <Grid
                                    Width="22"
                                    Height="22"
                                    Background="{StaticResource Vector.Zoom}"
                                    Opacity="{DynamicResource Element.Opacity}" />
                                <n:IntegerUpDown
                                    x:Name="ZoomNumericUpDown"
                                    MinWidth="60"
                                    Margin="5,0,0,0"
                                    Maximum="500"
                                    Minimum="5"
                                    Value="{Binding Zoom, Converter={StaticResource IntToDecimalConverter}, ElementName=ZoomBoxControl, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                <TextBlock
                                    Padding="3,0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground}"
                                    Text="%" />
                            </StackPanel>

                            <n:ExtendedButton
                                x:Name="FitButton"
                                Grid.Row="1"
                                Grid.Column="0"
                                MinWidth="60"
                                Padding="3"
                                VerticalContentAlignment="Center"
                                Command="{StaticResource Command.FitImage}"
                                ContentHeight="25"
                                ContentWidth="30"
                                Icon="{StaticResource Vector.PictureFit}"
                                Style="{StaticResource Style.Button.Horizontal}"
                                Text="{DynamicResource S.Editor.Home.FitImage}"
                                ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                                ToolTipService.HorizontalOffset="-5"
                                ToolTipService.Placement="Bottom" />
                        </Grid>
                    </Grid>

                    <Separator
                        Grid.Row="0"
                        Grid.Column="5"
                        Width="1"
                        Height="Auto"
                        Margin="3,2"
                        HorizontalAlignment="Left" />

                    <!--  Select  -->
                    <Grid
                        Grid.Column="6"
                        Margin="0,1,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition Height="16" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>

                        <Label
                            x:Name="SelectLabel"
                            Grid.Row="1"
                            Grid.Column="0"
                            Grid.ColumnSpan="3"
                            Padding="0"
                            HorizontalContentAlignment="Center"
                            VerticalContentAlignment="Center"
                            Content="{DynamicResource S.Editor.Home.Select}"
                            FontSize="12"
                            Foreground="{DynamicResource Element.Foreground.Gray112}" />

                        <n:ExtendedButton
                            x:Name="SelectAllButton"
                            Grid.Row="0"
                            Grid.Column="0"
                            MinWidth="55"
                            Command="{StaticResource Command.SelectAll}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.Cursor}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Home.SelectAll}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedButton
                            x:Name="GoToButton"
                            Grid.Row="0"
                            Grid.Column="1"
                            MinWidth="55"
                            Command="{StaticResource Command.GoTo}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.Forward}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Home.GoTo}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <Grid
                            Grid.Row="0"
                            Grid.Column="2"
                            Margin="0,1,0,0">
                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition />
                            </Grid.RowDefinitions>

                            <n:ExtendedButton
                                x:Name="InverseSelectionButton"
                                Grid.Row="0"
                                MinWidth="60"
                                Padding="3"
                                Command="{StaticResource Command.InverseSelection}"
                                ContentHeight="25"
                                ContentWidth="25"
                                Icon="{StaticResource Vector.InverseSelection}"
                                Style="{StaticResource Style.Button.Horizontal}"
                                Text="{DynamicResource S.Editor.Home.Inverse}"
                                ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                                ToolTipService.HorizontalOffset="-5"
                                ToolTipService.Placement="Top" />

                            <n:ExtendedButton
                                x:Name="DeselectButton"
                                Grid.Row="1"
                                MinWidth="60"
                                Padding="3"
                                Command="{StaticResource Command.Unselect}"
                                ContentHeight="25"
                                ContentWidth="25"
                                Icon="{StaticResource Vector.Unselect}"
                                Style="{StaticResource Style.Button.Horizontal}"
                                Text="{DynamicResource S.Editor.Home.Deselect}"
                                ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                                ToolTipService.HorizontalOffset="-5"
                                ToolTipService.Placement="Bottom" />
                        </Grid>
                    </Grid>

                    <Separator
                        Grid.Row="0"
                        Grid.Column="7"
                        Width="1"
                        Height="Auto"
                        Margin="3,2"
                        HorizontalAlignment="Left" />
                </Grid>
            </n:AwareTabItem>

            <n:AwareTabItem
                Header="{DynamicResource S.Editor.Playback}"
                Icon="{StaticResource Vector.Play}">
                <Grid
                    Height="94"
                    Margin="2"
                    Background="{DynamicResource Panel.Background.Level2}"
                    Effect="{StaticResource Shadow.Invariant}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="7" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="7" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>

                    <Grid
                        Grid.Column="0"
                        Margin="0,1,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition Height="16" />
                        </Grid.RowDefinitions>

                        <Label
                            Grid.Row="1"
                            Grid.Column="0"
                            Grid.ColumnSpan="5"
                            Padding="0"
                            HorizontalContentAlignment="Center"
                            VerticalContentAlignment="Center"
                            Content="{DynamicResource S.Editor.Playback.Playback}"
                            FontSize="12"
                            Foreground="{DynamicResource Element.Foreground.Gray112}" />

                        <n:ExtendedButton
                            x:Name="FirstButton"
                            Grid.Row="0"
                            Grid.Column="0"
                            MinWidth="55"
                            Command="{StaticResource Command.FirstFrame}"
                            ContentHeight="28"
                            ContentWidth="38"
                            Icon="{StaticResource Vector.First.Green}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Playback.First}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedRepeatButton
                            x:Name="PreviousButton"
                            Grid.Row="0"
                            Grid.Column="1"
                            Command="{StaticResource Command.PreviousFrame}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.Previous.Green}"
                            Style="{StaticResource Style.RepeatButton.Vertical}"
                            Text="{DynamicResource S.Editor.Playback.Previous}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedButton
                            x:Name="PlayButton"
                            Grid.Row="0"
                            Grid.Column="2"
                            MinWidth="55"
                            Command="{StaticResource Command.Play}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.Play}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Playback.Play}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedRepeatButton
                            x:Name="NextButton"
                            Grid.Row="0"
                            Grid.Column="3"
                            Command="{StaticResource Command.NextFrame}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.Next.Green}"
                            Style="{StaticResource Style.RepeatButton.Vertical}"
                            Text="{DynamicResource S.Editor.Playback.Next}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedButton
                            x:Name="LastButton"
                            Grid.Row="0"
                            Grid.Column="4"
                            MinWidth="55"
                            Command="{StaticResource Command.LastFrame}"
                            ContentHeight="28"
                            ContentWidth="38"
                            Icon="{StaticResource Vector.Last.Green}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Playback.Last}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />
                    </Grid>

                    <Separator
                        Grid.Row="0"
                        Grid.Column="1"
                        Width="1"
                        Height="Auto"
                        Margin="3,2" />

                    <Grid
                        Grid.Column="2"
                        Margin="0,1,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition />
                            <RowDefinition Height="16" />
                        </Grid.RowDefinitions>

                        <Label
                            Grid.Row="2"
                            Grid.Column="0"
                            Padding="0"
                            HorizontalContentAlignment="Center"
                            VerticalContentAlignment="Center"
                            Content="{DynamicResource S.Editor.PlaybackOptions.Header}"
                            FontSize="12"
                            Foreground="{DynamicResource Element.Foreground.Gray112}" />

                        <n:ExtendedCheckBox
                            x:Name="LoopedPlaybackCheckBox"
                            Grid.Row="0"
                            Grid.Column="0"
                            Margin="5,3"
                            IsChecked="{Binding LoopedPlayback, Source={x:Static t:UserSettings.All}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                            Text="{DynamicResource S.Editor.PlaybackOptions.Loop}"
                            ToolTip="{DynamicResource S.Editor.PlaybackOptions.Loop.Info}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedCheckBox
                            Grid.Row="1"
                            Grid.Column="0"
                            Margin="5,3"
                            IsChecked="{Binding DropFramesDuringPreviewIfBehind, Source={x:Static t:UserSettings.All}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                            Text="{DynamicResource S.Options.Editor.General.DropFramesDuringPreviewIfBehind}"
                            ToolTip="{DynamicResource S.Options.Editor.General.DropFramesDuringPreviewIfBehind.Tooltip}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />
                    </Grid>

                    <Separator
                        Grid.Row="0"
                        Grid.Column="3"
                        Width="1"
                        Height="Auto"
                        Margin="3,2" />
                </Grid>
            </n:AwareTabItem>

            <n:AwareTabItem
                Header="{DynamicResource S.Editor.Edit}"
                Icon="{StaticResource Vector.Pen}">
                <Grid
                    Height="94"
                    Margin="2"
                    Background="{DynamicResource Panel.Background.Level2}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="7" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="7" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="7" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="7" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>

                    <Grid
                        Grid.Column="0"
                        Margin="0,1,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition Height="16" />
                        </Grid.RowDefinitions>

                        <Label
                            Grid.Row="1"
                            Grid.Column="0"
                            Grid.ColumnSpan="5"
                            Padding="0"
                            HorizontalContentAlignment="Center"
                            VerticalContentAlignment="Center"
                            Content="{DynamicResource S.Editor.Edit.Frames}"
                            FontSize="12"
                            Foreground="{DynamicResource Element.Foreground.Gray112}" />

                        <n:ExtendedButton
                            x:Name="DeleteButton"
                            Grid.Row="0"
                            Grid.Column="0"
                            MinWidth="55"
                            Command="{StaticResource Command.Delete}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.RemoveImage}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Edit.Delete}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedButton
                            x:Name="DeleteDuplicatesButton"
                            Grid.Row="0"
                            Grid.Column="1"
                            MinWidth="55"
                            Command="{StaticResource Command.RemoveDuplicates}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.RemoveImage}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Edit.Frames.Duplicates}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedButton
                            x:Name="ReduceButton"
                            Grid.Row="0"
                            Grid.Column="2"
                            MinWidth="55"
                            Command="{StaticResource Command.Reduce}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.RemoveImage}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Edit.Frames.Reduce}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedButton
                            x:Name="SmoothLoopButton"
                            Grid.Row="0"
                            Grid.Column="3"
                            MinWidth="55"
                            Command="{StaticResource Command.SmoothLoop}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.Repeat}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Edit.Frames.SmoothLoop}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <Grid
                            Grid.Row="0"
                            Grid.Column="4">
                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition />
                            </Grid.RowDefinitions>

                            <n:ExtendedButton
                                x:Name="DeleteBeforeButton"
                                Grid.Row="0"
                                MinWidth="60"
                                Padding="3"
                                Command="{StaticResource Command.DeletePrevious}"
                                ContentHeight="30"
                                ContentWidth="25"
                                Icon="{StaticResource Vector.Delete.Before}"
                                Style="{StaticResource Style.Button.Horizontal}"
                                Text="{DynamicResource S.Editor.Edit.DeletePrevious}"
                                ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                                ToolTipService.HorizontalOffset="-5"
                                ToolTipService.Placement="Top" />

                            <n:ExtendedButton
                                x:Name="DeleteAfterButton"
                                Grid.Row="1"
                                MinWidth="60"
                                Padding="3"
                                Command="{StaticResource Command.DeleteNext}"
                                ContentHeight="30"
                                ContentWidth="25"
                                Icon="{StaticResource Vector.Delete.After}"
                                Style="{StaticResource Style.Button.Horizontal}"
                                Text="{DynamicResource S.Editor.Edit.DeleteNext}"
                                ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                                ToolTipService.HorizontalOffset="-5"
                                ToolTipService.Placement="Bottom" />
                        </Grid>
                    </Grid>

                    <Separator
                        Grid.Row="0"
                        Grid.Column="1"
                        Width="1"
                        Height="Auto"
                        Margin="3,2"
                        HorizontalAlignment="Left" />

                    <Grid
                        Grid.Column="2"
                        Margin="0,1,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition Height="16" />
                        </Grid.RowDefinitions>

                        <Label
                            Grid.Row="1"
                            Grid.Column="0"
                            Grid.ColumnSpan="3"
                            Padding="0"
                            HorizontalContentAlignment="Center"
                            VerticalContentAlignment="Center"
                            Content="{DynamicResource S.Editor.Edit.Reordering}"
                            FontSize="12"
                            Foreground="{DynamicResource Element.Foreground.Gray112}" />

                        <Grid
                            Grid.Row="0"
                            Grid.Column="0">
                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition />
                            </Grid.RowDefinitions>

                            <n:ExtendedButton
                                x:Name="ReverseOrderButton"
                                Grid.Row="0"
                                Padding="3"
                                Command="{StaticResource Command.Reverse}"
                                ContentHeight="30"
                                ContentWidth="25"
                                Icon="{StaticResource Vector.Invert}"
                                Style="{StaticResource Style.Button.Horizontal}"
                                Text="{DynamicResource S.Editor.Edit.Reverse}"
                                ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                                ToolTipService.HorizontalOffset="-5"
                                ToolTipService.Placement="Top" />

                            <n:ExtendedButton
                                x:Name="YoyoOrderButton"
                                Grid.Row="1"
                                Padding="3"
                                Command="{StaticResource Command.Yoyo}"
                                ContentHeight="30"
                                ContentWidth="25"
                                Icon="{StaticResource Vector.Yoyo}"
                                Style="{StaticResource Style.Button.Horizontal}"
                                Text="{DynamicResource S.Editor.Edit.Yoyo}"
                                ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                                ToolTipService.HorizontalOffset="-5"
                                ToolTipService.Placement="Bottom" />
                        </Grid>

                        <n:ExtendedButton
                            x:Name="MoveLeftButton"
                            Grid.Row="0"
                            Grid.Column="1"
                            MinWidth="55"
                            Command="{StaticResource Command.MoveLeft}"
                            ContentHeight="28"
                            ContentWidth="32"
                            Icon="{StaticResource Vector.MoveLeft}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Edit.MoveLeft}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedButton
                            x:Name="MoveRightButton"
                            Grid.Row="0"
                            Grid.Column="2"
                            MinWidth="55"
                            Command="{StaticResource Command.MoveRight}"
                            ContentHeight="28"
                            ContentWidth="32"
                            Icon="{StaticResource Vector.MoveRight}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Edit.MoveRight}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />
                    </Grid>

                    <Separator
                        Grid.Row="0"
                        Grid.Column="3"
                        Width="1"
                        Height="Auto"
                        Margin="3,2"
                        HorizontalAlignment="Left" />

                    <Grid
                        Grid.Column="4"
                        Margin="0,1,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition Height="16" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <Label
                            Grid.Row="1"
                            Grid.Column="0"
                            Grid.ColumnSpan="3"
                            Padding="0"
                            HorizontalContentAlignment="Center"
                            VerticalContentAlignment="Center"
                            Content="{DynamicResource S.Editor.Edit.Delay}"
                            FontSize="12"
                            Foreground="{DynamicResource Element.Foreground.Gray112}" />

                        <n:ExtendedButton
                            x:Name="OverrideDelayButton"
                            Grid.Row="0"
                            Grid.Column="0"
                            MinWidth="55"
                            Command="{StaticResource Command.OverrideDelay}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.OverrideDelay}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Edit.Delay.Override}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedButton
                            x:Name="ChangeDelayButton"
                            Grid.Row="0"
                            Grid.Column="1"
                            MinWidth="55"
                            Command="{StaticResource Command.IncreaseDecreaseDelay}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.IncreaseDecreaseDelay}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Edit.Delay.IncreaseDecrease}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedButton
                            x:Name="ScaleDelayButton"
                            Grid.Row="0"
                            Grid.Column="2"
                            MinWidth="55"
                            Command="{StaticResource Command.ScaleDelay}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.ScaleDelay}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Edit.Delay.Scale}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />
                    </Grid>

                    <Separator
                        Grid.Row="0"
                        Grid.Column="5"
                        Width="1"
                        Height="Auto"
                        Margin="3,2"
                        HorizontalAlignment="Left" />
                </Grid>
            </n:AwareTabItem>

            <n:AwareTabItem
                Header="{DynamicResource S.Editor.Image}"
                Icon="{StaticResource Vector.Image}">
                <Grid
                    Height="94"
                    Margin="2"
                    Background="{DynamicResource Panel.Background.Level2}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="7" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="7" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="7" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>

                    <Grid
                        Grid.Column="0"
                        Margin="0,1,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition Height="16" />
                        </Grid.RowDefinitions>

                        <Label
                            Grid.Row="1"
                            Grid.Column="0"
                            Grid.ColumnSpan="2"
                            Padding="0"
                            HorizontalContentAlignment="Center"
                            VerticalContentAlignment="Center"
                            Content="{DynamicResource S.Editor.Image.SizePosition}"
                            FontSize="12"
                            Foreground="{DynamicResource Element.Foreground.Gray112}" />

                        <n:ExtendedButton
                            x:Name="ResizeButton"
                            Grid.Row="0"
                            Grid.Column="0"
                            MinWidth="55"
                            Command="{StaticResource Command.Resize}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.Resize}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Image.Resize}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <Grid
                            Grid.Row="0"
                            Grid.Column="1">
                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition />
                            </Grid.RowDefinitions>

                            <n:ExtendedButton
                                x:Name="CropButton"
                                Grid.Row="0"
                                MinWidth="60"
                                Padding="3"
                                Command="{StaticResource Command.Crop}"
                                ContentHeight="25"
                                ContentWidth="25"
                                Icon="{StaticResource Vector.Crop}"
                                Style="{StaticResource Style.Button.Horizontal}"
                                Text="{DynamicResource S.Editor.Image.Crop}"
                                ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                                ToolTipService.HorizontalOffset="-5"
                                ToolTipService.Placement="Top" />

                            <n:ExtendedButton
                                x:Name="FlipRotateButton"
                                Grid.Row="1"
                                MinWidth="60"
                                Padding="3"
                                Command="{StaticResource Command.FlipRotate}"
                                ContentHeight="25"
                                ContentWidth="25"
                                Icon="{StaticResource Vector.FlipHorizontal}"
                                Style="{StaticResource Style.Button.Horizontal}"
                                Text="{DynamicResource S.Editor.Image.FlipRotate}"
                                ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                                ToolTipService.HorizontalOffset="-5"
                                ToolTipService.Placement="Bottom" />
                        </Grid>
                    </Grid>

                    <Separator
                        Grid.Row="0"
                        Grid.Column="1"
                        Width="1"
                        Height="Auto"
                        Margin="3,2" />

                    <Grid
                        Grid.Column="2"
                        Margin="0,1,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition Height="16" />
                        </Grid.RowDefinitions>

                        <Label
                            Grid.Row="1"
                            Grid.Column="0"
                            Grid.ColumnSpan="3"
                            Padding="0"
                            HorizontalContentAlignment="Center"
                            VerticalContentAlignment="Center"
                            Content="{DynamicResource S.Editor.Image.Text}"
                            FontSize="12"
                            Foreground="{DynamicResource Element.Foreground.Gray112}" />

                        <n:ExtendedButton
                            x:Name="CaptionButton"
                            Grid.Row="0"
                            Grid.Column="0"
                            MinWidth="55"
                            Command="{StaticResource Command.Caption}"
                            ContentHeight="28"
                            ContentWidth="28"
                            Icon="{StaticResource Vector.Caption}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Image.Caption}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedButton
                            x:Name="KeypressButton"
                            Grid.Row="0"
                            Grid.Column="1"
                            MinWidth="55"
                            Command="{StaticResource Command.KeyStrokes}"
                            ContentHeight="28"
                            ContentWidth="32"
                            Icon="{StaticResource Vector.Keyboard}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Image.KeyStrokes}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <Grid
                            Grid.Row="0"
                            Grid.Column="2">
                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition />
                            </Grid.RowDefinitions>

                            <n:ExtendedButton
                                x:Name="FreeTextButton"
                                Grid.Row="0"
                                MinWidth="60"
                                Padding="3"
                                Command="{StaticResource Command.FreeText}"
                                ContentHeight="25"
                                ContentWidth="25"
                                Icon="{StaticResource Vector.FreeText}"
                                Style="{StaticResource Style.Button.Horizontal}"
                                Text="{DynamicResource S.Editor.Image.FreeText}"
                                ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                                ToolTipService.HorizontalOffset="-5"
                                ToolTipService.Placement="Top" />

                            <n:ExtendedButton
                                x:Name="TitleFrameButton"
                                Grid.Row="1"
                                MinWidth="60"
                                Padding="3"
                                Command="{StaticResource Command.TitleFrame}"
                                ContentHeight="25"
                                ContentWidth="25"
                                Icon="{StaticResource Vector.TitleFrame}"
                                Style="{StaticResource Style.Button.Horizontal}"
                                Text="{DynamicResource S.Editor.Image.TitleFrame}"
                                ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                                ToolTipService.HorizontalOffset="-5"
                                ToolTipService.Placement="Bottom" />
                        </Grid>
                    </Grid>

                    <Separator
                        Grid.Row="0"
                        Grid.Column="3"
                        Width="1"
                        Height="Auto"
                        Margin="3,2" />

                    <Grid
                        Grid.Column="4"
                        Margin="0,1,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition Height="16" />
                        </Grid.RowDefinitions>

                        <Label
                            Grid.Row="1"
                            Grid.Column="0"
                            Grid.ColumnSpan="8"
                            Padding="0"
                            HorizontalContentAlignment="Center"
                            VerticalContentAlignment="Center"
                            Content="{DynamicResource S.Editor.Image.Overlay}"
                            FontSize="12"
                            Foreground="{DynamicResource Element.Foreground.Gray112}" />

                        <n:ExtendedButton
                            x:Name="FreeDrawButton"
                            Grid.Row="0"
                            Grid.Column="0"
                            MinWidth="55"
                            Command="{StaticResource Command.FreeDrawing}"
                            ContentHeight="28"
                            ContentWidth="32"
                            Icon="{StaticResource Vector.FreeDrawing}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Image.FreeDrawing}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedButton
                            x:Name="ShapesButton"
                            Grid.Row="0"
                            Grid.Column="1"
                            MinWidth="55"
                            Command="{StaticResource Command.Shapes}"
                            ContentHeight="28"
                            ContentWidth="32"
                            Icon="{StaticResource Vector.Ellipse}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Image.Shape}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedButton
                            x:Name="ProgressButton"
                            Grid.Row="0"
                            Grid.Column="2"
                            MinWidth="55"
                            Command="{StaticResource Command.Progress}"
                            ContentHeight="28"
                            ContentWidth="32"
                            Icon="{StaticResource Vector.Progress}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Image.Progress}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedButton
                            Grid.Row="0"
                            Grid.Column="3"
                            MinWidth="55"
                            Command="{StaticResource Command.MouseEvents}"
                            ContentHeight="28"
                            ContentWidth="32"
                            Icon="{StaticResource Vector.Cursor}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Image.MouseEvents}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedButton
                            x:Name="BorderButton"
                            Grid.Row="0"
                            Grid.Column="4"
                            MinWidth="55"
                            Command="{StaticResource Command.Border}"
                            ContentHeight="28"
                            ContentWidth="32"
                            Icon="{StaticResource Vector.Border}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Image.Border}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedButton
                            x:Name="ShadowButton"
                            Grid.Row="0"
                            Grid.Column="5"
                            MinWidth="55"
                            Command="{StaticResource Command.Shadow}"
                            ContentHeight="28"
                            ContentWidth="32"
                            Icon="{StaticResource Vector.Shadow}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Image.Shadow}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedButton
                            x:Name="ObfuscateButton"
                            Grid.Row="0"
                            Grid.Column="6"
                            MinWidth="55"
                            Command="{StaticResource Command.Obfuscate}"
                            ContentHeight="28"
                            ContentWidth="32"
                            Icon="{StaticResource Vector.Obfuscate}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Image.Obfuscate}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <Grid
                            Grid.Row="0"
                            Grid.Column="7">
                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition />
                            </Grid.RowDefinitions>

                            <n:ExtendedButton
                                x:Name="WatermarkButton"
                                Grid.Row="0"
                                MinWidth="60"
                                Padding="3"
                                Command="{StaticResource Command.Watermark}"
                                ContentHeight="25"
                                ContentWidth="25"
                                Icon="{StaticResource Vector.Watermark}"
                                Style="{StaticResource Style.Button.Horizontal}"
                                Text="{DynamicResource S.Editor.Image.Watermark}"
                                ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                                ToolTipService.HorizontalOffset="-5"
                                ToolTipService.Placement="Top" />

                            <n:ExtendedButton
                                x:Name="CinemagraphButton"
                                Grid.Row="1"
                                MinWidth="60"
                                Padding="3"
                                Command="{StaticResource Command.Cinemagraph}"
                                ContentHeight="25"
                                ContentWidth="25"
                                Icon="{StaticResource Vector.Cinemagraph}"
                                Style="{StaticResource Style.Button.Horizontal}"
                                Text="{DynamicResource S.Editor.Image.Cinemagraph}"
                                ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                                ToolTipService.HorizontalOffset="-5"
                                ToolTipService.Placement="Bottom" />
                        </Grid>
                    </Grid>

                    <Separator
                        Grid.Row="0"
                        Grid.Column="5"
                        Width="1"
                        Height="Auto"
                        Margin="3,2" />
                </Grid>
            </n:AwareTabItem>

            <n:AwareTabItem
                Header="{DynamicResource S.Editor.Transitions}"
                Icon="{StaticResource Vector.Fade}">
                <Grid
                    Height="94"
                    Margin="2"
                    Background="{DynamicResource Panel.Background.Level2}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="7" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>

                    <Grid
                        Grid.Column="0"
                        Margin="0,1,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition Height="16" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>

                        <Label
                            x:Name="StylesLabel"
                            Grid.Row="1"
                            Grid.ColumnSpan="2"
                            Padding="0"
                            HorizontalContentAlignment="Center"
                            VerticalContentAlignment="Center"
                            Content="{DynamicResource S.Editor.Transitions.Styles}"
                            FontSize="12"
                            Foreground="{DynamicResource Element.Foreground.Gray112}" />

                        <n:ExtendedButton
                            x:Name="FadeTransitionButton"
                            Grid.Row="0"
                            Grid.Column="0"
                            MinWidth="55"
                            Command="{StaticResource Command.Fade}"
                            ContentHeight="28"
                            ContentWidth="32"
                            Icon="{StaticResource Vector.Fade}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Transitions.Fade}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />

                        <n:ExtendedButton
                            x:Name="SlideTransitionButton"
                            Grid.Row="0"
                            Grid.Column="1"
                            MinWidth="55"
                            Command="{StaticResource Command.Slide}"
                            ContentHeight="28"
                            ContentWidth="32"
                            Icon="{StaticResource Vector.Slide}"
                            Style="{StaticResource Style.Button.Vertical}"
                            Text="{DynamicResource S.Editor.Transitions.Slide}"
                            ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                            ToolTipService.HorizontalOffset="-5"
                            ToolTipService.Placement="Bottom" />
                    </Grid>

                    <Separator
                        Grid.Row="0"
                        Grid.Column="1"
                        Width="1"
                        Height="Auto"
                        Margin="3,2"
                        HorizontalAlignment="Left" />
                </Grid>
            </n:AwareTabItem>

            <n:AwareTabItem
                Header="{DynamicResource S.Editor.Statistics}"
                Icon="{StaticResource Vector.Info}">
                <Grid
                    Height="94"
                    Margin="2"
                    Background="{DynamicResource Panel.Background.Level2}"
                    Effect="{StaticResource Shadow.Invariant}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="7" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="7" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="7" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <Grid
                        Grid.Column="0"
                        Margin="0,1,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition />
                            <RowDefinition />
                            <RowDefinition />
                            <RowDefinition Height="16" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="18" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="20" />
                            <ColumnDefinition Width="18" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="20" />
                            <ColumnDefinition Width="18" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <Label
                            Grid.Row="4"
                            Grid.Column="0"
                            Grid.ColumnSpan="8"
                            Padding="0"
                            HorizontalContentAlignment="Center"
                            VerticalContentAlignment="Center"
                            Content="{DynamicResource S.Editor.Statistics.General}"
                            FontSize="12"
                            Foreground="{DynamicResource Element.Foreground.Gray112}" />

                        <Border
                            Grid.Row="0"
                            Grid.Column="0"
                            Width="18"
                            Height="18"
                            VerticalAlignment="Center"
                            Background="{StaticResource Vector.Number}"
                            Opacity="{DynamicResource Element.Opacity}" />
                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="1"
                            Margin="5,0"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground}"
                            Text="{DynamicResource S.Editor.Statistics.FrameCount}" />
                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="1"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Header}"
                            Text="{Binding ElementName=FrameListView, Path=Items.Count}" />

                        <Border
                            Grid.Row="2"
                            Grid.Column="0"
                            Width="18"
                            Height="18"
                            VerticalAlignment="Center"
                            Background="{StaticResource Vector.Clock}"
                            Opacity="{DynamicResource Element.Opacity}" />
                        <TextBlock
                            Grid.Row="2"
                            Grid.Column="1"
                            Margin="5,0"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground}"
                            Text="{DynamicResource S.Editor.Statistics.TotalDuration}" />
                        <TextBlock
                            Grid.Row="3"
                            Grid.Column="1"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Header}"
                            Text="{Binding ElementName=EditorWindow, Path=TotalDuration, StringFormat='{}{0:mm\\:ss\\.fff} m'}" />

                        <Border
                            Grid.Row="0"
                            Grid.Column="3"
                            Width="18"
                            Height="18"
                            VerticalAlignment="Center"
                            Background="{StaticResource Vector.WidthHeight}"
                            Opacity="{DynamicResource Element.Opacity}" />
                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="4"
                            Margin="5,0"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground}"
                            Text="{DynamicResource S.Editor.Statistics.FrameSize}" />
                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="4"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Header}">
                            <TextBlock.Text>
                                <MultiBinding StringFormat="{}{0:0.#} × {1:0.#}">
                                    <Binding
                                        ElementName="EditorWindow"
                                        Mode="OneWay"
                                        Path="FrameSize.Width" />
                                    <Binding
                                        ElementName="EditorWindow"
                                        Mode="OneWay"
                                        Path="FrameSize.Height" />
                                </MultiBinding>
                            </TextBlock.Text>
                        </TextBlock>

                        <Border
                            Grid.Row="2"
                            Grid.Column="3"
                            Width="18"
                            Height="18"
                            VerticalAlignment="Center"
                            Background="{StaticResource Vector.Clock}"
                            Opacity="{DynamicResource Element.Opacity}" />
                        <TextBlock
                            Grid.Row="2"
                            Grid.Column="4"
                            Margin="5,0"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground}"
                            Text="{DynamicResource S.Editor.Statistics.CurrentTime}"
                            ToolTip="{DynamicResource S.Editor.Statistics.CurrentTime.Info}" />
                        <TextBlock
                            Grid.Row="3"
                            Grid.Column="4"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Header}"
                            Text="{Binding ElementName=EditorWindow, Path=CurrentTime, StringFormat='{}{0:mm\\:ss\\.fff} m'}"
                            ToolTip="{DynamicResource S.Editor.Statistics.CurrentTime.Info}" />

                        <Border
                            Grid.Row="0"
                            Grid.Column="6"
                            Width="18"
                            Height="18"
                            VerticalAlignment="Center"
                            Background="{StaticResource Vector.Fit}"
                            Opacity="{DynamicResource Element.Opacity}" />
                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="7"
                            Margin="5,0"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground}"
                            Text="{DynamicResource S.Editor.Statistics.FrameDpi}" />
                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="7"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Header}">
                            <TextBlock.Text>
                                <MultiBinding StringFormat="{}{0} DPI / {1} %">
                                    <Binding
                                        ElementName="EditorWindow"
                                        Mode="OneWay"
                                        Path="FrameDpi" />
                                    <Binding
                                        ElementName="EditorWindow"
                                        Mode="OneWay"
                                        Path="FrameScale" />
                                </MultiBinding>
                            </TextBlock.Text>
                        </TextBlock>

                        <Border
                            Grid.Row="2"
                            Grid.Column="6"
                            Width="18"
                            Height="18"
                            VerticalAlignment="Center"
                            Background="{StaticResource Vector.Delay}"
                            Opacity="{DynamicResource Element.Opacity}" />
                        <TextBlock
                            Grid.Row="2"
                            Grid.Column="7"
                            Margin="5,0"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground}"
                            Text="{DynamicResource S.Editor.Statistics.AverageDuration}" />
                        <TextBlock
                            Grid.Row="3"
                            Grid.Column="7"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Header}"
                            Text="{Binding ElementName=EditorWindow, Path=AverageDelay, StringFormat=0.# ms}" />
                    </Grid>

                    <Separator
                        Grid.Row="0"
                        Grid.Column="1"
                        Width="1"
                        Height="Auto"
                        Margin="3,2"
                        HorizontalAlignment="Left" />

                    <Grid
                        Grid.Column="2"
                        MinWidth="150"
                        Margin="0,1,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition Height="16" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <Label
                            Grid.Row="1"
                            Grid.Column="0"
                            Grid.ColumnSpan="2"
                            Padding="0"
                            HorizontalContentAlignment="Center"
                            VerticalContentAlignment="Center"
                            Content="{DynamicResource S.Editor.Statistics.SelectedFrame}"
                            FontSize="12"
                            Foreground="{DynamicResource Element.Foreground.Gray112}" />

                        <Viewbox
                            Grid.Row="0"
                            Grid.Column="0">
                            <Grid
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Opacity="{DynamicResource Element.Opacity}">
                                <n:CircularProgressBar
                                    Percentage="100"
                                    Radius="24"
                                    SegmentColor="Gray"
                                    StrokeThickness="2" />
                                <n:CircularProgressBar
                                    Maximum="10010"
                                    Minimum="10"
                                    Radius="24"
                                    SegmentColor="#FFE28A73"
                                    StrokeThickness="2"
                                    Value="{Binding Delay, UpdateSourceTrigger=PropertyChanged}" />
                                <n:CircularProgressBar
                                    Percentage="100"
                                    Radius="10"
                                    SegmentColor="#FFF0F1F1"
                                    StrokeThickness="22" />
                                <n:CircularProgressBar
                                    Maximum="10010"
                                    Minimum="10"
                                    Radius="10"
                                    SegmentColor="#FFE28A73"
                                    StrokeThickness="22"
                                    Value="{Binding Delay, UpdateSourceTrigger=PropertyChanged}" />
                            </Grid>
                        </Viewbox>

                        <TextBlock
                            Grid.Row="0"
                            Grid.Column="1"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource Element.Foreground.Header}">
                            <TextBlock.Text>
                                <MultiBinding StringFormat="{}{0} ms">
                                    <Binding
                                        FallbackValue="0"
                                        Mode="OneWay"
                                        Path="Delay"
                                        UpdateSourceTrigger="PropertyChanged" />
                                </MultiBinding>
                            </TextBlock.Text>
                        </TextBlock>
                    </Grid>
                </Grid>
            </n:AwareTabItem>
        </n:HideableTabControl>

        <!--  Hack for the extended title bar  -->
        <Grid
            Grid.Row="1"
            Grid.RowSpan="3"
            Background="{DynamicResource Panel.Background.Level3}" />

        <!--  Middle of the Window  -->
        <Grid
            x:Name="MiddleGrid"
            Grid.Row="1"
            Background="{StaticResource Checker.DrawingBrush}"
            IsEnabled="{Binding Path=IsLoading, ElementName=EditorWindow, Converter={StaticResource InvertedBoolConverter}}">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <n:StatusList
                x:Name="StatusList"
                Grid.Row="0" />

            <!--  Overlay behind the image  -->
            <ScrollViewer
                x:Name="BehindScrollViewer"
                Grid.Row="1"
                Grid.Column="0"
                HorizontalScrollBarVisibility="Hidden"
                VerticalScrollBarVisibility="Hidden"
                Visibility="{Binding Path=Visibility, ElementName=OverlayGrid}">
                <Grid
                    x:Name="BehindGrid"
                    Opacity="{Binding ElementName=OverlayGrid, Path=Opacity, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}">
                    <!--  Border  -->
                    <Grid
                        x:Name="BorderPreviewGrid"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Background="White"
                        Visibility="{Binding ElementName=BorderGrid, Path=Visibility}">
                        <Border
                            x:Name="BorderBehindOverlayBorder"
                            MinWidth="{Binding ElementName=CaptionOverlayGrid, Path=Width, FallbackValue=0}"
                            MinHeight="{Binding ElementName=CaptionOverlayGrid, Path=Height, FallbackValue=0}"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            BorderBrush="{Binding ElementName=BorderColorBox, Path=SelectedBrush}">
                            <Border.BorderThickness>
                                <MultiBinding
                                    Converter="{StaticResource DoubleToThicknessConverter}"
                                    ConverterParameter="-">
                                    <Binding
                                        ElementName="BorderLeftThicknessNumericUpDown"
                                        Path="Value" />
                                    <Binding
                                        ElementName="BorderTopThicknessNumericUpDown"
                                        Path="Value" />
                                    <Binding
                                        ElementName="BorderRightThicknessNumericUpDown"
                                        Path="Value" />
                                    <Binding
                                        ElementName="BorderBottomThicknessNumericUpDown"
                                        Path="Value" />
                                </MultiBinding>
                            </Border.BorderThickness>
                        </Border>
                    </Grid>

                    <!--  Shadow Previewer  -->
                    <Grid
                        x:Name="ShadowPreviewGrid"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Background="{Binding ElementName=ShadowBackgroundColorBox, Path=SelectedBrush, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                        Visibility="{Binding ElementName=ShadowGrid, Path=Visibility}">
                        <Grid
                            x:Name="ShadowInternalGrid"
                            Width="{Binding ElementName=CaptionOverlayGrid, Path=Width, FallbackValue=0}"
                            Height="{Binding ElementName=CaptionOverlayGrid, Path=Height, FallbackValue=0}"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            Background="White">
                            <Grid.Effect>
                                <DropShadowEffect
                                    BlurRadius="{Binding Source={x:Static t:UserSettings.All}, Path=ShadowBlurRadius, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                                    Direction="{Binding Source={x:Static t:UserSettings.All}, Path=ShadowDirection, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                                    Opacity="{Binding Source={x:Static t:UserSettings.All}, Path=ShadowOpacity, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                                    ShadowDepth="{Binding Source={x:Static t:UserSettings.All}, Path=ShadowDepth, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                                    Color="{Binding Source={x:Static t:UserSettings.All}, Path=ShadowColor, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" />
                            </Grid.Effect>
                        </Grid>
                    </Grid>
                </Grid>
            </ScrollViewer>

            <n:ZoomBox
                x:Name="ZoomBoxControl"
                Grid.Row="1"
                Grid.Column="0"
                AllowDrop="True"
                Background="Transparent"
                ClipToBounds="True"
                DragEnter="Control_DragEnter"
                Drop="Control_Drop"
                Focusable="False"
                IsTabStop="False"
                MouseLeftButtonUp="ZoomBoxControl_MouseLeftButtonUp"
                PreviewMouseWheel="ZoomBox_MouseWheel">
                <n:ZoomBox.ContextMenu>
                    <ContextMenu>
                        <n:ExtendedMenuItem
                            x:Name="PlayMenuItem"
                            Command="{StaticResource Command.Play}"
                            ContentHeight="16"
                            ContentWidth="16"
                            Header="{DynamicResource S.Editor.Playback.Play}"
                            Icon="{StaticResource Vector.Play}"
                            InputGestureText="{DynamicResource S.Keys.Space}" />
                        <Separator />
                        <n:ExtendedMenuItem
                            Command="{StaticResource Command.Undo}"
                            ContentHeight="16"
                            ContentWidth="16"
                            Header="{DynamicResource S.Editor.Home.Undo}"
                            Icon="{StaticResource Vector.Undo}" />
                        <n:ExtendedMenuItem
                            Command="{StaticResource Command.Redo}"
                            ContentHeight="16"
                            ContentWidth="16"
                            Header="{DynamicResource S.Editor.Home.Redo}"
                            Icon="{StaticResource Vector.Redo}" />
                        <Separator />
                        <n:ExtendedMenuItem
                            Command="{StaticResource Command.SaveAs}"
                            ContentHeight="16"
                            ContentWidth="16"
                            Header="{DynamicResource S.Context.SaveAs}"
                            Icon="{StaticResource Vector.Gif}" />
                        <n:ExtendedMenuItem
                            Command="{StaticResource Command.DiscardProject}"
                            ContentHeight="16"
                            ContentWidth="16"
                            Header="{DynamicResource S.Recorder.Discard}"
                            Icon="{StaticResource Vector.Remove}" />
                        <Separator />
                        <n:ExtendedMenuItem
                            Command="{StaticResource Command.Delete}"
                            ContentHeight="16"
                            ContentWidth="16"
                            Header="{DynamicResource S.Context.RemoveFrames}"
                            Icon="{StaticResource Vector.RemoveImage}" />
                    </ContextMenu>
                </n:ZoomBox.ContextMenu>
            </n:ZoomBox>

            <!--  Overlay on top of the image  -->
            <ScrollViewer
                x:Name="MainScrollViewer"
                Grid.Row="1"
                Grid.Column="0"
                HorizontalScrollBarVisibility="Auto"
                PreviewMouseWheel="ZoomBox_MouseWheel"
                VerticalScrollBarVisibility="Auto"
                Visibility="{Binding Path=Visibility, ElementName=OverlayGrid}">
                <Grid
                    x:Name="OverlayGrid"
                    Opacity="0"
                    Visibility="Collapsed">

                    <Label
                        x:Name="OverlayLabel"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Top"
                        Content="{DynamicResource S.Preview}"
                        Effect="{StaticResource Shadow.Border.Small}"
                        FontSize="16"
                        FontWeight="Light"
                        Foreground="#FF347E4B" />

                    <AdornerDecorator Visibility="{Binding ElementName=CropGrid, Path=Visibility}">
                        <Grid
                            x:Name="CropAreaGrid"
                            Width="{Binding ElementName=CaptionOverlayGrid, Path=Width, FallbackValue=0}"
                            Height="{Binding ElementName=CaptionOverlayGrid, Path=Height, FallbackValue=0}"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Visibility="{Binding ElementName=CropGrid, Path=Visibility}" />
                    </AdornerDecorator>

                    <Grid
                        x:Name="CaptionOverlayGrid"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        ClipToBounds="True"
                        Visibility="{Binding ElementName=CaptionGrid, Path=Visibility}">
                        <n:TextPath
                            x:Name="CaptionOverlayLabel"
                            Margin="{Binding ElementName=CaptionMarginNumericUpDown, Path=Value}"
                            HorizontalAlignment="{Binding ElementName=CaptionHorizontalAligmentComboBox, Path=SelectedValue}"
                            VerticalAlignment="{Binding ElementName=CaptionVerticalAligmentComboBox, Path=SelectedValue}"
                            Fill="{Binding ElementName=CaptionFontColorBox, Path=SelectedBrush}"
                            FontFamily="{Binding ElementName=CaptionFontComboBox, Path=SelectedItem}"
                            FontSize="{Binding ElementName=CaptionFontSizeNumericUpDown, Path=Value}"
                            FontStyle="{Binding ElementName=CaptionFontStyleComboBox, Path=SelectedValue}"
                            FontWeight="{Binding ElementName=CaptionFontWeightComboBox, Path=SelectedValue}"
                            Stroke="{Binding ElementName=CaptionOutlineColorBox, Path=SelectedBrush}"
                            StrokeThickness="{Binding ElementName=CaptionOutlineThicknessNumericUpDown, Path=Value}"
                            Text="{Binding ElementName=CaptionTextBox, Path=Text}" />
                    </Grid>

                    <n:MoveResizeControl
                        x:Name="FreeTextOverlayControl"
                        Width="{Binding ElementName=CaptionOverlayGrid, Path=Width, FallbackValue=0}"
                        Height="{Binding ElementName=CaptionOverlayGrid, Path=Height, FallbackValue=0}"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        ClipToBounds="True"
                        Visibility="{Binding ElementName=FreeTextGrid, Path=Visibility}">
                        <TextBlock
                            x:Name="FreeTextTextBlock"
                            Padding="0"
                            Background="{Binding ElementName=FreeTextBackgroundColorBox, Path=SelectedBrush}"
                            FontFamily="{Binding ElementName=FreeTextFontComboBox, Path=SelectedItem}"
                            FontSize="{Binding ElementName=FreeTextFontSizeNumericUpDown, Path=Value}"
                            FontStyle="{Binding ElementName=FreeTextFontStyleComboBox, Path=SelectedValue}"
                            FontWeight="{Binding ElementName=FreeTextFontWeightComboBox, Path=SelectedValue}"
                            Foreground="{Binding ElementName=FreeTextFontColorBox, Path=SelectedBrush}"
                            Text="{Binding ElementName=FreeTextTextBox, Path=Text}"
                            TextAlignment="{Binding ElementName=FreeTextTextAlignmentComboBox, Path=SelectedValue}"
                            TextDecorations="{Binding ElementName=FreeTextTextDecorationComboBox, Path=SelectedValue}">
                            <TextBlock.Resources>
                                <c:DoubleToBool x:Key="DoubleToBool" />
                                <DropShadowEffect
                                    x:Key="DropShadowEffect"
                                    BlurRadius="{Binding Source={x:Static t:UserSettings.All}, Path=FreeTextShadowBlurRadius, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                                    Direction="{Binding Source={x:Static t:UserSettings.All}, Path=FreeTextShadowDirection, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                                    Opacity="{Binding Source={x:Static t:UserSettings.All}, Path=FreeTextShadowOpacity, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                                    ShadowDepth="{Binding Source={x:Static t:UserSettings.All}, Path=FreeTextShadowDepth, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                                    Color="{Binding Source={x:Static t:UserSettings.All}, Path=FreeTextShadowColor, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" />
                            </TextBlock.Resources>
                            <TextBlock.Style>
                                <Style>
                                    <Style.Triggers>
                                        <DataTrigger
                                            Binding="{Binding ElementName=FreeTextTextAlignmentComboBox, Path=SelectedValue}"
                                            Value="Justify">
                                            <Setter Property="TextBlock.TextWrapping" Value="Wrap" />
                                            <Setter Property="TextBlock.Width" Value="{Binding ElementName=FreeTextWidthNumericUpDown, Path=Value}" />
                                        </DataTrigger>
                                        <DataTrigger
                                            Binding="{Binding Source={x:Static t:UserSettings.All}, Path=FreeTextShadowOpacity, Converter={StaticResource DoubleToBool}, ConverterParameter=0, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                                            Value="False">
                                            <Setter Property="TextBlock.Effect" Value="{StaticResource DropShadowEffect}" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                    <Style.Setters>
                                        <Setter Property="TextBlock.TextWrapping" Value="NoWrap" />
                                        <Setter Property="TextBlock.Width" Value="Auto" />
                                        <Setter Property="TextBlock.Effect" Value="{x:Null}" />
                                    </Style.Setters>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>
                    </n:MoveResizeControl>

                    <Grid
                        x:Name="TitleFrameOverlayGrid"
                        Width="{Binding ElementName=CaptionOverlayGrid, Path=Width, FallbackValue=0}"
                        Height="{Binding ElementName=CaptionOverlayGrid, Path=Height, FallbackValue=0}"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Background="{Binding ElementName=TitleFrameBackgroundColorBox, Path=SelectedBrush}"
                        ClipToBounds="True"
                        Visibility="{Binding ElementName=TitleFrameGrid, Path=Visibility}">
                        <TextBlock
                            x:Name="TitleFrameTextBlock"
                            Margin="{Binding ElementName=TitleFrameMarginNumericUpDown, Path=Value}"
                            Padding="0"
                            HorizontalAlignment="{Binding ElementName=TitleFrameHorizontalAligmentComboBox, Path=SelectedValue}"
                            VerticalAlignment="{Binding ElementName=TitleFrameVerticalAligmentComboBox, Path=SelectedValue}"
                            FontFamily="{Binding ElementName=TitleFrameFontComboBox, Path=SelectedItem}"
                            FontSize="{Binding ElementName=TitleFrameFontSizeNumericUpDown, Path=Value}"
                            FontStyle="{Binding ElementName=TitleFrameFontStyleComboBox, Path=SelectedValue}"
                            FontWeight="{Binding ElementName=TitleFrameFontWeightComboBox, Path=SelectedValue}"
                            Foreground="{Binding ElementName=TitleFrameFontColorBox, Path=SelectedBrush}"
                            Text="{Binding ElementName=TitleFrameTextBox, Path=Text}" />
                    </Grid>

                    <Grid
                        x:Name="KeyStrokesOverlayGrid"
                        Width="{Binding ElementName=CaptionOverlayGrid, Path=Width, FallbackValue=0}"
                        Height="{Binding ElementName=CaptionOverlayGrid, Path=Height, FallbackValue=0}"
                        ClipToBounds="True"
                        Visibility="{Binding ElementName=KeyStrokesGrid, Path=Visibility}">
                        <Grid
                            x:Name="KeyStrokesInternalGrid"
                            MinHeight="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesMinHeight}"
                            Margin="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesMargin}"
                            HorizontalAlignment="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesHorizontalAligment}"
                            VerticalAlignment="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesVerticalAligment}"
                            Background="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesBackgroundColor, Converter={StaticResource ColorToBrush}}">
                            <n:TextPath
                                x:Name="KeyStrokesLabel"
                                Margin="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesPadding}"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Fill="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesFontColor, Converter={StaticResource ColorToBrush}}"
                                FontFamily="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesFontFamily}"
                                FontSize="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesFontSize}"
                                FontStyle="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesFontStyle}"
                                FontWeight="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesFontWeight}"
                                Stroke="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesOutlineColor, Converter={StaticResource ColorToBrush}}"
                                StrokeThickness="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesOutlineThickness}"
                                Text="Control + C" />
                        </Grid>
                    </Grid>

                    <n:InkCanvasExtended
                        x:Name="FreeDrawingInkCanvas"
                        Width="{Binding ElementName=CaptionOverlayGrid, Path=Width, FallbackValue=0}"
                        Height="{Binding ElementName=CaptionOverlayGrid, Path=Height, FallbackValue=0}"
                        MinWidth="10"
                        MinHeight="10"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Background="Transparent"
                        ClipToBounds="True"
                        PreviewKeyDown="InkCanvas_PreviewKeyDown"
                        Visibility="{Binding ElementName=FreeDrawingGrid, Path=Visibility}">

                        <n:InkCanvasExtended.EditingMode>
                            <MultiBinding Converter="{StaticResource SelectionToEditingModeConverter}">
                                <Binding
                                    ElementName="PenModeRadioButton"
                                    Path="IsChecked" />
                                <Binding
                                    ElementName="EraserModeRadioButton"
                                    Path="IsChecked" />
                                <Binding
                                    ElementName="SelectorModeRadioButton"
                                    Path="IsChecked" />
                            </MultiBinding>
                        </n:InkCanvasExtended.EditingMode>

                        <n:InkCanvasExtended.DefaultDrawingAttributes>
                            <MultiBinding Converter="{StaticResource SelectionToDrawingAttributesConverter}">
                                <Binding
                                    ElementName="FreeDrawingHeightNumericUpDown"
                                    Path="Value" />
                                <Binding
                                    ElementName="FreeDrawingWidthNumericUpDown"
                                    Path="Value" />
                                <Binding
                                    ElementName="FreeDrawingColorBox"
                                    Path="SelectedColor" />
                                <Binding
                                    ElementName="FitToCurveCheckBox"
                                    Path="IsChecked" />
                                <Binding
                                    ElementName="IsHighLighterCheckBox"
                                    Path="IsChecked" />
                                <Binding
                                    ElementName="RectangleRadioButton"
                                    Path="IsChecked" />
                            </MultiBinding>
                        </n:InkCanvasExtended.DefaultDrawingAttributes>

                        <n:InkCanvasExtended.EraserShape>
                            <MultiBinding Converter="{StaticResource SelectionToStylusShapeConverter}">
                                <Binding
                                    ElementName="FreeDrawingEraserWidthNumericUpDown"
                                    Path="Value" />
                                <Binding
                                    ElementName="FreeDrawingEraserHeightNumericUpDown"
                                    Path="Value" />
                                <Binding
                                    ElementName="RectangleEraserRadioButton"
                                    Path="IsChecked" />
                            </MultiBinding>
                        </n:InkCanvasExtended.EraserShape>
                    </n:InkCanvasExtended>

                    <n:DrawingCanvas
                        x:Name="ShapeDrawingCanvas"
                        Width="{Binding ElementName=CaptionOverlayGrid, Path=Width, FallbackValue=0}"
                        Height="{Binding ElementName=CaptionOverlayGrid, Path=Height, FallbackValue=0}"
                        MinWidth="10"
                        MinHeight="10"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Background="Transparent"
                        ClipToBounds="True"
                        CurrentShape="Arrow"
                        DrawingMode="Shape"
                        Visibility="{Binding ElementName=ShapesGrid, Path=Visibility}" />

                    <n:MoveResizeControl
                        x:Name="WatermarkOverlayCanvas"
                        Width="{Binding ElementName=CaptionOverlayGrid, Path=Width, FallbackValue=0}"
                        Height="{Binding ElementName=CaptionOverlayGrid, Path=Height, FallbackValue=0}"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        CanResize="True"
                        ClipToBounds="True"
                        ContentScale="{Binding Source={x:Static t:UserSettings.All}, Path=WatermarkSize}"
                        Left="{Binding ElementName=LeftWatermarkDoubleUpDown, Path=Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, FallbackValue=0}"
                        Top="{Binding ElementName=TopWatermarkDoubleUpDown, Path=Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, FallbackValue=0}"
                        Visibility="{Binding ElementName=WatermarkGrid, Path=Visibility}">
                        <Image
                            x:Name="WatermarkImage"
                            Opacity="{Binding Source={x:Static t:UserSettings.All}, Path=WatermarkOpacity}"
                            RenderTransformOrigin="0.5,0.5"
                            Source="{Binding Source={x:Static t:UserSettings.All}, Path=WatermarkFilePath, Converter={StaticResource UriToBitmapConverter}}"
                            Stretch="Fill" />
                    </n:MoveResizeControl>

                    <Border
                        x:Name="BorderPositiveOverlayBorder"
                        Width="{Binding ElementName=CaptionOverlayGrid, Path=Width, FallbackValue=0}"
                        Height="{Binding ElementName=CaptionOverlayGrid, Path=Height, FallbackValue=0}"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        BorderBrush="{Binding ElementName=BorderColorBox, Path=SelectedBrush}"
                        Visibility="{Binding ElementName=BorderGrid, Path=Visibility}">
                        <Border.BorderThickness>
                            <MultiBinding
                                Converter="{StaticResource DoubleToThicknessConverter}"
                                ConverterParameter="+">
                                <Binding
                                    ElementName="BorderLeftThicknessNumericUpDown"
                                    Path="Value" />
                                <Binding
                                    ElementName="BorderTopThicknessNumericUpDown"
                                    Path="Value" />
                                <Binding
                                    ElementName="BorderRightThicknessNumericUpDown"
                                    Path="Value" />
                                <Binding
                                    ElementName="BorderBottomThicknessNumericUpDown"
                                    Path="Value" />
                            </MultiBinding>
                        </Border.BorderThickness>

                        <!--<Border.CornerRadius>
                            <MultiBinding Converter="{StaticResource DoubleToRadiusConverter}">
                                <Binding ElementName="BorderLeftRadiusNumericUpDown" Path="Value"/>
                                <Binding ElementName="BorderTopRadiusNumericUpDown" Path="Value"/>
                                <Binding ElementName="BorderRightRadiusNumericUpDown" Path="Value"/>
                                <Binding ElementName="BorderBottomRadiusNumericUpDown" Path="Value"/>
                            </MultiBinding>
                        </Border.CornerRadius>-->
                    </Border>

                    <n:SelectControlOld
                        x:Name="ObfuscateOverlaySelectControl"
                        Width="{Binding ElementName=CaptionOverlayGrid, Path=Width, FallbackValue=0}"
                        Height="{Binding ElementName=CaptionOverlayGrid, Path=Height, FallbackValue=0}"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        EmbeddedMode="True"
                        Visibility="{Binding ElementName=ObfuscateGrid, Path=Visibility}" />

                    <Grid
                        x:Name="ProgressOverlayGrid"
                        Width="{Binding ElementName=CaptionOverlayGrid, Path=Width, FallbackValue=0}"
                        Height="{Binding ElementName=CaptionOverlayGrid, Path=Height, FallbackValue=0}"
                        MinWidth="10"
                        MinHeight="10"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Background="Transparent"
                        ClipToBounds="True"
                        Visibility="{Binding ElementName=ProgressGrid, Path=Visibility}">

                        <Grid Visibility="{Binding ProgressType, Source={x:Static t:UserSettings.All}, Converter={StaticResource EnumToVisibility}, ConverterParameter={x:Static e:ProgressTypes.Bar}}">
                            <Rectangle
                                Name="ProgressHorizontalRectangle"
                                Height="{Binding Source={x:Static t:UserSettings.All}, Path=ProgressThickness}"
                                HorizontalAlignment="{Binding ProgressHorizontalAligment, Source={x:Static t:UserSettings.All}}"
                                VerticalAlignment="{Binding ProgressVerticalAligment, Source={x:Static t:UserSettings.All}}"
                                Fill="{Binding ProgressColor, Source={x:Static t:UserSettings.All}, Converter={StaticResourceExtension ColorToBrush}}"
                                Visibility="{Binding ProgressOrientation, Source={x:Static t:UserSettings.All}, Converter={StaticResource EnumToVisibility}, ConverterParameter={x:Static Orientation.Horizontal}}" />

                            <Rectangle
                                Name="ProgressVerticalRectangle"
                                Width="{Binding Source={x:Static t:UserSettings.All}, Path=ProgressThickness}"
                                HorizontalAlignment="{Binding ProgressHorizontalAligment, Source={x:Static t:UserSettings.All}}"
                                VerticalAlignment="{Binding ProgressVerticalAligment, Source={x:Static t:UserSettings.All}}"
                                Fill="{Binding ProgressColor, Source={x:Static t:UserSettings.All}, Converter={StaticResourceExtension ColorToBrush}}"
                                Visibility="{Binding ProgressOrientation, Source={x:Static t:UserSettings.All}, Converter={StaticResource EnumToVisibility}, ConverterParameter={x:Static Orientation.Vertical}}" />
                        </Grid>

                        <TextBlock
                            Name="ProgressHorizontalTextBlock"
                            Padding="2,0"
                            HorizontalAlignment="{Binding ProgressHorizontalAligment, Source={x:Static t:UserSettings.All}}"
                            VerticalAlignment="{Binding ProgressVerticalAligment, Source={x:Static t:UserSettings.All}}"
                            Background="{Binding ProgressColor, Source={x:Static t:UserSettings.All}, Converter={StaticResourceExtension ColorToBrush}}"
                            FontFamily="{Binding ElementName=ProgressFontComboBox, Path=SelectedItem}"
                            FontSize="{Binding ElementName=ProgressFontSizeNumericUpDown, Path=Value}"
                            FontStyle="{Binding ElementName=ProgressFontStyleComboBox, Path=SelectedValue}"
                            FontWeight="{Binding ElementName=ProgressFontWeightComboBox, Path=SelectedValue}"
                            Foreground="{Binding ProgressFontColor, Source={x:Static t:UserSettings.All}, Converter={StaticResourceExtension ColorToBrush}}"
                            Visibility="{Binding ProgressType, Source={x:Static t:UserSettings.All}, Converter={StaticResource EnumToVisibility}, ConverterParameter={x:Static e:ProgressTypes.Text}}" />
                    </Grid>

                    <n:InkCanvasExtended
                        x:Name="CinemagraphInkCanvas"
                        Width="{Binding ElementName=CaptionOverlayGrid, Path=Width, FallbackValue=0}"
                        Height="{Binding ElementName=CaptionOverlayGrid, Path=Height, FallbackValue=0}"
                        MinWidth="10"
                        MinHeight="10"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Background="Transparent"
                        ClipToBounds="True"
                        PreviewKeyDown="InkCanvas_PreviewKeyDown"
                        Visibility="{Binding ElementName=CinemagraphGrid, Path=Visibility}">

                        <n:InkCanvasExtended.EditingMode>
                            <MultiBinding Converter="{StaticResource SelectionToEditingModeConverter}">
                                <Binding
                                    ElementName="PenMode2RadioButton"
                                    Path="IsChecked" />
                                <Binding
                                    ElementName="EraserMode2RadioButton"
                                    Path="IsChecked" />
                                <Binding
                                    ElementName="SelectorMode2RadioButton"
                                    Path="IsChecked" />
                            </MultiBinding>
                        </n:InkCanvasExtended.EditingMode>

                        <n:InkCanvasExtended.DefaultDrawingAttributes>
                            <MultiBinding Converter="{StaticResource SelectionToDrawingAttributesConverter}">
                                <Binding
                                    ElementName="CinemagraphHeightNumericUpDown"
                                    Path="Value" />
                                <Binding
                                    ElementName="CinemagraphWidthNumericUpDown"
                                    Path="Value" />
                                <Binding
                                    Path="CinemagraphColor"
                                    Source="{x:Static t:UserSettings.All}" />
                                <Binding
                                    ElementName="FitToCurve2CheckBox"
                                    Path="IsChecked" />
                                <Binding
                                    Path="CinemagraphIsHighlighter"
                                    Source="{x:Static t:UserSettings.All}" />
                                <Binding
                                    ElementName="Rectangle2RadioButton"
                                    Path="IsChecked" />
                            </MultiBinding>
                        </n:InkCanvasExtended.DefaultDrawingAttributes>

                        <n:InkCanvasExtended.EraserShape>
                            <MultiBinding Converter="{StaticResource SelectionToStylusShapeConverter}">
                                <Binding
                                    ElementName="CinemagraphEraserWidthNumericUpDown"
                                    Path="Value" />
                                <Binding
                                    ElementName="CinemagraphEraserHeightNumericUpDown"
                                    Path="Value" />
                                <Binding
                                    ElementName="RectangleEraser2RadioButton"
                                    Path="IsChecked" />
                            </MultiBinding>
                        </n:InkCanvasExtended.EraserShape>
                    </n:InkCanvasExtended>
                </Grid>
            </ScrollViewer>

            <Grid
                x:Name="WelcomeGrid"
                Grid.Row="1"
                Grid.Column="0"
                AllowDrop="True"
                Background="{DynamicResource Panel.Background.Level3}"
                DragEnter="Control_DragEnter"
                Drop="Control_Drop"
                Visibility="Visible">
                <Grid.ContextMenu>
                    <ContextMenu>
                        <n:ExtendedMenuItem
                            Command="{StaticResource Command.NewRecording}"
                            ContentHeight="16"
                            ContentWidth="16"
                            Header="{DynamicResource S.Context.NewRecording}"
                            Icon="{StaticResource Vector.Record.New}" />
                        <n:ExtendedMenuItem
                            Command="{StaticResource Command.NewWebcamRecording}"
                            ContentHeight="16"
                            ContentWidth="16"
                            Header="{DynamicResource S.Context.NewWebcamRecording}"
                            Icon="{StaticResource Vector.Camera.New}" />
                        <n:ExtendedMenuItem
                            Command="{StaticResource Command.NewBoardRecording}"
                            ContentHeight="16"
                            ContentWidth="16"
                            Header="{DynamicResource S.Context.NewBoardRecording}"
                            Icon="{StaticResource Vector.Board.New}" />
                        <n:ExtendedMenuItem
                            Command="{StaticResource Command.NewAnimation}"
                            ContentHeight="16"
                            ContentWidth="16"
                            Header="{DynamicResource S.Context.NewBlankAnimation}"
                            Icon="{StaticResource Vector.File.New}" />
                        <n:ExtendedMenuItem
                            Command="{StaticResource Command.Load}"
                            ContentHeight="16"
                            ContentWidth="16"
                            Header="{DynamicResource S.Context.NewFromMediaProject}"
                            Icon="{StaticResource Vector.Open}" />
                    </ContextMenu>
                </Grid.ContextMenu>

                <StackPanel
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center">
                    <TextBlock
                        HorizontalAlignment="Center"
                        Effect="{StaticResource Shadow.Background.Tiny}"
                        FontFamily="Segoe UI Semilight"
                        FontSize="28"
                        Foreground="{DynamicResource Element.Foreground.Gray192}"
                        Text="{Binding Source={x:Static t:UserSettings.All}, Path=VersionText, StringFormat=ScreenToGif {0}}" />

                    <Separator Height="1" />

                    <TextBlock
                        x:Name="WelcomeTextBlock"
                        HorizontalAlignment="Center"
                        Effect="{StaticResource Shadow.Background.Tiny}"
                        FontFamily="Segoe UI Semilight"
                        FontSize="16"
                        Foreground="{DynamicResource Element.Foreground.Gray192}"
                        TextWrapping="Wrap" />

                    <!--<TextBlock FontSize="16" FontFamily="Segoe UI Semilight" HorizontalAlignment="Center" Foreground="{DynamicResource Element.Foreground.Gray192}" Effect="{StaticResource Shadow.Border.Small}">
                        <Hyperlink Command="{StaticResource Command.LoadRecent}" Cursor="Hand" TextDecorations="{x:Null}">
                            <Run>Open recent projects...</Run>
                        </Hyperlink>
                    </TextBlock>-->

                    <TextBlock
                        x:Name="SymbolTextBlock"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Effect="{StaticResource Shadow.Background.Tiny}"
                        FontFamily="Segoe UI Semilight"
                        FontSize="40"
                        Foreground="{DynamicResource Element.Foreground.Gray208}"
                        Text=":D"
                        TextWrapping="WrapWithOverflow" />

                    <!--  New update available  -->
                    <StackPanel
                        x:Name="UpdateStackPanel"
                        Margin="0,30,0,0"
                        HorizontalAlignment="Center"
                        Visibility="Collapsed">
                        <Separator Height="1" />

                        <TextBlock
                            Margin="3"
                            HorizontalAlignment="Center"
                            Effect="{StaticResource Shadow.Background.Tiny}"
                            FontFamily="Segoe UI Semilight"
                            FontSize="18"
                            Foreground="{DynamicResource Element.Foreground.Gray192}"
                            ToolTip="{DynamicResource S.Editor.UpdateAvailable.Info}">
                            <Hyperlink
                                Command="{Binding Source={StaticResource AppViewModel}, Path=PromptUpdate}"
                                Cursor="Hand"
                                TextDecorations="{x:Null}">
                                <Run Text="{DynamicResource S.Editor.UpdateAvailable}" />
                            </Hyperlink>
                        </TextBlock>

                        <TextBlock
                            HorizontalAlignment="Center"
                            Effect="{StaticResource Shadow.Background.Tiny}"
                            FontFamily="Segoe UI Semilight"
                            FontSize="14"
                            Foreground="{DynamicResource Element.Foreground.Gray192}"
                            TextAlignment="Center">
                            <Run
                                FontSize="18"
                                Text="{DynamicResource S.Updater.Version}" />
                            <Run
                                Name="UpdateVersionRun"
                                FontSize="18"
                                Text="2.22" />
                            <LineBreak />
                            <Run
                                Name="UpdateSizeRun"
                                FontSize="16"
                                Text="800 KB" />
                        </TextBlock>
                    </StackPanel>
                </StackPanel>
            </Grid>

            <Grid
                x:Name="ActionGrid"
                Grid.Row="0"
                Grid.RowSpan="2"
                Grid.Column="1"
                Width="0"
                Background="{DynamicResource Panel.Background.Level2}"
                Effect="{StaticResource Shadow.Border}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="30" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <!--  Title  -->
                <Grid Grid.Row="0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="30" />
                        <ColumnDefinition />
                        <ColumnDefinition Width="30" />
                    </Grid.ColumnDefinitions>

                    <Border
                        x:Name="ActionIconBorder"
                        Grid.Column="0"
                        Width="20"
                        Height="20"
                        Margin="5,3,0,3"
                        Opacity="{DynamicResource Element.Opacity}" />

                    <TextBlock
                        x:Name="ActionTitleTextBlock"
                        Grid.Column="1"
                        Padding="5,0,0,0"
                        VerticalAlignment="Center"
                        Foreground="{DynamicResource Element.Foreground}"
                        Text="Title" />

                    <n:ExtendedButton
                        x:Name="HideButton"
                        Grid.Column="2"
                        MinWidth="30"
                        HorizontalAlignment="Center"
                        HorizontalContentAlignment="Center"
                        Command="{StaticResource Command.Cancel}"
                        ContentHeight="16"
                        ContentWidth="16"
                        Icon="{DynamicResource Vector.Close}"
                        Style="{DynamicResource Style.Button.NoText}"
                        ToolTip="{DynamicResource S.Action.Hide}"
                        ToolTipService.HorizontalOffset="-5"
                        ToolTipService.Placement="Top" />
                </Grid>

                <!--  Content  -->
                <ScrollViewer
                    x:Name="ActionScrollViewer"
                    Grid.Row="1"
                    VerticalScrollBarVisibility="Auto">
                    <Grid x:Name="ActionInternalGrid">
                        <ContentControl
                            x:Name="CustomContentControl"
                            Focusable="False"
                            IsTabStop="False"
                            Visibility="Collapsed" />

                        <Grid
                            x:Name="NewGrid"
                            Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="27" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="27" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <n:LabelSeparator
                                Grid.Row="0"
                                Text="{DynamicResource S.Size}" />
                            <Grid
                                Grid.Row="1"
                                Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    Padding="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.ImportVideo.Width}" />
                                <n:IntegerUpDown
                                    x:Name="NewImageWidthNumericUpDown"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinWidth="80"
                                    Margin="10,5"
                                    Maximum="2000"
                                    Minimum="10"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=NewAnimationWidth, Mode=TwoWay}" />

                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    Padding="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.ImportVideo.Height}" />
                                <n:IntegerUpDown
                                    x:Name="NewImageHeightNumericUpDown"
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    MinWidth="80"
                                    Margin="10,5"
                                    Maximum="2000"
                                    Minimum="10"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=NewAnimationHeight, Mode=TwoWay}" />
                            </Grid>

                            <n:LabelSeparator
                                Grid.Row="2"
                                Text="{DynamicResource S.Background}" />
                            <Grid
                                Grid.Row="3"
                                Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    Padding="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Color}" />
                                <n:ColorBox
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    Margin="5,3"
                                    SelectedColor="{Binding NewAnimationColor, Source={x:Static t:UserSettings.All}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                            </Grid>
                        </Grid>

                        <Grid
                            x:Name="LoadRecentGrid"
                            Height="{Binding ElementName=ActionScrollViewer, Path=ActualHeight, FallbackValue=100}"
                            Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="27" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>

                            <!--  Two buttons modes: thumbnail, flat list  -->
                            <!--  Save mode  -->

                            <n:LabelSeparator
                                Grid.Row="0"
                                Margin="5,0"
                                Padding="0,5"
                                Text="{DynamicResource S.Recent.Projects}" />
                            <DataGrid
                                x:Name="RecentDataGrid"
                                Grid.Row="1"
                                MinHeight="60"
                                Margin="10,5,5,5"
                                MouseDoubleClick="RecentDataGrid_MouseDoubleClick"
                                PreviewKeyDown="RecentDataGrid_PreviewKeyDown"
                                SelectionMode="Single"
                                SelectionUnit="FullRow">
                                <DataGrid.Columns>
                                    <DataGridTextColumn
                                        Width="*"
                                        Binding="{Binding Path=CreationDate, UpdateSourceTrigger=PropertyChanged, StringFormat='{}{0:G}', ConverterCulture={x:Static gl:CultureInfo.CurrentCulture}}"
                                        Header="{DynamicResource S.Recent.Date}"
                                        IsReadOnly="True" />
                                    <DataGridTextColumn
                                        Width="100"
                                        Binding="{Binding Path=Frames.Count, UpdateSourceTrigger=PropertyChanged}"
                                        Header="{DynamicResource S.Recent.Frames}"
                                        IsReadOnly="True" />
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>

                        <Grid
                            x:Name="ClipboardGrid"
                            Height="{Binding ElementName=ActionScrollViewer, Path=ActualHeight, FallbackValue=100}"
                            Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="27" />
                                <RowDefinition Height="*" />
                                <RowDefinition Height="27" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <n:LabelSeparator
                                Grid.Row="0"
                                Text="{DynamicResource S.Clipboard.Entries}" />
                            <ListBox
                                x:Name="ClipboardListBox"
                                Grid.Row="1"
                                MinHeight="60"
                                Margin="10,5,5,5"
                                VerticalAlignment="Stretch"
                                ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                <ListBox.Resources>
                                    <ContextMenu x:Key="ClipboardContextMenu">
                                        <n:ExtendedMenuItem
                                            ContentHeight="16"
                                            ContentWidth="16"
                                            Header="{DynamicResource S.Clipboard.Entry}"
                                            Icon="{StaticResource Vector.Paste}"
                                            IsHitTestVisible="False" />
                                        <Separator />
                                        <n:ExtendedMenuItem
                                            Command="{StaticResource Command.ExploreClipboard}"
                                            ContentHeight="16"
                                            ContentWidth="16"
                                            Header="{DynamicResource S.Clipboard.Explore}"
                                            Icon="{StaticResource Vector.Open}" />
                                        <n:ExtendedMenuItem
                                            Command="{StaticResource Command.RemoveClipboardEntry}"
                                            ContentHeight="16"
                                            ContentWidth="16"
                                            Header="{DynamicResource S.Clipboard.Remove}"
                                            Icon="{StaticResource Vector.Remove}" />
                                    </ContextMenu>
                                </ListBox.Resources>

                                <ListBox.ItemContainerStyle>
                                    <Style TargetType="ListBoxItem">
                                        <Setter Property="ContextMenu" Value="{StaticResource ClipboardContextMenu}" />
                                    </Style>
                                </ListBox.ItemContainerStyle>
                            </ListBox>

                            <n:LabelSeparator
                                Grid.Row="2"
                                Text="{DynamicResource S.Clipboard.Behavior}" />
                            <RadioButton
                                x:Name="PasteBeforeRadioButton"
                                Grid.Row="3"
                                Margin="10,5,5,5"
                                Content="{DynamicResource S.Clipboard.Before}"
                                IsChecked="{Binding PasteBehavior, Source={x:Static t:UserSettings.All}, Converter={StaticResource EnumToBool}, ConverterParameter={x:Static e:PasteBehaviors.BeforeSelected}}" />
                            <RadioButton
                                x:Name="PasteAfterRadioButton"
                                Grid.Row="4"
                                Margin="10,5,5,5"
                                Content="{DynamicResource S.Clipboard.After}"
                                IsChecked="{Binding PasteBehavior, Source={x:Static t:UserSettings.All}, Converter={StaticResource EnumToBool}, ConverterParameter={x:Static e:PasteBehaviors.AfterSelected}}" />
                        </Grid>

                        <o:ResizePanel
                            x:Name="ResizePanel"
                            Visibility="Collapsed" />

                        <Grid
                            x:Name="CropGrid"
                            Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="27" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="27" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <n:LabelSeparator
                                Grid.Row="0"
                                Text="{DynamicResource S.Preview}" />
                            <Image
                                x:Name="CropImage"
                                Grid.Row="1"
                                Height="120"
                                Margin="10,5,5,5"
                                Effect="{StaticResource Shadow.Border.Large}"
                                Stretch="Uniform" />
                            <TextBlock
                                x:Name="CropSizeTextBlock"
                                Grid.Row="2"
                                Padding="2"
                                HorizontalAlignment="Center"
                                Foreground="{DynamicResource Element.Foreground.Medium}"
                                Text="0 × 0" />

                            <n:LabelSeparator
                                Grid.Row="3"
                                Text="{DynamicResource S.Crop.Points}" />
                            <Grid
                                Grid.Row="4"
                                Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Crop.Top}" />
                                <n:IntegerUpDown
                                    x:Name="TopCropNumericUpDown"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinWidth="70"
                                    Margin="10,3"
                                    Minimum="0"
                                    ValueChanged="CropIntegerUpDown_ValueChanged">
                                    <n:IntegerUpDown.Maximum>
                                        <MultiBinding
                                            Converter="{StaticResource MaximumValueConverter}"
                                            Mode="OneWay">
                                            <Binding
                                                FallbackValue="0"
                                                Path="Minimum"
                                                RelativeSource="{RelativeSource Mode=Self}" />
                                            <Binding
                                                ElementName="BottomCropNumericUpDown"
                                                Path="Value" />
                                            <Binding
                                                ElementName="BottomCropNumericUpDown"
                                                FallbackValue="0"
                                                Path="Minimum" />
                                        </MultiBinding>
                                    </n:IntegerUpDown.Maximum>
                                </n:IntegerUpDown>

                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Crop.Left}" />
                                <n:IntegerUpDown
                                    x:Name="LeftCropNumericUpDown"
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    MinWidth="70"
                                    Margin="10,3"
                                    Minimum="0"
                                    ValueChanged="CropIntegerUpDown_ValueChanged">
                                    <n:IntegerUpDown.Maximum>
                                        <MultiBinding
                                            Converter="{StaticResource MaximumValueConverter}"
                                            Mode="OneWay">
                                            <Binding
                                                FallbackValue="0"
                                                Path="Minimum"
                                                RelativeSource="{RelativeSource Mode=Self}" />
                                            <Binding
                                                ElementName="RightCropNumericUpDown"
                                                Path="Value" />
                                            <Binding
                                                ElementName="RightCropNumericUpDown"
                                                FallbackValue="0"
                                                Path="Minimum" />
                                        </MultiBinding>
                                    </n:IntegerUpDown.Maximum>
                                </n:IntegerUpDown>

                                <TextBlock
                                    Grid.Row="2"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Crop.Bottom}" />
                                <n:IntegerUpDown
                                    x:Name="BottomCropNumericUpDown"
                                    Grid.Row="2"
                                    Grid.Column="1"
                                    MinWidth="70"
                                    Margin="10,3"
                                    Minimum="10"
                                    ValueChanged="CropIntegerUpDown_ValueChanged">
                                    <n:IntegerUpDown.Maximum>
                                        <MultiBinding Converter="{StaticResource MaximumValueConverter}">
                                            <Binding
                                                FallbackValue="0"
                                                Path="Minimum"
                                                RelativeSource="{RelativeSource Mode=Self}" />
                                            <Binding
                                                ElementName="CropAreaGrid"
                                                FallbackValue="0"
                                                Path="Height" />
                                            <!--<Binding ElementName="TopCropNumericUpDown" Path="Value" FallbackValue="0"/>-->
                                        </MultiBinding>
                                    </n:IntegerUpDown.Maximum>
                                </n:IntegerUpDown>

                                <TextBlock
                                    Grid.Row="3"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Crop.Right}" />
                                <n:IntegerUpDown
                                    x:Name="RightCropNumericUpDown"
                                    Grid.Row="3"
                                    Grid.Column="1"
                                    MinWidth="70"
                                    Margin="10,3"
                                    Minimum="10"
                                    ValueChanged="CropIntegerUpDown_ValueChanged">
                                    <n:IntegerUpDown.Maximum>
                                        <MultiBinding
                                            Converter="{StaticResource MaximumValueConverter}"
                                            Mode="OneWay">
                                            <Binding
                                                FallbackValue="0"
                                                Path="Minimum"
                                                RelativeSource="{RelativeSource Mode=Self}" />
                                            <Binding
                                                ElementName="CropAreaGrid"
                                                FallbackValue="0"
                                                Path="Width" />
                                            <!--<Binding ElementName="LeftCropNumericUpDown" Path="Value" FallbackValue="0"/>-->
                                        </MultiBinding>
                                    </n:IntegerUpDown.Maximum>
                                </n:IntegerUpDown>
                            </Grid>
                        </Grid>

                        <Grid
                            x:Name="FlipRotateGrid"
                            Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="27" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <n:LabelSeparator
                                Grid.Row="0"
                                Text="{DynamicResource S.Editor.Image.FlipRotate}" />
                            <Grid
                                Grid.Row="1"
                                Margin="10,0"
                                HorizontalAlignment="Center">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>

                                <n:ExtendedRadioButton
                                    x:Name="FlipHorizontalRadioButton"
                                    Grid.Row="0"
                                    Padding="0,5"
                                    ContentHeight="25"
                                    ContentWidth="25"
                                    Cursor="Hand"
                                    Icon="{StaticResource Vector.FlipHorizontal}"
                                    IsChecked="True"
                                    Text="{DynamicResource S.FlipRotate.FlipHorizontal}" />

                                <n:ExtendedRadioButton
                                    x:Name="FlipVerticalRadioButton"
                                    Grid.Row="1"
                                    Padding="0,5"
                                    ContentHeight="25"
                                    ContentWidth="25"
                                    Cursor="Hand"
                                    Icon="{StaticResource Vector.FlipVertical}"
                                    Text="{DynamicResource S.FlipRotate.FlipVertical}" />


                                <n:ExtendedRadioButton
                                    x:Name="RotateLeftRadioButton"
                                    Grid.Row="2"
                                    Padding="0,5"
                                    ContentHeight="25"
                                    ContentWidth="25"
                                    Cursor="Hand"
                                    Icon="{StaticResource Vector.RotateLeft90}"
                                    Text="{DynamicResource S.FlipRotate.RotateLeft}" />


                                <n:ExtendedRadioButton
                                    x:Name="RotateRightRadioButton"
                                    Grid.Row="3"
                                    Padding="0,5"
                                    ContentHeight="25"
                                    ContentWidth="25"
                                    Cursor="Hand"
                                    Icon="{StaticResource Vector.RotateRight90}"
                                    Text="{DynamicResource S.FlipRotate.RotateRight}" />
                            </Grid>
                        </Grid>

                        <Grid
                            x:Name="CaptionGrid"
                            Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="27" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <n:LabelSeparator
                                Grid.Row="0"
                                Text="{DynamicResource S.Caption.Text}" />
                            <n:ExtendedTextBox
                                x:Name="CaptionTextBox"
                                Grid.Row="1"
                                Margin="10,5,5,5"
                                AcceptsReturn="True"
                                AcceptsTab="True"
                                Text="{Binding Source={x:Static t:UserSettings.All}, Path=CaptionText}" />

                            <Expander
                                Grid.Row="2"
                                Header="{DynamicResource S.Caption.Font}"
                                IsExpanded="{Binding IsCaptionFontGroupExpanded, Source={x:Static t:UserSettings.All}}">
                                <Grid Margin="10,0,0,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <TextBlock
                                        Grid.Row="0"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Family}" />
                                    <ComboBox
                                        x:Name="CaptionFontComboBox"
                                        Grid.Row="0"
                                        Grid.Column="1"
                                        MinWidth="100"
                                        MaxWidth="150"
                                        Margin="10,5"
                                        IsEditable="True"
                                        ItemTemplate="{DynamicResource FontTemplate}"
                                        SelectedItem="{Binding Source={x:Static t:UserSettings.All}, Path=CaptionFontFamily}">
                                        <ComboBox.ItemsSource>
                                            <Binding Source="{StaticResource MyFonts}" />
                                        </ComboBox.ItemsSource>

                                        <ComboBox.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <VirtualizingStackPanel
                                                    VirtualizingStackPanel.IsVirtualizing="True"
                                                    VirtualizingStackPanel.VirtualizationMode="Recycling" />
                                            </ItemsPanelTemplate>
                                        </ComboBox.ItemsPanel>
                                    </ComboBox>

                                    <TextBlock
                                        Grid.Row="1"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Style}" />
                                    <ComboBox
                                        x:Name="CaptionFontStyleComboBox"
                                        Grid.Row="1"
                                        Grid.Column="1"
                                        MinWidth="100"
                                        Margin="10,5"
                                        SelectedValue="{Binding Source={x:Static t:UserSettings.All}, Path=CaptionFontStyle}"
                                        SelectedValuePath="FontStyle">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <VirtualizingStackPanel
                                                    IsVirtualizing="True"
                                                    ScrollViewer.IsDeferredScrollingEnabled="True"
                                                    VirtualizationMode="Recycling">
                                                    <TextBlock
                                                        FontSize="14"
                                                        FontStyle="{Binding FontStyle}"
                                                        Text="{Binding Text}" />
                                                </VirtualizingStackPanel>
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>

                                        <TextBlock
                                            FontStyle="Normal"
                                            Text="{DynamicResource S.FontStyles.Normal}" />
                                        <TextBlock
                                            FontStyle="Italic"
                                            Text="{DynamicResource S.FontStyles.Italic}" />
                                        <TextBlock
                                            FontStyle="Oblique"
                                            Text="{DynamicResource S.FontStyles.Oblique}" />
                                    </ComboBox>

                                    <TextBlock
                                        Grid.Row="2"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Weight}" />
                                    <ComboBox
                                        x:Name="CaptionFontWeightComboBox"
                                        Grid.Row="2"
                                        Grid.Column="1"
                                        MinWidth="100"
                                        Margin="10,5"
                                        SelectedValue="{Binding Source={x:Static t:UserSettings.All}, Path=CaptionFontWeight}"
                                        SelectedValuePath="FontWeight">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <VirtualizingStackPanel
                                                    IsVirtualizing="True"
                                                    ScrollViewer.IsDeferredScrollingEnabled="True"
                                                    VirtualizationMode="Recycling">
                                                    <TextBlock
                                                        FontSize="14"
                                                        FontWeight="{Binding FontWeight}"
                                                        Text="{Binding Text}" />
                                                </VirtualizingStackPanel>
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>

                                        <TextBlock
                                            FontWeight="UltraLight"
                                            Text="{DynamicResource S.FontWeights.UltraLight}" />
                                        <TextBlock
                                            FontWeight="ExtraLight"
                                            Text="{DynamicResource S.FontWeights.ExtraLight}" />
                                        <TextBlock
                                            FontWeight="Light"
                                            Text="{DynamicResource S.FontWeights.Light}" />
                                        <TextBlock
                                            FontWeight="Thin"
                                            Text="{DynamicResource S.FontWeights.Thin}" />
                                        <TextBlock
                                            FontWeight="Normal"
                                            Text="{DynamicResource S.FontWeights.Normal}" />
                                        <TextBlock
                                            FontWeight="Regular"
                                            Text="{DynamicResource S.FontWeights.Regular}" />
                                        <TextBlock
                                            FontWeight="Medium"
                                            Text="{DynamicResource S.FontWeights.Medium}" />
                                        <TextBlock
                                            FontWeight="SemiBold"
                                            Text="{DynamicResource S.FontWeights.SemiBold}" />
                                        <TextBlock
                                            FontWeight="DemiBold"
                                            Text="{DynamicResource S.FontWeights.DemiBold}" />
                                        <TextBlock
                                            FontWeight="Bold"
                                            Text="{DynamicResource S.FontWeights.Bold}" />
                                        <TextBlock
                                            FontWeight="Black"
                                            Text="{DynamicResource S.FontWeights.Black}" />
                                        <TextBlock
                                            FontWeight="Heavy"
                                            Text="{DynamicResource S.FontWeights.Heavy}" />
                                        <TextBlock
                                            FontWeight="ExtraBold"
                                            Text="{DynamicResource S.FontWeights.ExtraBold}" />
                                        <TextBlock
                                            FontWeight="ExtraBlack"
                                            Text="{DynamicResource S.FontWeights.ExtraBlack}" />
                                        <TextBlock
                                            FontWeight="UltraBold"
                                            Text="{DynamicResource S.FontWeights.UltraBold}" />
                                        <TextBlock
                                            FontWeight="UltraBlack"
                                            Text="{DynamicResource S.FontWeights.UltraBlack}" />
                                    </ComboBox>

                                    <TextBlock
                                        Grid.Row="3"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Size}" />
                                    <n:IntegerUpDown
                                        x:Name="CaptionFontSizeNumericUpDown"
                                        Grid.Row="3"
                                        Grid.Column="1"
                                        MinWidth="70"
                                        Margin="10,5"
                                        Maximum="1000"
                                        Minimum="10"
                                        Value="{Binding Source={x:Static t:UserSettings.All}, Path=CaptionFontSize, Mode=TwoWay}" />

                                    <TextBlock
                                        Grid.Row="4"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Color}" />
                                    <n:ColorBox
                                        x:Name="CaptionFontColorBox"
                                        Grid.Row="4"
                                        Grid.Column="1"
                                        Margin="10,5"
                                        SelectedColor="{Binding CaptionFontColor, Source={x:Static t:UserSettings.All}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                </Grid>
                            </Expander>

                            <Expander
                                Grid.Row="3"
                                Header="{DynamicResource S.Caption.Outline}"
                                IsExpanded="{Binding IsCaptionOutlineGroupExpanded, Source={x:Static t:UserSettings.All}}">
                                <Grid Margin="10,0,0,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>

                                    <TextBlock
                                        Grid.Row="0"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Thickness}" />
                                    <n:IntegerUpDown
                                        x:Name="CaptionOutlineThicknessNumericUpDown"
                                        Grid.Row="0"
                                        Grid.Column="1"
                                        MinWidth="70"
                                        Margin="10,5"
                                        Maximum="20"
                                        Minimum="0"
                                        Value="{Binding Source={x:Static t:UserSettings.All}, Path=CaptionOutlineThickness, Mode=TwoWay}" />

                                    <TextBlock
                                        Grid.Row="1"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Color}" />
                                    <n:ColorBox
                                        x:Name="CaptionOutlineColorBox"
                                        Grid.Row="1"
                                        Grid.Column="1"
                                        Margin="10,5"
                                        SelectedColor="{Binding CaptionOutlineColor, Source={x:Static t:UserSettings.All}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                </Grid>
                            </Expander>

                            <Expander
                                Grid.Row="4"
                                Header="{DynamicResource S.Caption.Layout}"
                                IsExpanded="{Binding IsCaptionLayoutGroupExpanded, Source={x:Static t:UserSettings.All}}">
                                <Grid Margin="10,0,0,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <TextBlock
                                        Grid.Row="0"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Vertical}" />
                                    <ComboBox
                                        x:Name="CaptionVerticalAligmentComboBox"
                                        Grid.Row="0"
                                        Grid.Column="1"
                                        MinWidth="100"
                                        MaxWidth="110"
                                        Margin="10,5"
                                        SelectedValue="{Binding Source={x:Static t:UserSettings.All}, Path=CaptionVerticalAligment, Mode=TwoWay}"
                                        SelectedValuePath="VerticalAlignment">

                                        <TextBlock
                                            VerticalAlignment="Top"
                                            Text="{DynamicResource S.VerticalAlignment.Top}" />
                                        <TextBlock
                                            VerticalAlignment="Center"
                                            Text="{DynamicResource S.VerticalAlignment.Center}" />
                                        <TextBlock
                                            VerticalAlignment="Bottom"
                                            Text="{DynamicResource S.VerticalAlignment.Bottom}" />
                                    </ComboBox>

                                    <TextBlock
                                        Grid.Row="1"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Horizontal}" />
                                    <ComboBox
                                        x:Name="CaptionHorizontalAligmentComboBox"
                                        Grid.Row="1"
                                        Grid.Column="1"
                                        MinWidth="100"
                                        MaxWidth="110"
                                        Margin="10,5"
                                        SelectedValue="{Binding Source={x:Static t:UserSettings.All}, Path=CaptionHorizontalAligment, Mode=TwoWay}"
                                        SelectedValuePath="HorizontalAlignment">

                                        <TextBlock
                                            HorizontalAlignment="Left"
                                            Text="{DynamicResource S.HorizontalAlignment.Left}" />
                                        <TextBlock
                                            HorizontalAlignment="Center"
                                            Text="{DynamicResource S.HorizontalAlignment.Center}" />
                                        <TextBlock
                                            HorizontalAlignment="Right"
                                            Text="{DynamicResource S.HorizontalAlignment.Right}" />
                                    </ComboBox>

                                    <TextBlock
                                        Grid.Row="2"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Margin}" />
                                    <n:IntegerUpDown
                                        x:Name="CaptionMarginNumericUpDown"
                                        Grid.Row="2"
                                        Grid.Column="1"
                                        MinWidth="70"
                                        Margin="10,5"
                                        Maximum="100"
                                        Minimum="-100"
                                        Value="{Binding Source={x:Static t:UserSettings.All}, Path=CaptionMargin, Mode=TwoWay}" />
                                </Grid>
                            </Expander>
                        </Grid>

                        <Grid
                            x:Name="FreeTextGrid"
                            Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="27" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="27" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <n:LabelSeparator
                                Grid.Row="0"
                                Text="{DynamicResource S.Caption.Text}" />
                            <n:ExtendedTextBox
                                x:Name="FreeTextTextBox"
                                Grid.Row="1"
                                Margin="10,5,5,5"
                                AcceptsReturn="True"
                                AcceptsTab="True"
                                Text="{Binding Source={x:Static t:UserSettings.All}, Path=FreeTextText, Mode=TwoWay}"
                                TextChanged="FreeTextTextBox_TextChanged" />

                            <Expander
                                Grid.Row="2"
                                Header="{DynamicResource S.Caption.Font}"
                                IsExpanded="{Binding IsFreeTextFontGroupExpanded, Source={x:Static t:UserSettings.All}}">
                                <Grid Margin="10,0,0,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <TextBlock
                                        Grid.Row="0"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Family}" />
                                    <ComboBox
                                        x:Name="FreeTextFontComboBox"
                                        Grid.Row="0"
                                        Grid.Column="1"
                                        MinWidth="100"
                                        MaxWidth="150"
                                        Margin="10,5"
                                        IsEditable="True"
                                        ItemTemplate="{DynamicResource FontTemplate}"
                                        SelectedItem="{Binding Source={x:Static t:UserSettings.All}, Path=FreeTextFontFamily, Mode=TwoWay}">
                                        <ComboBox.ItemsSource>
                                            <Binding Source="{StaticResource MyFonts}" />
                                        </ComboBox.ItemsSource>

                                        <ComboBox.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <VirtualizingStackPanel
                                                    VirtualizingStackPanel.IsVirtualizing="True"
                                                    VirtualizingStackPanel.VirtualizationMode="Recycling" />
                                            </ItemsPanelTemplate>
                                        </ComboBox.ItemsPanel>
                                    </ComboBox>

                                    <TextBlock
                                        Grid.Row="1"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Style}" />
                                    <ComboBox
                                        x:Name="FreeTextFontStyleComboBox"
                                        Grid.Row="1"
                                        Grid.Column="1"
                                        MinWidth="100"
                                        Margin="10,5"
                                        SelectedValue="{Binding Source={x:Static t:UserSettings.All}, Path=FreeTextFontStyle, Mode=TwoWay}"
                                        SelectedValuePath="FontStyle">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <VirtualizingStackPanel
                                                    IsVirtualizing="True"
                                                    ScrollViewer.IsDeferredScrollingEnabled="True"
                                                    VirtualizationMode="Recycling">
                                                    <TextBlock
                                                        FontSize="14"
                                                        FontStyle="{Binding FontStyle}"
                                                        Text="{Binding Text}" />
                                                </VirtualizingStackPanel>
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>

                                        <TextBlock
                                            FontStyle="Normal"
                                            Text="{DynamicResource S.FontStyles.Normal}" />
                                        <TextBlock
                                            FontStyle="Italic"
                                            Text="{DynamicResource S.FontStyles.Italic}" />
                                        <TextBlock
                                            FontStyle="Oblique"
                                            Text="{DynamicResource S.FontStyles.Oblique}" />
                                    </ComboBox>

                                    <TextBlock
                                        Grid.Row="2"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Weight}" />
                                    <ComboBox
                                        x:Name="FreeTextFontWeightComboBox"
                                        Grid.Row="2"
                                        Grid.Column="1"
                                        MinWidth="100"
                                        Margin="10,5"
                                        SelectedValue="{Binding Source={x:Static t:UserSettings.All}, Path=FreeTextFontWeight, Mode=TwoWay}"
                                        SelectedValuePath="FontWeight">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <VirtualizingStackPanel
                                                    IsVirtualizing="True"
                                                    ScrollViewer.IsDeferredScrollingEnabled="True"
                                                    VirtualizationMode="Recycling">
                                                    <TextBlock
                                                        FontSize="14"
                                                        FontWeight="{Binding FontWeight}"
                                                        Text="{Binding Text}" />
                                                </VirtualizingStackPanel>
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>

                                        <TextBlock
                                            FontWeight="UltraLight"
                                            Text="{DynamicResource S.FontWeights.UltraLight}" />
                                        <TextBlock
                                            FontWeight="ExtraLight"
                                            Text="{DynamicResource S.FontWeights.ExtraLight}" />
                                        <TextBlock
                                            FontWeight="Light"
                                            Text="{DynamicResource S.FontWeights.Light}" />
                                        <TextBlock
                                            FontWeight="Thin"
                                            Text="{DynamicResource S.FontWeights.Thin}" />
                                        <TextBlock
                                            FontWeight="Normal"
                                            Text="{DynamicResource S.FontWeights.Normal}" />
                                        <TextBlock
                                            FontWeight="Regular"
                                            Text="{DynamicResource S.FontWeights.Regular}" />
                                        <TextBlock
                                            FontWeight="Medium"
                                            Text="{DynamicResource S.FontWeights.Medium}" />
                                        <TextBlock
                                            FontWeight="SemiBold"
                                            Text="{DynamicResource S.FontWeights.SemiBold}" />
                                        <TextBlock
                                            FontWeight="DemiBold"
                                            Text="{DynamicResource S.FontWeights.DemiBold}" />
                                        <TextBlock
                                            FontWeight="Bold"
                                            Text="{DynamicResource S.FontWeights.Bold}" />
                                        <TextBlock
                                            FontWeight="Black"
                                            Text="{DynamicResource S.FontWeights.Black}" />
                                        <TextBlock
                                            FontWeight="Heavy"
                                            Text="{DynamicResource S.FontWeights.Heavy}" />
                                        <TextBlock
                                            FontWeight="ExtraBold"
                                            Text="{DynamicResource S.FontWeights.ExtraBold}" />
                                        <TextBlock
                                            FontWeight="ExtraBlack"
                                            Text="{DynamicResource S.FontWeights.ExtraBlack}" />
                                        <TextBlock
                                            FontWeight="UltraBold"
                                            Text="{DynamicResource S.FontWeights.UltraBold}" />
                                        <TextBlock
                                            FontWeight="UltraBlack"
                                            Text="{DynamicResource S.FontWeights.UltraBlack}" />
                                    </ComboBox>

                                    <TextBlock
                                        Grid.Row="3"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Size}" />
                                    <n:IntegerUpDown
                                        x:Name="FreeTextFontSizeNumericUpDown"
                                        Grid.Row="3"
                                        Grid.Column="1"
                                        MinWidth="70"
                                        Margin="10,5"
                                        Maximum="1000"
                                        Minimum="10"
                                        Value="{Binding Source={x:Static t:UserSettings.All}, Path=FreeTextFontSize, Mode=TwoWay}" />

                                    <TextBlock
                                        Grid.Row="4"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Color}" />
                                    <n:ColorBox
                                        x:Name="FreeTextFontColorBox"
                                        Grid.Row="4"
                                        Grid.Column="1"
                                        Margin="10,5"
                                        SelectedColor="{Binding FreeTextFontColor, Source={x:Static t:UserSettings.All}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                    <TextBlock
                                        Grid.Row="5"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.BackgroundColor}" />
                                    <n:ColorBox
                                        x:Name="FreeTextBackgroundColorBox"
                                        Grid.Row="5"
                                        Grid.Column="1"
                                        Margin="10,5"
                                        SelectedColor="{Binding FreeTextBackgroundColor, Source={x:Static t:UserSettings.All}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                    <TextBlock
                                        Grid.Row="6"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.TextDecoration}" />
                                    <ComboBox
                                        x:Name="FreeTextTextDecorationComboBox"
                                        Grid.Row="6"
                                        Grid.Column="1"
                                        MinWidth="100"
                                        Margin="10,5"
                                        SelectedValue="{Binding Source={x:Static t:UserSettings.All}, Path=FreeTextTextDecoration, Mode=TwoWay}"
                                        SelectedValuePath="Tag">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <VirtualizingStackPanel
                                                    IsVirtualizing="True"
                                                    ScrollViewer.IsDeferredScrollingEnabled="True"
                                                    VirtualizationMode="Recycling">
                                                    <TextBlock
                                                        FontSize="14"
                                                        Text="{Binding Text}"
                                                        TextDecorations="{Binding TextDecorations}" />
                                                </VirtualizingStackPanel>
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>

                                        <TextBlock
                                            Tag="None"
                                            Text="{DynamicResource S.TextDecorations.None}"
                                            TextDecorations="None" />
                                        <TextBlock
                                            Tag="Underline"
                                            Text="{DynamicResource S.TextDecorations.Underline}"
                                            TextDecorations="Underline" />
                                        <TextBlock
                                            Tag="Strikethrough"
                                            Text="{DynamicResource S.TextDecorations.Strikethrough}"
                                            TextDecorations="Strikethrough" />
                                        <TextBlock
                                            Tag="OverLine"
                                            Text="{DynamicResource S.TextDecorations.OverLine}"
                                            TextDecorations="OverLine" />
                                        <TextBlock
                                            Tag="Baseline"
                                            Text="{DynamicResource S.TextDecorations.Baseline}"
                                            TextDecorations="Baseline" />
                                    </ComboBox>
                                </Grid>
                            </Expander>

                            <Expander
                                Grid.Row="3"
                                Header="{DynamicResource S.Editor.Image.Shadow}"
                                IsExpanded="{Binding Source={x:Static t:UserSettings.All}, Path=IsFreeTextShadowGroupExpanded, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                <Grid Margin="10,0,0,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.Resources>
                                        <c:PercentageToOpacity x:Key="PercentageToOpacity" />
                                    </Grid.Resources>

                                    <TextBlock
                                        Grid.Row="0"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Shadow.ShadowColor}" />
                                    <n:ColorBox
                                        Grid.Row="0"
                                        Grid.Column="1"
                                        Margin="10,5"
                                        AllowTransparency="False"
                                        SelectedColor="{Binding Source={x:Static t:UserSettings.All}, Path=FreeTextShadowColor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                    <TextBlock
                                        Grid.Row="1"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Shadow.BlurRadius}" />
                                    <n:DoubleUpDown
                                        Grid.Row="1"
                                        Grid.Column="1"
                                        Margin="10,5"
                                        Maximum="100"
                                        Minimum="0"
                                        StepValue="0.5"
                                        Value="{Binding Source={x:Static t:UserSettings.All}, Path=FreeTextShadowBlurRadius, Mode=TwoWay}" />

                                    <TextBlock
                                        Grid.Row="2"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Shadow.Direction}" />
                                    <n:DoubleUpDown
                                        Grid.Row="2"
                                        Grid.Column="1"
                                        Margin="10,5"
                                        Maximum="360"
                                        Minimum="0"
                                        StepValue="0.5"
                                        Value="{Binding Source={x:Static t:UserSettings.All}, Path=FreeTextShadowDirection, Mode=TwoWay}" />

                                    <TextBlock
                                        Grid.Row="3"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Watermark.Opacity}" />
                                    <n:DoubleUpDown
                                        Grid.Row="3"
                                        Grid.Column="1"
                                        Margin="10,5"
                                        Maximum="100"
                                        Minimum="0"
                                        StepValue="0.5"
                                        Value="{Binding Source={x:Static t:UserSettings.All}, Path=FreeTextShadowOpacity, Converter={StaticResource PercentageToOpacity}, Mode=TwoWay}" />

                                    <TextBlock
                                        Grid.Row="4"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Shadow.Depth}" />
                                    <n:DoubleUpDown
                                        Grid.Row="4"
                                        Grid.Column="1"
                                        Margin="10,5"
                                        Maximum="100"
                                        Minimum="0"
                                        StepValue="0.5"
                                        Value="{Binding Source={x:Static t:UserSettings.All}, Path=FreeTextShadowDepth, Mode=TwoWay}" />
                                </Grid>
                            </Expander>

                            <n:LabelSeparator
                                Grid.Row="4"
                                Text="{DynamicResource S.Caption.Layout}" />
                            <Grid
                                Grid.Row="5"
                                Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Crop.Left}" />
                                <n:IntegerUpDown
                                    x:Name="FreeTextPositionXNumericUpDown"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinWidth="70"
                                    Margin="10,5"
                                    Maximum="{Binding ElementName=FreeTextOverlayControl, Path=ActualWidth, FallbackValue=1000}"
                                    Value="{Binding ElementName=FreeTextOverlayControl, Path=Left, Converter={StaticResource DoubleToIntConverter}, Mode=TwoWay, FallbackValue=0}" />

                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Crop.Top}" />
                                <n:IntegerUpDown
                                    x:Name="FreeTextPositionYNumericUpDown"
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    MinWidth="70"
                                    Margin="10,5"
                                    Maximum="{Binding ElementName=FreeTextOverlayControl, Path=ActualHeight, FallbackValue=1000}"
                                    Value="{Binding ElementName=FreeTextOverlayControl, Path=Top, Converter={StaticResource DoubleToIntConverter}, Mode=TwoWay, FallbackValue=0}" />

                                <TextBlock
                                    Grid.Row="2"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Caption.TextAlignment}" />
                                <ComboBox
                                    x:Name="FreeTextTextAlignmentComboBox"
                                    Grid.Row="2"
                                    Grid.Column="1"
                                    MinWidth="70"
                                    Margin="10,5"
                                    SelectedValue="{Binding Source={x:Static t:UserSettings.All}, Path=FreeTextTextAlignment, Mode=TwoWay}"
                                    SelectedValuePath="TextAlignment">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <VirtualizingStackPanel
                                                IsVirtualizing="True"
                                                ScrollViewer.IsDeferredScrollingEnabled="True"
                                                VirtualizationMode="Recycling">
                                                <TextBlock
                                                    FontSize="14"
                                                    FontStyle="{Binding FontStyle}"
                                                    Text="{Binding Text}" />
                                            </VirtualizingStackPanel>
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>

                                    <TextBlock
                                        Text="{DynamicResource S.TextAlignment.Left}"
                                        TextAlignment="Left" />
                                    <TextBlock
                                        Text="{DynamicResource S.TextAlignment.Center}"
                                        TextAlignment="Center" />
                                    <TextBlock
                                        Text="{DynamicResource S.TextAlignment.Right}"
                                        TextAlignment="Right" />
                                    <TextBlock
                                        Text="{DynamicResource S.TextAlignment.Justify}"
                                        TextAlignment="Justify" />
                                </ComboBox>

                                <TextBlock
                                    Grid.Row="3"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.FreeDrawing.Width}" />
                                <n:IntegerUpDown
                                    x:Name="FreeTextWidthNumericUpDown"
                                    Grid.Row="3"
                                    Grid.Column="1"
                                    MinWidth="70"
                                    Margin="10,5">
                                    <n:IntegerUpDown.Style>
                                        <Style>
                                            <Style.Triggers>
                                                <DataTrigger
                                                    Binding="{Binding ElementName=FreeTextTextAlignmentComboBox, Path=SelectedValue}"
                                                    Value="Justify">
                                                    <Setter Property="n:IntegerUpDown.IsEnabled" Value="True" />
                                                    <Setter Property="n:IntegerUpDown.Value" Value="{Binding ElementName=FreeTextTextBlock, Path=ActualWidth, FallbackValue=0}" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                            <Style.Setters>
                                                <Setter Property="n:IntegerUpDown.IsEnabled" Value="False" />
                                                <Setter Property="n:IntegerUpDown.Value" Value="{Binding ElementName=FreeTextTextBlock, Path=ActualWidth, FallbackValue=0}" />
                                            </Style.Setters>
                                        </Style>
                                    </n:IntegerUpDown.Style>
                                </n:IntegerUpDown>
                            </Grid>
                        </Grid>

                        <Grid
                            x:Name="TitleFrameGrid"
                            Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="27" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="27" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="27" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="27" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <n:LabelSeparator
                                Grid.Row="0"
                                Text="{DynamicResource S.Caption.Text}" />
                            <n:ExtendedTextBox
                                x:Name="TitleFrameTextBox"
                                Grid.Row="1"
                                Margin="10,5,5,5"
                                AcceptsReturn="True"
                                AcceptsTab="True"
                                Text="{Binding Source={x:Static t:UserSettings.All}, Path=TitleFrameText, Mode=TwoWay}" />

                            <Expander
                                Grid.Row="2"
                                Header="{DynamicResource S.Caption.Font}"
                                IsExpanded="{Binding IsTitleFrameFontGroupExpanded, Source={x:Static t:UserSettings.All}}">
                                <Grid Margin="10,0,0,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <TextBlock
                                        Grid.Row="0"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Family}" />
                                    <ComboBox
                                        x:Name="TitleFrameFontComboBox"
                                        Grid.Row="0"
                                        Grid.Column="1"
                                        MinWidth="100"
                                        MaxWidth="150"
                                        Margin="10,5"
                                        IsEditable="True"
                                        ItemTemplate="{DynamicResource FontTemplate}"
                                        SelectedItem="{Binding Source={x:Static t:UserSettings.All}, Path=TitleFrameFontFamily, Mode=TwoWay}">
                                        <ComboBox.ItemsSource>
                                            <Binding Source="{StaticResource MyFonts}" />
                                        </ComboBox.ItemsSource>
                                        <ComboBox.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <VirtualizingStackPanel
                                                    VirtualizingStackPanel.IsVirtualizing="True"
                                                    VirtualizingStackPanel.VirtualizationMode="Recycling" />
                                            </ItemsPanelTemplate>
                                        </ComboBox.ItemsPanel>
                                    </ComboBox>

                                    <TextBlock
                                        Grid.Row="1"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Style}" />
                                    <ComboBox
                                        x:Name="TitleFrameFontStyleComboBox"
                                        Grid.Row="1"
                                        Grid.Column="1"
                                        MinWidth="100"
                                        Margin="10,5"
                                        SelectedValue="{Binding Source={x:Static t:UserSettings.All}, Path=TitleFrameFontStyle, Mode=TwoWay}"
                                        SelectedValuePath="FontStyle">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <VirtualizingStackPanel
                                                    IsVirtualizing="True"
                                                    ScrollViewer.IsDeferredScrollingEnabled="True"
                                                    VirtualizationMode="Recycling">
                                                    <TextBlock
                                                        FontSize="14"
                                                        FontStyle="{Binding FontStyle}"
                                                        Text="{Binding Text}" />
                                                </VirtualizingStackPanel>
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>

                                        <TextBlock
                                            FontStyle="Normal"
                                            Text="{DynamicResource S.FontStyles.Normal}" />
                                        <TextBlock
                                            FontStyle="Italic"
                                            Text="{DynamicResource S.FontStyles.Italic}" />
                                        <TextBlock
                                            FontStyle="Oblique"
                                            Text="{DynamicResource S.FontStyles.Oblique}" />
                                    </ComboBox>

                                    <TextBlock
                                        Grid.Row="2"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Weight}" />
                                    <ComboBox
                                        x:Name="TitleFrameFontWeightComboBox"
                                        Grid.Row="2"
                                        Grid.Column="1"
                                        MinWidth="100"
                                        Margin="10,5"
                                        SelectedValue="{Binding Source={x:Static t:UserSettings.All}, Path=TitleFrameFontWeight, Mode=TwoWay}"
                                        SelectedValuePath="FontWeight">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <VirtualizingStackPanel
                                                    IsVirtualizing="True"
                                                    ScrollViewer.IsDeferredScrollingEnabled="True"
                                                    VirtualizationMode="Recycling">
                                                    <TextBlock
                                                        FontSize="14"
                                                        FontWeight="{Binding FontWeight}"
                                                        Text="{Binding Text}" />
                                                </VirtualizingStackPanel>
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>

                                        <TextBlock
                                            FontWeight="UltraLight"
                                            Text="{DynamicResource S.FontWeights.UltraLight}" />
                                        <TextBlock
                                            FontWeight="ExtraLight"
                                            Text="{DynamicResource S.FontWeights.ExtraLight}" />
                                        <TextBlock
                                            FontWeight="Light"
                                            Text="{DynamicResource S.FontWeights.Light}" />
                                        <TextBlock
                                            FontWeight="Thin"
                                            Text="{DynamicResource S.FontWeights.Thin}" />
                                        <TextBlock
                                            FontWeight="Normal"
                                            Text="{DynamicResource S.FontWeights.Normal}" />
                                        <TextBlock
                                            FontWeight="Regular"
                                            Text="{DynamicResource S.FontWeights.Regular}" />
                                        <TextBlock
                                            FontWeight="Medium"
                                            Text="{DynamicResource S.FontWeights.Medium}" />
                                        <TextBlock
                                            FontWeight="SemiBold"
                                            Text="{DynamicResource S.FontWeights.SemiBold}" />
                                        <TextBlock
                                            FontWeight="DemiBold"
                                            Text="{DynamicResource S.FontWeights.DemiBold}" />
                                        <TextBlock
                                            FontWeight="Bold"
                                            Text="{DynamicResource S.FontWeights.Bold}" />
                                        <TextBlock
                                            FontWeight="Black"
                                            Text="{DynamicResource S.FontWeights.Black}" />
                                        <TextBlock
                                            FontWeight="Heavy"
                                            Text="{DynamicResource S.FontWeights.Heavy}" />
                                        <TextBlock
                                            FontWeight="ExtraBold"
                                            Text="{DynamicResource S.FontWeights.ExtraBold}" />
                                        <TextBlock
                                            FontWeight="ExtraBlack"
                                            Text="{DynamicResource S.FontWeights.ExtraBlack}" />
                                        <TextBlock
                                            FontWeight="UltraBold"
                                            Text="{DynamicResource S.FontWeights.UltraBold}" />
                                        <TextBlock
                                            FontWeight="UltraBlack"
                                            Text="{DynamicResource S.FontWeights.UltraBlack}" />
                                    </ComboBox>

                                    <TextBlock
                                        Grid.Row="3"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Size}" />
                                    <n:IntegerUpDown
                                        x:Name="TitleFrameFontSizeNumericUpDown"
                                        Grid.Row="3"
                                        Grid.Column="1"
                                        MinWidth="70"
                                        Margin="10,5"
                                        Maximum="200"
                                        Minimum="5"
                                        Value="{Binding Source={x:Static t:UserSettings.All}, Path=TitleFrameFontSize, Mode=TwoWay}" />

                                    <TextBlock
                                        Grid.Row="4"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Color}" />
                                    <n:ColorBox
                                        x:Name="TitleFrameFontColorBox"
                                        Grid.Row="4"
                                        Grid.Column="1"
                                        Margin="10,5"
                                        SelectedColor="{Binding TitleFrameFontColor, Source={x:Static t:UserSettings.All}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                </Grid>
                            </Expander>

                            <n:LabelSeparator
                                Grid.Row="3"
                                Text="{DynamicResource S.Delay}" />
                            <Grid
                                Grid.Row="4"
                                Margin="10,0,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.DelayMs}" />
                                <n:IntegerUpDown
                                    x:Name="TitleFrameDelayIntegerUpDown"
                                    Grid.Column="1"
                                    MinWidth="70"
                                    Margin="10,5"
                                    Maximum="25500"
                                    Minimum="10"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=TitleFrameDelay, Mode=TwoWay}" />
                            </Grid>

                            <n:LabelSeparator
                                Grid.Row="5"
                                Text="{DynamicResource S.Caption.Layout}" />
                            <Grid
                                Grid.Row="6"
                                Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Caption.Vertical}" />
                                <ComboBox
                                    x:Name="TitleFrameVerticalAligmentComboBox"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinWidth="100"
                                    MaxWidth="150"
                                    Margin="10,5"
                                    SelectedValue="{Binding Source={x:Static t:UserSettings.All}, Path=TitleFrameVerticalAligment, Mode=TwoWay}"
                                    SelectedValuePath="VerticalAlignment">

                                    <TextBlock
                                        VerticalAlignment="Top"
                                        Text="{DynamicResource S.VerticalAlignment.Top}" />
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        Text="{DynamicResource S.VerticalAlignment.Center}" />
                                    <TextBlock
                                        VerticalAlignment="Bottom"
                                        Text="{DynamicResource S.VerticalAlignment.Bottom}" />
                                </ComboBox>

                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Caption.Horizontal}" />
                                <ComboBox
                                    x:Name="TitleFrameHorizontalAligmentComboBox"
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    MinWidth="100"
                                    MaxWidth="150"
                                    Margin="10,5"
                                    SelectedValue="{Binding Source={x:Static t:UserSettings.All}, Path=TitleFrameHorizontalAligment, Mode=TwoWay}"
                                    SelectedValuePath="HorizontalAlignment">

                                    <TextBlock
                                        HorizontalAlignment="Left"
                                        Text="{DynamicResource S.HorizontalAlignment.Left}" />
                                    <TextBlock
                                        HorizontalAlignment="Center"
                                        Text="{DynamicResource S.HorizontalAlignment.Center}" />
                                    <TextBlock
                                        HorizontalAlignment="Right"
                                        Text="{DynamicResource S.HorizontalAlignment.Right}" />
                                </ComboBox>

                                <TextBlock
                                    Grid.Row="2"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Margin}" />
                                <n:IntegerUpDown
                                    x:Name="TitleFrameMarginNumericUpDown"
                                    Grid.Row="2"
                                    Grid.Column="1"
                                    MinWidth="70"
                                    Margin="10,5"
                                    Maximum="100"
                                    Minimum="-100"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=TitleFrameMargin, Mode=TwoWay}" />
                            </Grid>

                            <n:LabelSeparator
                                Grid.Row="7"
                                Text="{DynamicResource S.Background}" />
                            <Grid
                                Grid.Row="8"
                                Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Caption.Color}" />
                                <n:ColorBox
                                    x:Name="TitleFrameBackgroundColorBox"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    Margin="10,5"
                                    SelectedColor="{Binding TitleFrameBackgroundColor, Source={x:Static t:UserSettings.All}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                            </Grid>
                        </Grid>

                        <Grid
                            x:Name="KeyStrokesGrid"
                            Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <Expander
                                Grid.Row="0"
                                Header="{DynamicResource S.KeyStrokes.Keys}"
                                IsExpanded="{Binding IsKeyStrokesKeysExpanded, Source={x:Static t:UserSettings.All}}">
                                <Grid Margin="10,0,0,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>

                                    <n:ExtendedButton
                                        Grid.Row="0"
                                        Grid.Column="0"
                                        Grid.ColumnSpan="3"
                                        Margin="0,3"
                                        Padding="5"
                                        HorizontalAlignment="Center"
                                        Click="EditKeyStrokesButton_Click"
                                        ContentHeight="16"
                                        ContentWidth="16"
                                        Icon="{StaticResource Vector.Pen}"
                                        Text="{DynamicResource S.KeyStrokes.Edit}" />

                                    <n:ExtendedCheckBox
                                        Grid.Row="1"
                                        Grid.Column="0"
                                        Grid.ColumnSpan="3"
                                        Margin="0,5"
                                        IsChecked="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesIgnoreNonModifiers, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Text="{DynamicResource S.KeyStrokes.IgnoreModifiers}"
                                        ToolTip="{DynamicResource S.KeyStrokes.IgnoreModifiers.Info}" />

                                    <n:ExtendedCheckBox
                                        Grid.Row="2"
                                        Grid.Column="0"
                                        Grid.ColumnSpan="3"
                                        Margin="0,5"
                                        IsChecked="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesExtended, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Text="{DynamicResource S.KeyStrokes.Extend}" />

                                    <StackPanel
                                        Grid.Row="3"
                                        Grid.Column="0"
                                        Grid.ColumnSpan="3"
                                        Margin="10,0,0,0"
                                        Orientation="Horizontal"
                                        Visibility="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesExtended, Converter={StaticResource Bool2Visibility}}">
                                        <TextBlock
                                            VerticalAlignment="Center"
                                            Foreground="{DynamicResource Element.Foreground.Medium}"
                                            Text="{DynamicResource S.KeyStrokes.By}" />
                                        <n:IntegerUpDown
                                            MinWidth="70"
                                            Margin="5"
                                            Maximum="1000"
                                            Minimum="10"
                                            Value="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesDelay, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>

                                    <n:ExtendedCheckBox
                                        Grid.Row="4"
                                        Grid.Column="0"
                                        Grid.ColumnSpan="3"
                                        Margin="0,5"
                                        IsChecked="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesEarlier, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Text="{DynamicResource S.KeyStrokes.Earlier}" />

                                    <StackPanel
                                        Grid.Row="5"
                                        Grid.Column="0"
                                        Grid.ColumnSpan="3"
                                        Margin="10,0,0,0"
                                        Orientation="Horizontal"
                                        Visibility="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesEarlier, Converter={StaticResource Bool2Visibility}}">
                                        <TextBlock
                                            VerticalAlignment="Center"
                                            Foreground="{DynamicResource Element.Foreground.Medium}"
                                            Text="{DynamicResource S.KeyStrokes.By}" />
                                        <n:IntegerUpDown
                                            MinWidth="70"
                                            Margin="5"
                                            Maximum="1000"
                                            Minimum="10"
                                            Value="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesEarlierBy, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>

                                    <TextBlock
                                        Grid.Row="6"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.KeyStrokes.Separator}" />
                                    <n:ExtendedTextBox
                                        Grid.Row="6"
                                        Grid.Column="1"
                                        MinWidth="70"
                                        Margin="5,3"
                                        Text="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesSeparator, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                </Grid>
                            </Expander>

                            <Expander
                                Grid.Row="1"
                                Header="{DynamicResource S.Caption.Font}"
                                IsExpanded="{Binding IsKeyStrokesFontExpanded, Source={x:Static t:UserSettings.All}}">
                                <Grid Margin="10,0,0,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <TextBlock
                                        Grid.Row="0"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Family}" />
                                    <ComboBox
                                        Grid.Row="0"
                                        Grid.Column="1"
                                        MinWidth="100"
                                        MaxWidth="150"
                                        Margin="10,5"
                                        IsEditable="True"
                                        ItemTemplate="{DynamicResource FontTemplate}"
                                        SelectedItem="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesFontFamily}">
                                        <ComboBox.ItemsSource>
                                            <Binding Source="{StaticResource MyFonts}" />
                                        </ComboBox.ItemsSource>

                                        <ComboBox.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <VirtualizingStackPanel
                                                    VirtualizingStackPanel.IsVirtualizing="True"
                                                    VirtualizingStackPanel.VirtualizationMode="Recycling" />
                                            </ItemsPanelTemplate>
                                        </ComboBox.ItemsPanel>
                                    </ComboBox>

                                    <TextBlock
                                        Grid.Row="1"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Style}" />
                                    <ComboBox
                                        Grid.Row="1"
                                        Grid.Column="1"
                                        MinWidth="100"
                                        Margin="10,5"
                                        SelectedValue="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesFontStyle}"
                                        SelectedValuePath="FontStyle">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <VirtualizingStackPanel
                                                    IsVirtualizing="True"
                                                    ScrollViewer.IsDeferredScrollingEnabled="True"
                                                    VirtualizationMode="Recycling">
                                                    <TextBlock
                                                        FontSize="14"
                                                        FontStyle="{Binding FontStyle}"
                                                        Text="{Binding Text}" />
                                                </VirtualizingStackPanel>
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>

                                        <TextBlock
                                            FontStyle="Normal"
                                            Text="{DynamicResource S.FontStyles.Normal}" />
                                        <TextBlock
                                            FontStyle="Italic"
                                            Text="{DynamicResource S.FontStyles.Italic}" />
                                        <TextBlock
                                            FontStyle="Oblique"
                                            Text="{DynamicResource S.FontStyles.Oblique}" />
                                    </ComboBox>

                                    <TextBlock
                                        Grid.Row="2"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Weight}" />
                                    <ComboBox
                                        Grid.Row="2"
                                        Grid.Column="1"
                                        MinWidth="100"
                                        Margin="10,5"
                                        SelectedValue="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesFontWeight}"
                                        SelectedValuePath="FontWeight">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <VirtualizingStackPanel
                                                    IsVirtualizing="True"
                                                    ScrollViewer.IsDeferredScrollingEnabled="True"
                                                    VirtualizationMode="Recycling">
                                                    <TextBlock
                                                        FontSize="14"
                                                        FontWeight="{Binding FontWeight}"
                                                        Text="{Binding Text}" />
                                                </VirtualizingStackPanel>
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>

                                        <TextBlock
                                            FontWeight="UltraLight"
                                            Text="{DynamicResource S.FontWeights.UltraLight}" />
                                        <TextBlock
                                            FontWeight="ExtraLight"
                                            Text="{DynamicResource S.FontWeights.ExtraLight}" />
                                        <TextBlock
                                            FontWeight="Light"
                                            Text="{DynamicResource S.FontWeights.Light}" />
                                        <TextBlock
                                            FontWeight="Thin"
                                            Text="{DynamicResource S.FontWeights.Thin}" />
                                        <TextBlock
                                            FontWeight="Normal"
                                            Text="{DynamicResource S.FontWeights.Normal}" />
                                        <TextBlock
                                            FontWeight="Regular"
                                            Text="{DynamicResource S.FontWeights.Regular}" />
                                        <TextBlock
                                            FontWeight="Medium"
                                            Text="{DynamicResource S.FontWeights.Medium}" />
                                        <TextBlock
                                            FontWeight="SemiBold"
                                            Text="{DynamicResource S.FontWeights.SemiBold}" />
                                        <TextBlock
                                            FontWeight="DemiBold"
                                            Text="{DynamicResource S.FontWeights.DemiBold}" />
                                        <TextBlock
                                            FontWeight="Bold"
                                            Text="{DynamicResource S.FontWeights.Bold}" />
                                        <TextBlock
                                            FontWeight="Black"
                                            Text="{DynamicResource S.FontWeights.Black}" />
                                        <TextBlock
                                            FontWeight="Heavy"
                                            Text="{DynamicResource S.FontWeights.Heavy}" />
                                        <TextBlock
                                            FontWeight="ExtraBold"
                                            Text="{DynamicResource S.FontWeights.ExtraBold}" />
                                        <TextBlock
                                            FontWeight="ExtraBlack"
                                            Text="{DynamicResource S.FontWeights.ExtraBlack}" />
                                        <TextBlock
                                            FontWeight="UltraBold"
                                            Text="{DynamicResource S.FontWeights.UltraBold}" />
                                        <TextBlock
                                            FontWeight="UltraBlack"
                                            Text="{DynamicResource S.FontWeights.UltraBlack}" />
                                    </ComboBox>

                                    <TextBlock
                                        Grid.Row="3"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Size}" />
                                    <n:IntegerUpDown
                                        Grid.Row="3"
                                        Grid.Column="1"
                                        MinWidth="70"
                                        Margin="10,5"
                                        Maximum="1000"
                                        Minimum="10"
                                        Value="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesFontSize, Mode=TwoWay}" />

                                    <TextBlock
                                        Grid.Row="4"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Color}" />
                                    <n:ColorBox
                                        Grid.Row="4"
                                        Grid.Column="1"
                                        Margin="10,5"
                                        SelectedColor="{Binding KeyStrokesFontColor, Source={x:Static t:UserSettings.All}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                </Grid>
                            </Expander>

                            <Expander
                                Grid.Row="2"
                                Header="{DynamicResource S.Caption.Outline}"
                                IsExpanded="{Binding IsKeyStrokesOutlineExpanded, Source={x:Static t:UserSettings.All}}">
                                <Grid Margin="10,0,0,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>

                                    <TextBlock
                                        Grid.Row="0"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Thickness}" />
                                    <n:IntegerUpDown
                                        Grid.Row="0"
                                        Grid.Column="1"
                                        MinWidth="70"
                                        Margin="10,5"
                                        Maximum="20"
                                        Minimum="0"
                                        Value="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesOutlineThickness, Mode=TwoWay}" />

                                    <TextBlock
                                        Grid.Row="1"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Color}" />
                                    <n:ColorBox
                                        Grid.Row="1"
                                        Grid.Column="1"
                                        Margin="10,5"
                                        SelectedColor="{Binding KeyStrokesOutlineColor, Source={x:Static t:UserSettings.All}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                    <TextBlock
                                        Grid.Row="2"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Background}" />
                                    <n:ColorBox
                                        Grid.Row="2"
                                        Grid.Column="1"
                                        Margin="10,5"
                                        SelectedColor="{Binding KeyStrokesBackgroundColor, Source={x:Static t:UserSettings.All}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                </Grid>
                            </Expander>

                            <Expander
                                Grid.Row="3"
                                Header="{DynamicResource S.Caption.Layout}"
                                IsExpanded="{Binding IsKeyStrokesLayoutExpanded, Source={x:Static t:UserSettings.All}}">
                                <Grid Margin="10,0,0,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <TextBlock
                                        Grid.Row="0"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Vertical}" />
                                    <ComboBox
                                        Grid.Row="0"
                                        Grid.Column="1"
                                        MinWidth="100"
                                        MaxWidth="150"
                                        Margin="10,5"
                                        SelectedValue="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesVerticalAligment, Mode=TwoWay}"
                                        SelectedValuePath="VerticalAlignment">

                                        <TextBlock
                                            VerticalAlignment="Top"
                                            Text="{DynamicResource S.VerticalAlignment.Top}" />
                                        <TextBlock
                                            VerticalAlignment="Center"
                                            Text="{DynamicResource S.VerticalAlignment.Center}" />
                                        <TextBlock
                                            VerticalAlignment="Bottom"
                                            Text="{DynamicResource S.VerticalAlignment.Bottom}" />
                                        <TextBlock
                                            VerticalAlignment="Stretch"
                                            Text="{DynamicResource S.Alignment.Stretch}" />
                                    </ComboBox>

                                    <TextBlock
                                        Grid.Row="1"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Horizontal}" />
                                    <ComboBox
                                        Grid.Row="1"
                                        Grid.Column="1"
                                        MinWidth="100"
                                        MaxWidth="150"
                                        Margin="10,5"
                                        SelectedValue="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesHorizontalAligment, Mode=TwoWay}"
                                        SelectedValuePath="HorizontalAlignment">

                                        <TextBlock
                                            HorizontalAlignment="Left"
                                            Text="{DynamicResource S.HorizontalAlignment.Left}" />
                                        <TextBlock
                                            HorizontalAlignment="Center"
                                            Text="{DynamicResource S.HorizontalAlignment.Center}" />
                                        <TextBlock
                                            HorizontalAlignment="Right"
                                            Text="{DynamicResource S.HorizontalAlignment.Right}" />
                                        <TextBlock
                                            HorizontalAlignment="Stretch"
                                            Text="{DynamicResource S.Alignment.Stretch}" />
                                    </ComboBox>

                                    <TextBlock
                                        Grid.Row="2"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Margin}" />
                                    <n:IntegerUpDown
                                        Grid.Row="2"
                                        Grid.Column="1"
                                        MinWidth="70"
                                        Margin="10,5"
                                        Maximum="100"
                                        Minimum="-100"
                                        Value="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesMargin, Mode=TwoWay}" />

                                    <TextBlock
                                        Grid.Row="3"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Padding}" />
                                    <n:IntegerUpDown
                                        Grid.Row="3"
                                        Grid.Column="1"
                                        MinWidth="70"
                                        Margin="10,5"
                                        Maximum="100"
                                        Minimum="0"
                                        Value="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesPadding, Mode=TwoWay}" />

                                    <TextBlock
                                        Grid.Row="4"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.MinHeight}" />
                                    <n:IntegerUpDown
                                        Grid.Row="4"
                                        Grid.Column="1"
                                        MinWidth="70"
                                        Margin="10,5"
                                        Maximum="100"
                                        Minimum="0"
                                        Value="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesMinHeight, Mode=TwoWay}" />
                                </Grid>
                            </Expander>
                        </Grid>

                        <Grid
                            x:Name="FreeDrawingGrid"
                            Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="27" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <n:LabelSeparator
                                Grid.Row="0"
                                Text="{DynamicResource S.FreeDrawing.Mode}" />
                            <Grid
                                Grid.Row="1"
                                Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <n:ExtendedRadioButton
                                    x:Name="PenModeRadioButton"
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    MinHeight="30"
                                    Margin="0,2"
                                    Padding="2"
                                    ContentHeight="20"
                                    ContentWidth="20"
                                    Cursor="Hand"
                                    Icon="{StaticResource Vector.Pen}"
                                    IsChecked="True"
                                    Text="{DynamicResource S.FreeDrawing.Pen}" />
                                <n:ExtendedRadioButton
                                    x:Name="EraserModeRadioButton"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinHeight="30"
                                    Margin="0,2"
                                    Padding="2"
                                    ContentHeight="20"
                                    ContentWidth="20"
                                    Cursor="Hand"
                                    Icon="{StaticResource Vector.Eraser}"
                                    Text="{DynamicResource S.FreeDrawing.Eraser}" />

                                <n:ExtendedRadioButton
                                    x:Name="SelectorModeRadioButton"
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    MinHeight="30"
                                    Margin="0,2"
                                    Padding="2"
                                    ContentHeight="20"
                                    ContentWidth="20"
                                    Cursor="Hand"
                                    Icon="{StaticResource Vector.Select}"
                                    Text="{DynamicResource S.FreeDrawing.Select}" />
                                <n:ExtendedRadioButton
                                    x:Name="EraserStrokeModeRadioButton"
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    MinHeight="30"
                                    Margin="0,2"
                                    Padding="2"
                                    ContentHeight="20"
                                    ContentWidth="20"
                                    Cursor="Hand"
                                    Icon="{StaticResource Vector.StrokeEraser}"
                                    Text="{DynamicResource S.FreeDrawing.StrokeEraser}" />
                            </Grid>

                            <n:LabelSeparator
                                Grid.Row="2"
                                Text="{DynamicResource S.FreeDrawing.Pen}"
                                Visibility="{Binding ElementName=PenModeRadioButton, Path=IsChecked, Converter={StaticResource Bool2Visibility}}" />
                            <Grid
                                Grid.Row="3"
                                Margin="10,0,0,0"
                                Visibility="{Binding ElementName=PenModeRadioButton, Path=IsChecked, Converter={StaticResource Bool2Visibility}}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.FreeDrawing.Width}" />
                                <n:IntegerUpDown
                                    x:Name="FreeDrawingWidthNumericUpDown"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinWidth="70"
                                    Margin="10,5"
                                    Maximum="100"
                                    Minimum="1"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=FreeDrawingPenWidth, Mode=TwoWay}" />

                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.FreeDrawing.Height}" />
                                <n:IntegerUpDown
                                    x:Name="FreeDrawingHeightNumericUpDown"
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    MinWidth="70"
                                    Margin="10,5"
                                    Maximum="100"
                                    Minimum="1"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=FreeDrawingPenHeight, Mode=TwoWay}" />

                                <TextBlock
                                    Grid.Row="2"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Caption.Color}" />
                                <n:ColorBox
                                    x:Name="FreeDrawingColorBox"
                                    Grid.Row="2"
                                    Grid.Column="1"
                                    Margin="10,5"
                                    SelectedColor="{Binding FreeDrawingColor, Source={x:Static t:UserSettings.All}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                <TextBlock
                                    Grid.Row="3"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.FreeDrawing.Tip}" />
                                <Grid
                                    Grid.Row="3"
                                    Grid.Column="1"
                                    Grid.ColumnSpan="2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>

                                    <n:ExtendedRadioButton
                                        x:Name="RectangleRadioButton"
                                        Grid.Row="0"
                                        Grid.Column="0"
                                        Margin="3,3"
                                        Padding="3"
                                        ContentHeight="20"
                                        ContentWidth="20"
                                        Cursor="Hand"
                                        Icon="{StaticResource Vector.Rectangle}"
                                        IsChecked="{Binding FreeDrawingStylusTip, Source={x:Static t:UserSettings.All}, Converter={StaticResource StylusTipToBoolConverter}, ConverterParameter=Rectangle}"
                                        Text="{DynamicResource S.FreeDrawing.Rectangle}" />
                                    <n:ExtendedRadioButton
                                        x:Name="EllipseRadioButton"
                                        Grid.Row="0"
                                        Grid.Column="1"
                                        Margin="0,3"
                                        Padding="3"
                                        ContentHeight="20"
                                        ContentWidth="20"
                                        Cursor="Hand"
                                        Icon="{StaticResource Vector.Ellipse}"
                                        IsChecked="{Binding FreeDrawingStylusTip, Source={x:Static t:UserSettings.All}, Converter={StaticResource StylusTipToBoolConverter}, ConverterParameter=Ellipse}"
                                        Text="{DynamicResource S.FreeDrawing.Ellipse}" />
                                </Grid>

                                <TextBlock
                                    Grid.Row="4"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.FreeDrawing.Other}" />
                                <n:ExtendedCheckBox
                                    x:Name="IsHighLighterCheckBox"
                                    Grid.Row="4"
                                    Grid.Column="1"
                                    Grid.ColumnSpan="2"
                                    Margin="5"
                                    IsChecked="{Binding Source={x:Static t:UserSettings.All}, Path=FreeDrawingIsHighlighter, Mode=TwoWay}"
                                    Text="{DynamicResource S.FreeDrawing.Highlighter}" />
                                <n:ExtendedCheckBox
                                    x:Name="FitToCurveCheckBox"
                                    Grid.Row="5"
                                    Grid.Column="1"
                                    Grid.ColumnSpan="2"
                                    Margin="5"
                                    IsChecked="{Binding Source={x:Static t:UserSettings.All}, Path=FreeDrawingFitToCurve, Mode=TwoWay}"
                                    Text="{DynamicResource S.FreeDrawing.FitToCurve}" />
                            </Grid>

                            <n:LabelSeparator
                                Grid.Row="4"
                                Text="{DynamicResource S.FreeDrawing.Eraser}"
                                Visibility="{Binding ElementName=EraserModeRadioButton, Path=IsChecked, Converter={StaticResource Bool2Visibility}}" />
                            <Grid
                                Grid.Row="5"
                                Margin="10,0,0,0"
                                Visibility="{Binding ElementName=EraserModeRadioButton, Path=IsChecked, Converter={StaticResource Bool2Visibility}}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.FreeDrawing.Width}" />
                                <n:IntegerUpDown
                                    x:Name="FreeDrawingEraserWidthNumericUpDown"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinWidth="70"
                                    Margin="10,5"
                                    Maximum="100"
                                    Minimum="1"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=FreeDrawingEraserWidth, Mode=TwoWay}" />

                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.FreeDrawing.Height}" />
                                <n:IntegerUpDown
                                    x:Name="FreeDrawingEraserHeightNumericUpDown"
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    MinWidth="70"
                                    Margin="10,5"
                                    Maximum="100"
                                    Minimum="1"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=FreeDrawingEraserHeight, Mode=TwoWay}" />

                                <TextBlock
                                    Grid.Row="2"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.FreeDrawing.Tip}" />
                                <Grid
                                    Grid.Row="2"
                                    Grid.Column="1"
                                    Grid.ColumnSpan="2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>

                                    <n:ExtendedRadioButton
                                        x:Name="RectangleEraserRadioButton"
                                        Grid.Row="0"
                                        Grid.Column="0"
                                        Margin="3,3"
                                        Padding="3"
                                        ContentHeight="20"
                                        ContentWidth="20"
                                        Cursor="Hand"
                                        Icon="{StaticResource Vector.Rectangle}"
                                        IsChecked="{Binding FreeDrawingEraserStylusTip, Source={x:Static t:UserSettings.All}, Converter={StaticResource StylusTipToBoolConverter}, ConverterParameter=Rectangle}"
                                        Text="{DynamicResource S.FreeDrawing.Rectangle}" />
                                    <n:ExtendedRadioButton
                                        x:Name="ElipseEraserRadioButton"
                                        Grid.Row="0"
                                        Grid.Column="1"
                                        Margin="0,3"
                                        Padding="3"
                                        ContentHeight="20"
                                        ContentWidth="20"
                                        Cursor="Hand"
                                        Icon="{StaticResource Vector.Ellipse}"
                                        IsChecked="{Binding FreeDrawingEraserStylusTip, Source={x:Static t:UserSettings.All}, Converter={StaticResource StylusTipToBoolConverter}, ConverterParameter=Ellipse}"
                                        Text="{DynamicResource S.FreeDrawing.Ellipse}" />
                                </Grid>
                            </Grid>
                        </Grid>

                        <Grid
                            x:Name="ShapesGrid"
                            Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="27" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <n:LabelSeparator
                                Grid.Row="0"
                                Text="{DynamicResource S.FreeDrawing.Mode}" />
                            <Grid
                                Grid.Row="1"
                                Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <n:ExtendedRadioButton
                                    x:Name="AddModeRadioButton"
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    MinHeight="30"
                                    Margin="0,2"
                                    Padding="2"
                                    Checked="ShapeModes_Checked"
                                    ContentHeight="20"
                                    ContentWidth="20"
                                    Cursor="Hand"
                                    Icon="{StaticResource Vector.Add}"
                                    IsChecked="True"
                                    Text="{DynamicResource S.Shapes.Mode.Insert}" />

                                <n:ExtendedRadioButton
                                    x:Name="SelectModeRadioButton"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinHeight="30"
                                    Margin="0,2"
                                    Padding="2"
                                    Checked="ShapeModes_Checked"
                                    ContentHeight="20"
                                    ContentWidth="20"
                                    Cursor="Hand"
                                    Icon="{StaticResource Vector.Select}"
                                    Text="{DynamicResource S.FreeDrawing.Select}" />
                            </Grid>

                            <n:LabelSeparator
                                Grid.Row="2"
                                Text="{DynamicResource S.Shapes.Shapes}"
                                Visibility="{Binding ElementName=AddModeRadioButton, Path=IsChecked, Converter={StaticResource Bool2Visibility}}" />
                            <Grid
                                Grid.Row="3"
                                Margin="10,0,5,0"
                                Visibility="{Binding ElementName=AddModeRadioButton, Path=IsChecked, Converter={StaticResource Bool2Visibility}}">
                                <ListBox
                                    x:Name="ShapesListBox"
                                    SelectedIndex="0"
                                    SelectionChanged="ShapeType_SelectionChanged">
                                    <ListBox.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <WrapPanel />
                                        </ItemsPanelTemplate>
                                    </ListBox.ItemsPanel>

                                    <Rectangle
                                        Width="25"
                                        Height="20"
                                        Fill="{DynamicResource Element.Background}"
                                        Stroke="{DynamicResource Element.Glyph}" />
                                    <Ellipse
                                        Width="25"
                                        Height="20"
                                        Fill="{DynamicResource Element.Background}"
                                        Stroke="{DynamicResource Element.Glyph}" />
                                    <h:Triangle
                                        Width="25"
                                        Height="20"
                                        Fill="{DynamicResource Element.Background}"
                                        Stroke="{DynamicResource Element.Glyph}" />
                                    <h:Arrow
                                        Width="25"
                                        Height="20"
                                        Fill="{DynamicResource Element.Background}"
                                        Stroke="{DynamicResource Element.Glyph}"
                                        X1="1"
                                        X2="10"
                                        Y1="1"
                                        Y2="10" />
                                </ListBox>
                            </Grid>

                            <n:LabelSeparator
                                Grid.Row="4"
                                Text="{DynamicResource S.Caption.Outline}" />
                            <Grid
                                Grid.Row="5"
                                Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Caption.Thickness}" />
                                <n:DoubleUpDown
                                    x:Name="ShapeOutlineDoubleUpDown"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinWidth="70"
                                    Margin="10,5"
                                    Maximum="100"
                                    Minimum="0"
                                    UpdateOnInput="True"
                                    ValueChanged="ShapeProperties_Changed"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=ShapesThickness, Mode=TwoWay}" />

                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Caption.Color}" />
                                <n:ColorBox
                                    x:Name="ShapeOutlineColorBox"
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    Margin="10,5"
                                    ColorChanged="ShapeProperties_Changed"
                                    SelectedColor="{Binding ShapesOutlineColor, Source={x:Static t:UserSettings.All}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                <TextBlock
                                    Grid.Row="3"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Shapes.Shapes.Radius}" />
                                <n:DoubleUpDown
                                    x:Name="ShapeRadiusDoubleUpDown"
                                    Grid.Row="3"
                                    Grid.Column="1"
                                    MinWidth="70"
                                    Margin="10,5"
                                    Maximum="100"
                                    Minimum="0"
                                    UpdateOnInput="True"
                                    ValueChanged="ShapeProperties_Changed"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=ShapesRadius, Mode=TwoWay}" />
                            </Grid>

                            <n:LabelSeparator
                                Grid.Row="6"
                                Text="{DynamicResource S.Shapes.Fill}" />
                            <Grid
                                Grid.Row="7"
                                Margin="10,0,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Caption.Color}" />
                                <n:ColorBox
                                    x:Name="ShapesFillColorBox"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    Margin="10,5"
                                    ColorChanged="ShapeProperties_Changed"
                                    SelectedColor="{Binding ShapesFillColor, Source={x:Static t:UserSettings.All}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                            </Grid>
                        </Grid>

                        <Grid
                            x:Name="MouseEventsGrid"
                            Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="27" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="27" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <n:LabelSeparator
                                Grid.Row="0"
                                Text="{DynamicResource S.Border.Appearance}" />
                            <Grid
                                Grid.Row="1"
                                Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <!--  Format(rectangle, circle, perforated circle), edit clicks?  -->
                                <!--  Cursor highlight option, always on  -->

                                <!--<TextBlock Grid.Row="0" Grid.Column="0" Text="{DynamicResource S.Caption.Style}" VerticalAlignment="Center"/>
                                <ComboBox Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="2" Margin="10,5" MinWidth="100" SelectedValuePath="FontStyle"
                                          SelectedValue="{Binding Source={x:Static t:UserSettings.All}, Path=KeyStrokesFontStyle}">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="20"/>
                                                    <ColumnDefinition/>
                                                </Grid.ColumnDefinitions>

                                                <Viewbox Margin="2">
                                                    <ContentPresenter Content="{Binding Tag}"/>
                                                </Viewbox>

                                                <TextBlock Grid.Column="1" FontSize="14" Text="{Binding Text}"/>
                                            </Grid>
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>

                                    <TextBlock Text="Ellipse" Tag="{StaticResource Vector.Ellipse}"/>
                                    <TextBlock Text="Rectangle" Tag="{StaticResource Vector.Rectangle}"/>
                                </ComboBox>-->

                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.MouseHighlight.Color}" />
                                <n:ColorBox
                                    x:Name="MouseHighlightColor"
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    Margin="10,5"
                                    SelectedColor="{Binding Source={x:Static t:UserSettings.All}, Path=MouseHighlightColor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                <TextBlock
                                    Grid.Row="2"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.MouseClicks.Color.Left}" />
                                <n:ColorBox
                                    x:Name="LeftButtonClickColor"
                                    Grid.Row="2"
                                    Grid.Column="1"
                                    Margin="10,5"
                                    SelectedColor="{Binding Source={x:Static t:UserSettings.All}, Path=LeftMouseButtonClicksColor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                <TextBlock
                                    Grid.Row="3"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.MouseClicks.Color.Middle}" />
                                <n:ColorBox
                                    x:Name="MiddleButtonClickColor"
                                    Grid.Row="3"
                                    Grid.Column="1"
                                    Margin="10,5"
                                    SelectedColor="{Binding Source={x:Static t:UserSettings.All}, Path=MiddleMouseButtonClicksColor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                <TextBlock
                                    Grid.Row="4"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.MouseClicks.Color.Right}" />
                                <n:ColorBox
                                    x:Name="RightButtonClickColor"
                                    Grid.Row="4"
                                    Grid.Column="1"
                                    Margin="10,5"
                                    SelectedColor="{Binding Source={x:Static t:UserSettings.All}, Path=RightMouseButtonClicksColor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                <TextBlock
                                    Grid.Row="5"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.MouseClicks.Color.FirstExtra}" />
                                <n:ColorBox
                                    x:Name="FirstExtraButtonClickColor"
                                    Grid.Row="5"
                                    Grid.Column="1"
                                    Margin="10,5"
                                    SelectedColor="{Binding Source={x:Static t:UserSettings.All}, Path=FirstExtraMouseButtonClicksColor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                <TextBlock
                                    Grid.Row="6"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.MouseClicks.Color.SecondExtra}" />
                                <n:ColorBox
                                    x:Name="SecondExtraButtonClickColor"
                                    Grid.Row="6"
                                    Grid.Column="1"
                                    Margin="10,5"
                                    SelectedColor="{Binding Source={x:Static t:UserSettings.All}, Path=SecondExtraMouseButtonClicksColor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                <TextBlock
                                    Grid.Row="7"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.FreeDrawing.Width}" />
                                <n:DoubleUpDown
                                    x:Name="ClickWidthDoubleUpDown"
                                    Grid.Row="7"
                                    Grid.Column="1"
                                    MinWidth="70"
                                    Margin="10,5"
                                    Maximum="1000"
                                    Minimum="1"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=MouseEventsWidth, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                <TextBlock
                                    Grid.Row="8"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.FreeDrawing.Height}" />
                                <n:DoubleUpDown
                                    x:Name="ClickHeightDoubleUpDown"
                                    Grid.Row="8"
                                    Grid.Column="1"
                                    MinWidth="70"
                                    Margin="10,5"
                                    Maximum="1000"
                                    Minimum="1"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=MouseEventsHeight, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                            </Grid>

                            <!--<n:LabelSeparator Grid.Row="2" Text="{DynamicResource S.Preview}"/>
                            <Grid Grid.Row="3" x:Name="PreviewGrid" Margin="10,5">
                                <Viewbox x:Name="PreviewViewBox" Child="{StaticResource Vector.Cursor}" Height="20" Width="20" Stretch="Uniform">
                                    <Viewbox.Margin>
                                        <MultiBinding Converter="{StaticResource DoubleToThicknessConverter}">
                                            <Binding Source="{x:Static t:UserSettings.All}" Path="MouseEventsWidth"/>
                                            <Binding Source="{x:Static t:UserSettings.All}" Path="MouseEventsHeight"/>
                                        </MultiBinding>
                                    </Viewbox.Margin>
                                </Viewbox>

                                <Ellipse Fill="{Binding ElementName=MouseBackgroundColor, Path=SelectedBrush, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                                         Width="{Binding Source={x:Static t:UserSettings.All}, Path=MouseEventsWidth, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                                         Height="{Binding Source={x:Static t:UserSettings.All}, Path=MouseEventsHeight, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                                         HorizontalAlignment="Center" VerticalAlignment="Center" Stretch="None"/>
                            </Grid>-->
                        </Grid>

                        <Grid
                            x:Name="WatermarkGrid"
                            Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="27" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="27" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <n:LabelSeparator
                                Grid.Row="0"
                                Text="{DynamicResource S.Watermark.Image}" />
                            <Grid
                                Grid.Row="1"
                                Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition
                                        Height="Auto"
                                        MinHeight="35" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <Label
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Content="{DynamicResource S.Watermark.File}"
                                    Foreground="{DynamicResource Element.Foreground.Medium}" />
                                <TextBlock
                                    x:Name="ImagePathLabel"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    Margin="3"
                                    Padding="0"
                                    VerticalAlignment="Center"
                                    FontStyle="Italic"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{Binding Source={x:Static t:UserSettings.All}, Path=WatermarkFilePath, Converter={StaticResource PathToFilenameConverter}}"
                                    TextWrapping="WrapWithOverflow"
                                    ToolTip="{Binding Source={x:Static t:UserSettings.All}, Path=WatermarkFilePath}"
                                    ToolTipService.HorizontalOffset="-5"
                                    ToolTipService.Placement="Top" />

                                <n:ExtendedButton
                                    x:Name="SelectWatermarkButton"
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    MinWidth="70"
                                    Margin="5,3"
                                    Padding="2,5"
                                    HorizontalAlignment="Right"
                                    Click="SelectWatermark_Click"
                                    ContentHeight="20"
                                    ContentWidth="20"
                                    Icon="{StaticResource Vector.Image}"
                                    Text="{DynamicResource S.FreeDrawing.Select}" />
                            </Grid>

                            <Grid
                                Grid.Row="2"
                                Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Watermark.Opacity}" />
                                <n:IntegerUpDown
                                    x:Name="OpacityWatermarkNumericUpDown"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    Width="70"
                                    Margin="5"
                                    HorizontalAlignment="Left"
                                    Maximum="100"
                                    Minimum="1"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=WatermarkOpacity, Converter={StaticResource DoubleTimesAHundredToIntConverter}, Mode=TwoWay, FallbackValue=70}" />
                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="2"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="%" />

                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.ImportVideo.Scale}" />
                                <n:IntegerUpDown
                                    x:Name="SizeWatermarkNumericUpDown"
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    Width="70"
                                    Margin="5"
                                    HorizontalAlignment="Left"
                                    Maximum="200"
                                    Minimum="1"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=WatermarkSize, Converter={StaticResource DoubleTimesAHundredToIntConverter}, Mode=TwoWay, FallbackValue=100}" />
                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="2"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="%" />
                            </Grid>

                            <n:LabelSeparator
                                Grid.Row="3"
                                Text="{DynamicResource S.Crop.Points}" />
                            <Grid
                                Grid.Row="4"
                                Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Crop.Top}" />
                                <n:DoubleUpDown
                                    x:Name="TopWatermarkDoubleUpDown"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinWidth="70"
                                    Margin="10,3"
                                    Maximum="{Binding ElementName=EditorWindow, Path=FrameSize.Height, FallbackValue=1000, UpdateSourceTrigger=PropertyChanged}"
                                    Minimum="-999" />

                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Crop.Left}" />
                                <n:DoubleUpDown
                                    x:Name="LeftWatermarkDoubleUpDown"
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    MinWidth="70"
                                    Margin="10,3"
                                    Maximum="{Binding ElementName=EditorWindow, Path=FrameSize.Width, FallbackValue=1000, UpdateSourceTrigger=PropertyChanged}"
                                    Minimum="-999" />
                            </Grid>
                        </Grid>

                        <Grid
                            x:Name="BorderGrid"
                            Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="27" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <n:LabelSeparator
                                Grid.Row="0"
                                Text="{DynamicResource S.Border.Appearance}" />
                            <Grid
                                Grid.Row="1"
                                Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <!--<RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>-->
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Caption.Color}" />
                                <n:ColorBox
                                    x:Name="BorderColorBox"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    Margin="10,5"
                                    SelectedColor="{Binding BorderColor, Source={x:Static t:UserSettings.All}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Caption.Thickness}" />
                                <Grid
                                    Grid.Row="1"
                                    Grid.Column="1">
                                    <Grid.RowDefinitions>
                                        <RowDefinition />
                                        <RowDefinition />
                                        <RowDefinition />
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>

                                    <Grid
                                        Grid.Row="0"
                                        Grid.Column="0"
                                        Grid.ColumnSpan="4"
                                        HorizontalAlignment="Center">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>

                                        <Border
                                            Grid.Column="0"
                                            Width="15"
                                            Height="15"
                                            Background="{StaticResource Vector.Arrow.Blue.Top}"
                                            Opacity="{DynamicResource Element.Opacity}" />
                                        <n:IntegerUpDown
                                            x:Name="BorderTopThicknessNumericUpDown"
                                            Grid.Column="1"
                                            Width="55"
                                            Margin="3,5"
                                            Maximum="50"
                                            Minimum="-500"
                                            ValueChanged="BorderProperties_ValueChanged"
                                            Value="{Binding Source={x:Static t:UserSettings.All}, Path=BorderTopThickness, Mode=TwoWay}" />
                                    </Grid>

                                    <Border
                                        Grid.Row="1"
                                        Grid.Column="0"
                                        Width="15"
                                        Height="15"
                                        Margin="5,0,0,0"
                                        Background="{StaticResource Vector.Arrow.Blue.Left}"
                                        Opacity="{DynamicResource Element.Opacity}" />
                                    <n:IntegerUpDown
                                        x:Name="BorderLeftThicknessNumericUpDown"
                                        Grid.Row="1"
                                        Grid.Column="1"
                                        Width="55"
                                        Margin="3,5"
                                        Maximum="50"
                                        Minimum="-500"
                                        ValueChanged="BorderProperties_ValueChanged"
                                        Value="{Binding Source={x:Static t:UserSettings.All}, Path=BorderLeftThickness, Mode=TwoWay}" />

                                    <Border
                                        Grid.Row="1"
                                        Grid.Column="3"
                                        Width="15"
                                        Height="15"
                                        Background="{StaticResource Vector.Arrow.Blue.Right}"
                                        Opacity="{DynamicResource Element.Opacity}" />
                                    <n:IntegerUpDown
                                        x:Name="BorderRightThicknessNumericUpDown"
                                        Grid.Row="1"
                                        Grid.Column="2"
                                        Width="55"
                                        Margin="3,5"
                                        Maximum="50"
                                        Minimum="-500"
                                        ValueChanged="BorderProperties_ValueChanged"
                                        Value="{Binding Source={x:Static t:UserSettings.All}, Path=BorderRightThickness, Mode=TwoWay}" />

                                    <Grid
                                        Grid.Row="2"
                                        Grid.Column="0"
                                        Grid.ColumnSpan="4"
                                        HorizontalAlignment="Center">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>

                                        <Border
                                            Grid.Column="0"
                                            Width="15"
                                            Height="15"
                                            Background="{StaticResource Vector.Arrow.Blue.Bottom}"
                                            Opacity="{DynamicResource Element.Opacity}" />
                                        <n:IntegerUpDown
                                            x:Name="BorderBottomThicknessNumericUpDown"
                                            Grid.Column="1"
                                            Width="55"
                                            Margin="3,5"
                                            Maximum="50"
                                            Minimum="-500"
                                            ValueChanged="BorderProperties_ValueChanged"
                                            Value="{Binding Source={x:Static t:UserSettings.All}, Path=BorderBottomThickness, Mode=TwoWay}" />
                                    </Grid>
                                </Grid>

                                <!--<TextBlock Grid.Row="2" Grid.Column="0" Text="{DynamicResource S.Shadow.BackgroundColor}" VerticalAlignment="Center" Foreground="{DynamicResource Element.Foreground.Medium}"/>
                                <n:ColorBox Grid.Row="2" Grid.Column="1" x:Name="BorderBackgroundColorBox" Margin="10,5"
                                            SelectedColor="{Binding BorderBackgroundColor, Source={x:Static t:UserSettings.All}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

                                <TextBlock Grid.Row="3" Grid.Column="0" Text="{DynamicResource S.Border.CornerRadius}" VerticalAlignment="Center" Foreground="{DynamicResource Element.Foreground.Medium}"/>
                                <Grid Grid.Row="3" Grid.Column="1">
                                    <Grid.RowDefinitions>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition/>
                                    </Grid.ColumnDefinitions>

                                    <Grid Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="4" HorizontalAlignment="Center">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>

                                        <Viewbox Grid.Column="0" Child="{StaticResource Vector.Arrow.Blue.Top}" MaxWidth="15" MaxHeight="15" Opacity="{DynamicResource Element.Opacity}"/>
                                        <n:IntegerUpDown Grid.Column="1" x:Name="BorderTopRadiusNumericUpDown" Minimum="0" Maximum="1000" Margin="3,5" Width="55"
                                                         Value="{Binding Source={x:Static t:UserSettings.All}, Path=BorderTopRadius, Mode=TwoWay}" ValueChanged="BorderProperties_ValueChanged"/>
                                    </Grid>

                                    <Viewbox Grid.Row="1" Grid.Column="0" Child="{StaticResource Vector.Arrow.Blue.Left}" MaxWidth="15" MaxHeight="15" Margin="5,0,0,0" Opacity="{DynamicResource Element.Opacity}"/>
                                    <n:IntegerUpDown Grid.Row="1" Grid.Column="1" x:Name="BorderLeftRadiusNumericUpDown" Minimum="0" Maximum="1000" Margin="3,5" Width="55"
                                                     Value="{Binding Source={x:Static t:UserSettings.All}, Path=BorderLeftRadius, Mode=TwoWay}" ValueChanged="BorderProperties_ValueChanged"/>

                                    <Viewbox Grid.Row="1" Grid.Column="3" Child="{StaticResource Vector.Arrow.Blue.Right}" MaxWidth="15" MaxHeight="15" Opacity="{DynamicResource Element.Opacity}"/>
                                    <n:IntegerUpDown Grid.Row="1" Grid.Column="2" x:Name="BorderRightRadiusNumericUpDown" Minimum="0" Maximum="1000" Margin="3,5" Width="55"
                                                     Value="{Binding Source={x:Static t:UserSettings.All}, Path=BorderRightRadius, Mode=TwoWay}" ValueChanged="BorderProperties_ValueChanged"/>

                                    <Grid Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="4" HorizontalAlignment="Center">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>

                                        <Viewbox Grid.Column="0" Child="{StaticResource Vector.Arrow.Blue.Bottom}" MaxWidth="15" MaxHeight="15" Opacity="{DynamicResource Element.Opacity}"/>
                                        <n:IntegerUpDown Grid.Column="1" x:Name="BorderBottomRadiusNumericUpDown" Minimum="0" Maximum="1000" Margin="3,5" Width="55"
                                                         Value="{Binding Source={x:Static t:UserSettings.All}, Path=BorderBottomRadius, Mode=TwoWay}" ValueChanged="BorderProperties_ValueChanged"/>
                                    </Grid>
                                </Grid>-->
                            </Grid>

                            <Grid
                                Grid.Row="2"
                                Grid.Column="0"
                                Margin="10,10,5,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <Border
                                    Grid.Column="0"
                                    Width="15"
                                    Height="15"
                                    Background="{StaticResource Vector.Info}"
                                    Opacity="{DynamicResource Element.Opacity}" />
                                <TextBlock
                                    Grid.Column="1"
                                    Padding="3"
                                    FontSize="12"
                                    FontStyle="Italic"
                                    Foreground="{DynamicResource Element.Foreground.Detail}"
                                    Text="{DynamicResource S.Border.Info}"
                                    TextWrapping="WrapWithOverflow" />
                            </Grid>
                        </Grid>

                        <Grid
                            x:Name="ShadowGrid"
                            Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="27" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid.Resources>
                                <c:PercentageToOpacity x:Key="PercentageToOpacity" />
                            </Grid.Resources>

                            <n:LabelSeparator
                                Grid.Row="0"
                                Text="{DynamicResource S.Border.Appearance}" />
                            <Grid
                                Grid.Row="1"
                                Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Shadow.ShadowColor}" />
                                <n:ColorBox
                                    x:Name="ShadowColorBox"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    Margin="10,5"
                                    AllowTransparency="False"
                                    SelectedColor="{Binding Source={x:Static t:UserSettings.All}, Path=ShadowColor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Shadow.BackgroundColor}" />
                                <n:ColorBox
                                    x:Name="ShadowBackgroundColorBox"
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    Margin="10,5"
                                    AllowTransparency="False"
                                    SelectedColor="{Binding Source={x:Static t:UserSettings.All}, Path=ShadowBackgroundColor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                <TextBlock
                                    Grid.Row="2"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Shadow.BlurRadius}" />
                                <n:DoubleUpDown
                                    Grid.Row="2"
                                    Grid.Column="1"
                                    Margin="10,5"
                                    Maximum="100"
                                    Minimum="0"
                                    StepValue="0.5"
                                    ValueChanged="ShadowProperties_ValueChanged"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=ShadowBlurRadius, Mode=TwoWay}" />

                                <TextBlock
                                    Grid.Row="3"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Shadow.Direction}" />
                                <n:DoubleUpDown
                                    Grid.Row="3"
                                    Grid.Column="1"
                                    Margin="10,5"
                                    Maximum="360"
                                    Minimum="0"
                                    StepValue="0.5"
                                    ValueChanged="ShadowProperties_ValueChanged"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=ShadowDirection, Mode=TwoWay}" />

                                <TextBlock
                                    Grid.Row="4"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Watermark.Opacity}" />
                                <n:DoubleUpDown
                                    Grid.Row="4"
                                    Grid.Column="1"
                                    Margin="10,5"
                                    Maximum="100"
                                    Minimum="0"
                                    StepValue="0.5"
                                    ValueChanged="ShadowProperties_ValueChanged"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=ShadowOpacity, Converter={StaticResource PercentageToOpacity}, Mode=TwoWay}" />

                                <TextBlock
                                    Grid.Row="5"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Shadow.Depth}" />
                                <n:DoubleUpDown
                                    Grid.Row="5"
                                    Grid.Column="1"
                                    Margin="10,5"
                                    Maximum="100"
                                    Minimum="0"
                                    StepValue="0.5"
                                    ValueChanged="ShadowProperties_ValueChanged"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=ShadowDepth, Mode=TwoWay}" />
                            </Grid>
                        </Grid>

                        <Grid
                            x:Name="ObfuscateGrid"
                            Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <n:LabelSeparator
                                Grid.Row="0"
                                Text="{DynamicResource S.Progress.Type}" />
                            <Grid
                                Grid.Row="1"
                                Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <n:ExtendedRadioButton
                                    x:Name="PixelationRadioButton"
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    MinHeight="30"
                                    Margin="0,2"
                                    Padding="2"
                                    Icon="{StaticResource Vector.Pixelate}"
                                    IsChecked="{Binding ObfuscationMode, Source={x:Static t:UserSettings.All}, Converter={StaticResource EnumToBool}, ConverterParameter={x:Static e:ObfuscationModes.Pixelation}}"
                                    Text="{DynamicResource S.Obfuscate.Type.Pixelate}" />

                                <n:ExtendedRadioButton
                                    x:Name="BlurRadioButton"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinHeight="30"
                                    Margin="0,2"
                                    Padding="2"
                                    Icon="{StaticResource Vector.Blur}"
                                    IsChecked="{Binding ObfuscationMode, Source={x:Static t:UserSettings.All}, Converter={StaticResource EnumToBool}, ConverterParameter={x:Static e:ObfuscationModes.Blur}}"
                                    Text="{StaticResource S.Obfuscate.Type.Blur}" />

                                <n:ExtendedRadioButton
                                    x:Name="DarkenRadioButton"
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    MinHeight="30"
                                    Margin="0,2"
                                    Padding="2"
                                    Icon="{StaticResource Vector.Darken}"
                                    IsChecked="{Binding ObfuscationMode, Source={x:Static t:UserSettings.All}, Converter={StaticResource EnumToBool}, ConverterParameter={x:Static e:ObfuscationModes.Darken}}"
                                    Text="{StaticResource S.Obfuscate.Type.Darken}" />

                                <n:ExtendedRadioButton
                                    x:Name="LightenRadioButton"
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    MinHeight="30"
                                    Margin="0,2"
                                    Padding="2"
                                    Icon="{StaticResource Vector.Lighten}"
                                    IsChecked="{Binding ObfuscationMode, Source={x:Static t:UserSettings.All}, Converter={StaticResource EnumToBool}, ConverterParameter={x:Static e:ObfuscationModes.Lighten}}"
                                    Text="{StaticResource S.Obfuscate.Type.Lighten}" />
                            </Grid>

                            <n:LabelSeparator
                                Grid.Row="2"
                                Text="{DynamicResource S.Obfuscate.Options}" />
                            <Grid
                                Grid.Row="3"
                                Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Obfuscate.PixelSize}"
                                    Visibility="{Binding ElementName=PixelSizeIntegerUpDown, Path=Visibility}" />
                                <n:IntegerUpDown
                                    x:Name="PixelSizeIntegerUpDown"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinWidth="80"
                                    Margin="10,5"
                                    Maximum="100"
                                    Minimum="2"
                                    Visibility="{Binding ElementName=PixelationRadioButton, Path=IsChecked, Converter={StaticResource Bool2Visibility}}"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=PixelSize, Mode=TwoWay}" />

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Obfuscate.BlurLevel}"
                                    Visibility="{Binding ElementName=BlurSizeIntegerUpDown, Path=Visibility}" />
                                <n:IntegerUpDown
                                    x:Name="BlurSizeIntegerUpDown"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinWidth="80"
                                    Margin="10,5"
                                    Maximum="5"
                                    Minimum="2"
                                    Visibility="{Binding ElementName=BlurRadioButton, Path=IsChecked, Converter={StaticResource Bool2Visibility}}"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=BlurLevel, Mode=TwoWay}" />

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Obfuscate.DarkenLevel}"
                                    Visibility="{Binding ElementName=DarknessDoubleUpDown, Path=Visibility}" />
                                <n:DoubleUpDown
                                    x:Name="DarknessDoubleUpDown"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinWidth="80"
                                    Margin="10,5"
                                    Maximum="100"
                                    Minimum="2"
                                    Visibility="{Binding ElementName=DarkenRadioButton, Path=IsChecked, Converter={StaticResource Bool2Visibility}}"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=DarkenLevel, Mode=TwoWay}" />

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Obfuscate.LightenLevel}"
                                    Visibility="{Binding ElementName=LightnessDoubleUpDown, Path=Visibility}" />
                                <n:DoubleUpDown
                                    x:Name="LightnessDoubleUpDown"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinWidth="80"
                                    Margin="10,5"
                                    Maximum="100"
                                    Minimum="2"
                                    Visibility="{Binding ElementName=LightenRadioButton, Path=IsChecked, Converter={StaticResource Bool2Visibility}}"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=LightenLevel, Mode=TwoWay}" />


                                <n:ExtendedCheckBox
                                    x:Name="UseMedianCheckBox"
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    Grid.ColumnSpan="3"
                                    Margin="3,5"
                                    IsChecked="{Binding Source={x:Static t:UserSettings.All}, Path=UseMedian}"
                                    Text="{DynamicResource S.Obfuscate.UseAverage}"
                                    Visibility="{Binding ElementName=PixelationRadioButton, Path=IsChecked, Converter={StaticResource Bool2Visibility}}" />

                                <n:ExtendedCheckBox
                                    Grid.Row="2"
                                    Grid.Column="0"
                                    Grid.ColumnSpan="3"
                                    Margin="3,5"
                                    IsChecked="{Binding Source={x:Static t:UserSettings.All}, Path=ObfuscationInvertedSelection}"
                                    Text="{DynamicResource S.Obfuscate.Invert}" />
                            </Grid>

                            <n:LabelSeparator
                                Grid.Row="4"
                                Text="{DynamicResource S.Obfuscate.Smoothness}" />
                            <Grid
                                Grid.Row="5"
                                Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Shapes.Shapes.Radius}" />
                                <n:IntegerUpDown
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinWidth="80"
                                    Margin="10,5"
                                    Maximum="100"
                                    Minimum="0"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=ObfuscationSmoothnessRadius, Mode=TwoWay}" />
                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="2"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="px" />

                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Watermark.Opacity}" />
                                <n:DoubleUpDown
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    MinWidth="80"
                                    Margin="10,5"
                                    Maximum="100"
                                    Minimum="0"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=ObfuscationSmoothnessOpacity, Mode=TwoWay}" />
                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="2"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="%" />
                            </Grid>

                            <Grid
                                Grid.Row="6"
                                Grid.Column="0"
                                Margin="10,10,5,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <Border
                                    Grid.Column="0"
                                    Width="15"
                                    Height="15"
                                    Background="{StaticResource Vector.Info}"
                                    Opacity="{DynamicResource Element.Opacity}" />
                                <TextBlock
                                    Grid.Column="1"
                                    Padding="3"
                                    FontSize="12"
                                    FontStyle="Italic"
                                    Foreground="{DynamicResource Element.Foreground.Detail}"
                                    Text="{DynamicResource S.Obfuscate.Info}"
                                    TextWrapping="WrapWithOverflow"
                                    Visibility="{Binding Source={x:Static t:UserSettings.All}, Path=ObfuscationInvertedSelection, Converter={StaticResource InvertedBoolToVisibility}}" />

                                <TextBlock
                                    Grid.Column="1"
                                    Padding="3"
                                    FontSize="12"
                                    FontStyle="Italic"
                                    Foreground="{DynamicResource Element.Foreground.Detail}"
                                    Text="{DynamicResource S.Obfuscate.Info2}"
                                    TextWrapping="WrapWithOverflow"
                                    Visibility="{Binding Source={x:Static t:UserSettings.All}, Path=ObfuscationInvertedSelection, Converter={StaticResource Bool2Visibility}}" />
                            </Grid>
                        </Grid>

                        <Grid
                            x:Name="ProgressGrid"
                            Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="23" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="23" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="23" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <n:LabelSeparator
                                Grid.Row="0"
                                Text="{DynamicResource S.Progress.Type}" />
                            <Grid
                                Grid.Row="1"
                                Margin="10,0,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <n:ExtendedRadioButton
                                    x:Name="BarRadioButton"
                                    Grid.Column="0"
                                    MinHeight="30"
                                    Margin="0,2"
                                    Padding="2"
                                    Icon="{StaticResource Vector.Progress}"
                                    IsChecked="{Binding ProgressType, Source={x:Static t:UserSettings.All}, Converter={StaticResource EnumToBool}, ConverterParameter={x:Static e:ProgressTypes.Bar}}"
                                    Text="{DynamicResource S.Progress.Type.Bar}" />

                                <n:ExtendedRadioButton
                                    x:Name="TextRadioButton"
                                    Grid.Column="1"
                                    MinHeight="30"
                                    Margin="0,2"
                                    Padding="2"
                                    Icon="{StaticResource Vector.FreeText}"
                                    IsChecked="{Binding ProgressType, Source={x:Static t:UserSettings.All}, Converter={StaticResource EnumToBool}, ConverterParameter={x:Static e:ProgressTypes.Text}}"
                                    Text="{StaticResource S.Progress.Type.Text}" />
                            </Grid>

                            <Expander
                                Grid.Row="2"
                                Header="{DynamicResource S.Caption.Font}"
                                IsExpanded="{Binding IsProgressFontGroupExpanded, Source={x:Static t:UserSettings.All}}"
                                Visibility="{Binding IsChecked, ElementName=TextRadioButton, Converter={StaticResource Bool2Visibility}}">
                                <Grid Margin="10,0,0,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <TextBlock
                                        Grid.Row="0"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Family}" />
                                    <ComboBox
                                        x:Name="ProgressFontComboBox"
                                        Grid.Row="0"
                                        Grid.Column="1"
                                        MinWidth="100"
                                        MaxWidth="150"
                                        Margin="10,5"
                                        IsEditable="True"
                                        ItemTemplate="{DynamicResource FontTemplate}"
                                        SelectedItem="{Binding Source={x:Static t:UserSettings.All}, Path=ProgressFontFamily, Mode=TwoWay}">
                                        <ComboBox.ItemsSource>
                                            <Binding Source="{StaticResource MyFonts}" />
                                        </ComboBox.ItemsSource>

                                        <ComboBox.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <VirtualizingStackPanel
                                                    VirtualizingStackPanel.IsVirtualizing="True"
                                                    VirtualizingStackPanel.VirtualizationMode="Recycling" />
                                            </ItemsPanelTemplate>
                                        </ComboBox.ItemsPanel>
                                    </ComboBox>

                                    <TextBlock
                                        Grid.Row="1"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Style}" />
                                    <ComboBox
                                        x:Name="ProgressFontStyleComboBox"
                                        Grid.Row="1"
                                        Grid.Column="1"
                                        MinWidth="100"
                                        Margin="10,5"
                                        SelectedValue="{Binding Source={x:Static t:UserSettings.All}, Path=ProgressFontStyle, Mode=TwoWay}"
                                        SelectedValuePath="FontStyle">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <VirtualizingStackPanel
                                                    IsVirtualizing="True"
                                                    ScrollViewer.IsDeferredScrollingEnabled="True"
                                                    VirtualizationMode="Recycling">
                                                    <TextBlock
                                                        FontSize="14"
                                                        FontStyle="{Binding FontStyle}"
                                                        Text="{Binding Text}" />
                                                </VirtualizingStackPanel>
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>

                                        <TextBlock
                                            FontStyle="Normal"
                                            Text="{DynamicResource S.FontStyles.Normal}" />
                                        <TextBlock
                                            FontStyle="Italic"
                                            Text="{DynamicResource S.FontStyles.Italic}" />
                                        <TextBlock
                                            FontStyle="Oblique"
                                            Text="{DynamicResource S.FontStyles.Oblique}" />
                                    </ComboBox>

                                    <TextBlock
                                        Grid.Row="2"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Weight}" />
                                    <ComboBox
                                        x:Name="ProgressFontWeightComboBox"
                                        Grid.Row="2"
                                        Grid.Column="1"
                                        MinWidth="100"
                                        Margin="10,5"
                                        SelectedValue="{Binding Source={x:Static t:UserSettings.All}, Path=ProgressFontWeight, Mode=TwoWay}"
                                        SelectedValuePath="FontWeight">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <VirtualizingStackPanel
                                                    IsVirtualizing="True"
                                                    ScrollViewer.IsDeferredScrollingEnabled="True"
                                                    VirtualizationMode="Recycling">
                                                    <TextBlock
                                                        FontSize="14"
                                                        FontWeight="{Binding FontWeight}"
                                                        Text="{Binding Text}" />
                                                </VirtualizingStackPanel>
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>

                                        <TextBlock
                                            FontWeight="UltraLight"
                                            Text="{DynamicResource S.FontWeights.UltraLight}" />
                                        <TextBlock
                                            FontWeight="ExtraLight"
                                            Text="{DynamicResource S.FontWeights.ExtraLight}" />
                                        <TextBlock
                                            FontWeight="Light"
                                            Text="{DynamicResource S.FontWeights.Light}" />
                                        <TextBlock
                                            FontWeight="Thin"
                                            Text="{DynamicResource S.FontWeights.Thin}" />
                                        <TextBlock
                                            FontWeight="Normal"
                                            Text="{DynamicResource S.FontWeights.Normal}" />
                                        <TextBlock
                                            FontWeight="Regular"
                                            Text="{DynamicResource S.FontWeights.Regular}" />
                                        <TextBlock
                                            FontWeight="Medium"
                                            Text="{DynamicResource S.FontWeights.Medium}" />
                                        <TextBlock
                                            FontWeight="SemiBold"
                                            Text="{DynamicResource S.FontWeights.SemiBold}" />
                                        <TextBlock
                                            FontWeight="DemiBold"
                                            Text="{DynamicResource S.FontWeights.DemiBold}" />
                                        <TextBlock
                                            FontWeight="Bold"
                                            Text="{DynamicResource S.FontWeights.Bold}" />
                                        <TextBlock
                                            FontWeight="Black"
                                            Text="{DynamicResource S.FontWeights.Black}" />
                                        <TextBlock
                                            FontWeight="Heavy"
                                            Text="{DynamicResource S.FontWeights.Heavy}" />
                                        <TextBlock
                                            FontWeight="ExtraBold"
                                            Text="{DynamicResource S.FontWeights.ExtraBold}" />
                                        <TextBlock
                                            FontWeight="ExtraBlack"
                                            Text="{DynamicResource S.FontWeights.ExtraBlack}" />
                                        <TextBlock
                                            FontWeight="UltraBold"
                                            Text="{DynamicResource S.FontWeights.UltraBold}" />
                                        <TextBlock
                                            FontWeight="UltraBlack"
                                            Text="{DynamicResource S.FontWeights.UltraBlack}" />
                                    </ComboBox>

                                    <TextBlock
                                        Grid.Row="3"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Size}" />
                                    <n:IntegerUpDown
                                        x:Name="ProgressFontSizeNumericUpDown"
                                        Grid.Row="3"
                                        Grid.Column="1"
                                        MinWidth="70"
                                        Margin="10,5"
                                        Maximum="1000"
                                        Minimum="10"
                                        Value="{Binding Source={x:Static t:UserSettings.All}, Path=ProgressFontSize, Mode=TwoWay}" />

                                    <TextBlock
                                        Grid.Row="4"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Element.Foreground.Medium}"
                                        Text="{DynamicResource S.Caption.Color}" />
                                    <n:ColorBox
                                        Grid.Row="4"
                                        Grid.Column="1"
                                        Margin="10,5"
                                        SelectedColor="{Binding ProgressFontColor, Source={x:Static t:UserSettings.All}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                </Grid>
                            </Expander>

                            <n:LabelSeparator
                                Grid.Row="3"
                                Text="{DynamicResource S.Border.Appearance}" />
                            <Grid
                                Grid.Row="4"
                                Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Color}" />
                                <n:ColorBox
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    Margin="10,5"
                                    SelectedColor="{Binding ProgressColor, Source={x:Static t:UserSettings.All}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Progress.Precision}"
                                    Visibility="{Binding IsChecked, ElementName=TextRadioButton, Converter={StaticResource Bool2Visibility}}" />
                                <ComboBox
                                    x:Name="ProgressPrecisionComboBox"
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    MinWidth="100"
                                    MaxWidth="150"
                                    Margin="10,5"
                                    IsEditable="True"
                                    SelectedIndex="{Binding Source={x:Static t:UserSettings.All}, Path=ProgressPrecision, Mode=TwoWay}"
                                    SelectionChanged="ProgressPrecisionComboBox_SelectionChanged"
                                    Visibility="{Binding IsChecked, ElementName=TextRadioButton, Converter={StaticResource Bool2Visibility}}">
                                    <ComboBoxItem Content="{DynamicResource S.Progress.Precision.Minutes}" />
                                    <ComboBoxItem Content="{DynamicResource S.Progress.Precision.Seconds}" />
                                    <ComboBoxItem Content="{DynamicResource S.Progress.Precision.Milliseconds}" />
                                    <ComboBoxItem Content="{DynamicResource S.Progress.Precision.Percentage}" />
                                    <ComboBoxItem Content="{DynamicResource S.Progress.Precision.Count}" />
                                    <ComboBoxItem Content="{DynamicResource S.Progress.Precision.Custom}" />
                                    <ComboBoxItem Content="{DynamicResource S.Progress.Precision.DateOfRecording}" />
                                </ComboBox>

                                <n:ExtendedCheckBox
                                    Grid.Row="2"
                                    Grid.Column="1"
                                    Grid.ColumnSpan="2"
                                    Margin="10,5,5,5"
                                    CheckedChanged="ExtendedCheckBox_CheckedChanged"
                                    IsChecked="{Binding ProgressShowTotal, Source={x:Static t:UserSettings.All}, Mode=TwoWay}"
                                    Text="{DynamicResource S.Progress.Precision.ShowTotal}"
                                    Visibility="{Binding IsChecked, ElementName=TextRadioButton, Converter={StaticResource Bool2Visibility}}" />

                                <TextBlock
                                    x:Name="ProgressFormatTextBlock"
                                    Grid.Row="2"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Progress.Format}">
                                    <TextBlock.Visibility>
                                        <MultiBinding Converter="{StaticResource BoolAndToVisibility}">
                                            <Binding
                                                Converter="{StaticResource IntToBool}"
                                                ConverterParameter="5"
                                                ElementName="ProgressPrecisionComboBox"
                                                Path="SelectedIndex" />
                                            <Binding
                                                ElementName="TextRadioButton"
                                                Path="IsChecked" />
                                        </MultiBinding>
                                    </TextBlock.Visibility>
                                </TextBlock>
                                <n:ExtendedTextBox
                                    x:Name="CustomProgressTextBox"
                                    Grid.Row="2"
                                    Grid.Column="1"
                                    Grid.ColumnSpan="2"
                                    Margin="10,5"
                                    Text="{Binding Source={x:Static t:UserSettings.All}, Path=ProgressFormat, Mode=TwoWay}"
                                    TextChanged="CustomProgressTextBox_TextChanged"
                                    Visibility="{Binding ElementName=ProgressFormatTextBlock, Path=Visibility}">
                                    <n:ExtendedTextBox.ToolTip>
                                        <n:HeaderedTooltip
                                            Header="{DynamicResource S.Progress.Format.Header}"
                                            StaysOpen="True">
                                            <Run Text="{DynamicResource S.Progress.Format.Milliseconds}" />
                                            <LineBreak />
                                            <Run Text="{DynamicResource S.Progress.Format.Seconds}" />
                                            <LineBreak />
                                            <Run Text="{DynamicResource S.Progress.Format.Minutes}" />
                                            <LineBreak />
                                            <Run Text="{DynamicResource S.Progress.Format.Percentage}" />
                                            <LineBreak />
                                            <Run Text="{DynamicResource S.Progress.Format.FrameNumber}" />
                                            <LineBreak />
                                            <LineBreak />
                                            <Run
                                                FontWeight="SemiBold"
                                                Text="{DynamicResource S.Progress.Format.Totals}" />
                                            <LineBreak />
                                            <Run Text="@ms, @s, @m, @p, @f" />
                                            <LineBreak />
                                            <LineBreak />
                                            <Run
                                                FontWeight="SemiBold"
                                                Text="{DynamicResource S.Progress.Format.Examples}" />
                                            <LineBreak />
                                            <Run Text="'$s/@s s' = 2/10 s" />
                                            <LineBreak />
                                            <Run Text="'$p/@p%' = 25/100%" />
                                        </n:HeaderedTooltip>
                                    </n:ExtendedTextBox.ToolTip>
                                </n:ExtendedTextBox>

                                <TextBlock
                                    x:Name="ProgressStartNumberTextBlock"
                                    Grid.Row="3"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Progress.Precision.StartNumber}">
                                    <TextBlock.Visibility>
                                        <MultiBinding Converter="{StaticResource BoolAndOrOrToVisibility}">
                                            <Binding
                                                ElementName="TextRadioButton"
                                                Path="IsChecked" />
                                            <Binding
                                                Converter="{StaticResource IntToBool}"
                                                ConverterParameter="4"
                                                ElementName="ProgressPrecisionComboBox"
                                                Path="SelectedIndex" />
                                            <Binding
                                                Converter="{StaticResource IntToBool}"
                                                ConverterParameter="5"
                                                ElementName="ProgressPrecisionComboBox"
                                                Path="SelectedIndex" />
                                        </MultiBinding>
                                    </TextBlock.Visibility>
                                </TextBlock>
                                <n:IntegerUpDown
                                    x:Name="ProgressStartNumberIntegerUpDown"
                                    Grid.Row="3"
                                    Grid.Column="1"
                                    MinWidth="70"
                                    Margin="10,5"
                                    Maximum="1000"
                                    Minimum="0"
                                    ToolTip="{DynamicResource S.Progress.Precision.StartNumber.ToolTip}"
                                    ValueChanged="ExtendedCheckBox_CheckedChanged"
                                    Visibility="{Binding ElementName=ProgressStartNumberTextBlock, Path=Visibility}"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=ProgressStartNumber, Mode=TwoWay}" />

                                <TextBlock
                                    x:Name="ProgressDateFormatTextBlock"
                                    Grid.Row="4"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Progress.Format}">
                                    <TextBlock.Visibility>
                                        <MultiBinding Converter="{StaticResource BoolAndToVisibility}">
                                            <Binding
                                                Converter="{StaticResource IntToBool}"
                                                ConverterParameter="6"
                                                ElementName="ProgressPrecisionComboBox"
                                                Path="SelectedIndex" />
                                            <Binding
                                                ElementName="TextRadioButton"
                                                Path="IsChecked" />
                                        </MultiBinding>
                                    </TextBlock.Visibility>
                                </TextBlock>
                                <n:ExtendedTextBox
                                    x:Name="CustomProgressDateTextBox"
                                    Grid.Row="4"
                                    Grid.Column="1"
                                    Grid.ColumnSpan="2"
                                    Margin="10,5"
                                    Text="{Binding Source={x:Static t:UserSettings.All}, Path=ProgressDateFormat, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                    TextChanged="CustomProgressTextBox_TextChanged"
                                    ToolTip="{DynamicResource S.Progress.Format.Date}"
                                    Visibility="{Binding ElementName=ProgressDateFormatTextBlock, Path=Visibility}" />

                                <TextBlock
                                    Grid.Row="5"
                                    Grid.Column="0"
                                    Grid.ColumnSpan="3"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    ToolTip="docs.microsoft.com"
                                    Visibility="{Binding ElementName=ProgressDateFormatTextBlock, Path=Visibility}">

                                    <Hyperlink
                                        NavigateUri="https://docs.microsoft.com/en-us/dotnet/standard/base-types/standard-date-and-time-format-strings"
                                        RequestNavigate="Hyperlink_RequestNavigate">
                                        <Run Text="{DynamicResource S.Progress.Format.Date.Standard}" />
                                    </Hyperlink>
                                    <Run
                                        Foreground="{DynamicResource Element.Foreground}"
                                        Text="/" />
                                    <Hyperlink
                                        NavigateUri="https://docs.microsoft.com/en-us/dotnet/standard/base-types/custom-date-and-time-format-strings"
                                        RequestNavigate="Hyperlink_RequestNavigate">
                                        <Run Text="{DynamicResource S.Progress.Format.Date.Custom}" />
                                    </Hyperlink>
                                </TextBlock>

                                <TextBlock
                                    Grid.Row="3"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Caption.Thickness}"
                                    Visibility="{Binding IsChecked, ElementName=BarRadioButton, Converter={StaticResource Bool2Visibility}}" />
                                <n:IntegerUpDown
                                    x:Name="ProgressThicknessNumericUpDown"
                                    Grid.Row="3"
                                    Grid.Column="1"
                                    MinWidth="70"
                                    Margin="10,5"
                                    Maximum="30"
                                    Minimum="1"
                                    Visibility="{Binding IsChecked, ElementName=BarRadioButton, Converter={StaticResource Bool2Visibility}}"
                                    Value="{Binding ProgressThickness, Source={x:Static t:UserSettings.All}, Mode=TwoWay}" />
                            </Grid>

                            <n:LabelSeparator
                                Grid.Row="5"
                                Text="{DynamicResource S.Caption.Layout}" />
                            <Grid
                                Grid.Row="6"
                                Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Caption.Vertical}" />
                                <ComboBox
                                    x:Name="ProgressVerticalComboBox"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinWidth="100"
                                    MaxWidth="150"
                                    Margin="10,5"
                                    SelectedValue="{Binding Source={x:Static t:UserSettings.All}, Path=ProgressVerticalAligment, Mode=TwoWay}"
                                    SelectedValuePath="VerticalAlignment">

                                    <TextBlock
                                        VerticalAlignment="Top"
                                        Text="{DynamicResource S.VerticalAlignment.Top}" />
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        Text="{DynamicResource S.VerticalAlignment.Center}" />
                                    <TextBlock
                                        VerticalAlignment="Bottom"
                                        Text="{DynamicResource S.VerticalAlignment.Bottom}" />
                                </ComboBox>

                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Caption.Horizontal}" />
                                <ComboBox
                                    x:Name="ProgressHorizontalComboBox"
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    MinWidth="100"
                                    MaxWidth="150"
                                    Margin="10,5"
                                    SelectedValue="{Binding Source={x:Static t:UserSettings.All}, Path=ProgressHorizontalAligment, Mode=TwoWay}"
                                    SelectedValuePath="HorizontalAlignment">

                                    <TextBlock
                                        HorizontalAlignment="Left"
                                        Text="{DynamicResource S.HorizontalAlignment.Left}" />
                                    <TextBlock
                                        HorizontalAlignment="Center"
                                        Text="{DynamicResource S.HorizontalAlignment.Center}" />
                                    <TextBlock
                                        HorizontalAlignment="Right"
                                        Text="{DynamicResource S.HorizontalAlignment.Right}" />
                                </ComboBox>

                                <TextBlock
                                    Grid.Row="2"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Progress.Orientation}"
                                    Visibility="{Binding IsChecked, ElementName=BarRadioButton, Converter={StaticResource Bool2Visibility}}" />
                                <ComboBox
                                    x:Name="ProgressOrientationComboBox"
                                    Grid.Row="2"
                                    Grid.Column="1"
                                    MinWidth="100"
                                    MaxWidth="110"
                                    Margin="10,5"
                                    SelectedValue="{Binding Source={x:Static t:UserSettings.All}, Path=ProgressOrientation, Mode=TwoWay}"
                                    SelectedValuePath="Tag"
                                    Visibility="{Binding IsChecked, ElementName=BarRadioButton, Converter={StaticResource Bool2Visibility}}">

                                    <TextBlock Text="{DynamicResource S.Orientation.Horizontal}">
                                        <TextBlock.Tag>
                                            <x:Static Member="Orientation.Horizontal" />
                                        </TextBlock.Tag>
                                    </TextBlock>
                                    <TextBlock Text="{DynamicResource S.Orientation.Vertical}">
                                        <TextBlock.Tag>
                                            <x:Static Member="Orientation.Vertical" />
                                        </TextBlock.Tag>
                                    </TextBlock>
                                </ComboBox>
                            </Grid>
                        </Grid>

                        <Grid
                            x:Name="CinemagraphGrid"
                            Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <n:LabelSeparator
                                Grid.Row="0"
                                Text="{DynamicResource S.FreeDrawing.Mode}" />
                            <Grid
                                Grid.Row="1"
                                Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <n:ExtendedRadioButton
                                    x:Name="PenMode2RadioButton"
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    MinHeight="30"
                                    Margin="0,2"
                                    Padding="2"
                                    ContentHeight="20"
                                    ContentWidth="20"
                                    Cursor="Hand"
                                    Icon="{StaticResource Vector.Pen}"
                                    IsChecked="True"
                                    Text="{DynamicResource S.FreeDrawing.Pen}" />
                                <n:ExtendedRadioButton
                                    x:Name="EraserMode2RadioButton"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinHeight="30"
                                    Margin="0,2"
                                    Padding="2"
                                    ContentHeight="20"
                                    ContentWidth="20"
                                    Cursor="Hand"
                                    Icon="{StaticResource Vector.Eraser}"
                                    Text="{DynamicResource S.FreeDrawing.Eraser}" />

                                <n:ExtendedRadioButton
                                    x:Name="SelectorMode2RadioButton"
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    MinHeight="30"
                                    Margin="0,2"
                                    Padding="2"
                                    ContentHeight="20"
                                    ContentWidth="20"
                                    Cursor="Hand"
                                    Icon="{StaticResource Vector.Select}"
                                    Text="{DynamicResource S.FreeDrawing.Select}" />
                                <n:ExtendedRadioButton
                                    x:Name="EraserStrokeMode2RadioButton"
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    MinHeight="30"
                                    Margin="0,2"
                                    Padding="2"
                                    ContentHeight="20"
                                    ContentWidth="20"
                                    Cursor="Hand"
                                    Icon="{StaticResource Vector.StrokeEraser}"
                                    Text="{DynamicResource S.FreeDrawing.StrokeEraser}" />
                            </Grid>

                            <n:LabelSeparator
                                Grid.Row="2"
                                Text="{DynamicResource S.FreeDrawing.Pen}"
                                Visibility="{Binding ElementName=PenMode2RadioButton, Path=IsChecked, Converter={StaticResource Bool2Visibility}}" />
                            <Grid
                                Grid.Row="3"
                                Margin="10,0,0,0"
                                Visibility="{Binding ElementName=PenMode2RadioButton, Path=IsChecked, Converter={StaticResource Bool2Visibility}}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.FreeDrawing.Width}" />
                                <n:IntegerUpDown
                                    x:Name="CinemagraphWidthNumericUpDown"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinWidth="70"
                                    Margin="10,5"
                                    Maximum="100"
                                    Minimum="1"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=CinemagraphPenWidth, Mode=TwoWay}" />

                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.FreeDrawing.Height}" />
                                <n:IntegerUpDown
                                    x:Name="CinemagraphHeightNumericUpDown"
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    MinWidth="70"
                                    Margin="10,5"
                                    Maximum="100"
                                    Minimum="1"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=CinemagraphPenHeight, Mode=TwoWay}" />

                                <TextBlock
                                    Grid.Row="2"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.FreeDrawing.Tip}" />
                                <Grid
                                    Grid.Row="2"
                                    Grid.Column="1"
                                    Grid.ColumnSpan="2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>

                                    <n:ExtendedRadioButton
                                        x:Name="Rectangle2RadioButton"
                                        Grid.Row="0"
                                        Grid.Column="0"
                                        Margin="3,3"
                                        Padding="3"
                                        ContentHeight="20"
                                        ContentWidth="20"
                                        Cursor="Hand"
                                        Icon="{StaticResource Vector.Rectangle}"
                                        IsChecked="{Binding CinemagraphStylusTip, Source={x:Static t:UserSettings.All}, Converter={StaticResource StylusTipToBoolConverter}, ConverterParameter=Rectangle}"
                                        Text="{DynamicResource S.FreeDrawing.Rectangle}" />
                                    <n:ExtendedRadioButton
                                        x:Name="Ellipse2RadioButton"
                                        Grid.Row="0"
                                        Grid.Column="1"
                                        Margin="0,3"
                                        Padding="3"
                                        ContentHeight="20"
                                        ContentWidth="20"
                                        Cursor="Hand"
                                        Icon="{StaticResource Vector.Ellipse}"
                                        IsChecked="{Binding CinemagraphStylusTip, Source={x:Static t:UserSettings.All}, Converter={StaticResource StylusTipToBoolConverter}, ConverterParameter=Ellipse}"
                                        Text="{DynamicResource S.FreeDrawing.Ellipse}" />
                                </Grid>

                                <TextBlock
                                    Grid.Row="3"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.FreeDrawing.Other}" />
                                <n:ExtendedCheckBox
                                    x:Name="FitToCurve2CheckBox"
                                    Grid.Row="3"
                                    Grid.Column="1"
                                    Grid.ColumnSpan="2"
                                    Margin="5"
                                    IsChecked="{Binding Source={x:Static t:UserSettings.All}, Path=CinemagraphFitToCurve, Mode=TwoWay}"
                                    Text="{DynamicResource S.FreeDrawing.FitToCurve}" />
                            </Grid>

                            <n:LabelSeparator
                                Grid.Row="2"
                                Text="{DynamicResource S.FreeDrawing.Eraser}"
                                Visibility="{Binding ElementName=EraserMode2RadioButton, Path=IsChecked, Converter={StaticResource Bool2Visibility}}" />
                            <Grid
                                Grid.Row="3"
                                Margin="10,0,0,0"
                                Visibility="{Binding ElementName=EraserMode2RadioButton, Path=IsChecked, Converter={StaticResource Bool2Visibility}}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.FreeDrawing.Width}" />
                                <n:IntegerUpDown
                                    x:Name="CinemagraphEraserWidthNumericUpDown"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinWidth="70"
                                    Margin="10,5"
                                    Maximum="100"
                                    Minimum="1"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=CinemagraphEraserWidth, Mode=TwoWay}" />

                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.FreeDrawing.Height}" />
                                <n:IntegerUpDown
                                    x:Name="CinemagraphEraserHeightNumericUpDown"
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    MinWidth="70"
                                    Margin="10,5"
                                    Maximum="100"
                                    Minimum="1"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=CinemagraphEraserHeight, Mode=TwoWay}" />

                                <TextBlock
                                    Grid.Row="2"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.FreeDrawing.Tip}" />
                                <Grid
                                    Grid.Row="2"
                                    Grid.Column="1"
                                    Grid.ColumnSpan="2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>

                                    <n:ExtendedRadioButton
                                        x:Name="RectangleEraser2RadioButton"
                                        Grid.Row="0"
                                        Grid.Column="0"
                                        Margin="3,3"
                                        Padding="3"
                                        ContentHeight="20"
                                        ContentWidth="20"
                                        Cursor="Hand"
                                        Icon="{StaticResource Vector.Rectangle}"
                                        IsChecked="{Binding CinemagraphEraserStylusTip, Source={x:Static t:UserSettings.All}, Converter={StaticResource StylusTipToBoolConverter}, ConverterParameter=Rectangle}"
                                        Text="{DynamicResource S.FreeDrawing.Rectangle}" />
                                    <n:ExtendedRadioButton
                                        x:Name="ElipseEraser2RadioButton"
                                        Grid.Row="0"
                                        Grid.Column="1"
                                        Margin="0,3"
                                        Padding="3"
                                        ContentHeight="20"
                                        ContentWidth="20"
                                        Cursor="Hand"
                                        Icon="{StaticResource Vector.Ellipse}"
                                        IsChecked="{Binding CinemagraphEraserStylusTip, Source={x:Static t:UserSettings.All}, Converter={StaticResource StylusTipToBoolConverter}, ConverterParameter=Ellipse}"
                                        Text="{DynamicResource S.FreeDrawing.Ellipse}" />
                                </Grid>
                            </Grid>

                            <Grid
                                Grid.Row="4"
                                Grid.Column="0"
                                Margin="10,10,5,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <Border
                                    Grid.Column="0"
                                    Width="15"
                                    Height="15"
                                    Background="{StaticResource Vector.Info}"
                                    Opacity="{DynamicResource Element.Opacity}" />
                                <TextBlock
                                    Grid.Column="1"
                                    Padding="3"
                                    FontSize="12"
                                    FontStyle="Italic"
                                    Foreground="{DynamicResource Element.Foreground.Detail}"
                                    Text="{DynamicResource S.Cinemagraph.Info}"
                                    TextWrapping="WrapWithOverflow" />
                            </Grid>
                        </Grid>

                        <Grid
                            x:Name="OverrideDelayGrid"
                            Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="27" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <n:LabelSeparator
                                Grid.Row="0"
                                Text="{DynamicResource S.Delay.NewValue}" />
                            <Grid
                                Grid.Row="1"
                                Margin="10,0,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.DelayMs}" />
                                <n:IntegerUpDown
                                    x:Name="NewDelayIntegerUpDown"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinWidth="80"
                                    Margin="10,5"
                                    Maximum="25500"
                                    Minimum="10"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=OverrideDelay, Mode=TwoWay}" />
                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="2"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="ms" />
                            </Grid>

                            <Grid
                                Grid.Row="2"
                                Grid.Column="0"
                                Margin="10,10,5,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <Border
                                    Grid.Column="0"
                                    Width="15"
                                    Height="15"
                                    Background="{StaticResource Vector.Info}"
                                    Opacity="{DynamicResource Element.Opacity}" />
                                <TextBlock
                                    Grid.Column="1"
                                    Padding="3"
                                    FontSize="12"
                                    FontStyle="Italic"
                                    Foreground="{DynamicResource Element.Foreground.Detail}"
                                    Text="{DynamicResource S.Delay.Override.Info}"
                                    TextWrapping="WrapWithOverflow" />
                            </Grid>
                        </Grid>

                        <Grid
                            x:Name="IncreaseDecreaseDelayGrid"
                            Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="27" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <n:LabelSeparator
                                Grid.Row="0"
                                Text="{DynamicResource S.Delay.DecreaseIncrease}" />
                            <Grid
                                Grid.Row="1"
                                Margin="10,0,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.ValueMs}" />
                                <n:IntegerUpDown
                                    x:Name="IncreaseDecreaseDelayIntegerUpDown"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinWidth="80"
                                    Margin="10,5"
                                    Maximum="10000"
                                    Minimum="-10000"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=IncrementDecrementDelay, Mode=TwoWay}" />
                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="2"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="ms" />
                            </Grid>

                            <Grid
                                Grid.Row="2"
                                Grid.Column="0"
                                Margin="10,10,5,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <Border
                                    Grid.Column="0"
                                    Width="15"
                                    Height="15"
                                    Background="{StaticResource Vector.Info}"
                                    Opacity="{DynamicResource Element.Opacity}" />
                                <TextBlock
                                    Grid.Column="1"
                                    Padding="3"
                                    FontSize="12"
                                    FontStyle="Italic"
                                    Foreground="{DynamicResource Element.Foreground.Detail}"
                                    Text="{DynamicResource S.Delay.IncreaseDecrease.Info}"
                                    TextWrapping="WrapWithOverflow" />
                            </Grid>
                        </Grid>

                        <Grid
                            x:Name="ScaleDelayGrid"
                            Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="27" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <n:LabelSeparator
                                Grid.Row="0"
                                Text="{DynamicResource S.Delay.Scale}" />
                            <Grid
                                Grid.Row="1"
                                Margin="10,0,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.ScaleValue}" />
                                <n:IntegerUpDown
                                    x:Name="ScaleDelayIntegerUpDown"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinWidth="80"
                                    Margin="10,5"
                                    Maximum="1000"
                                    Minimum="1"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=ScaleDelay, Mode=TwoWay}" />
                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="2"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="%" />
                            </Grid>

                            <Grid
                                Grid.Row="2"
                                Grid.Column="0"
                                Margin="10,10,5,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <Border
                                    Grid.Column="0"
                                    Width="15"
                                    Height="15"
                                    Background="{StaticResource Vector.Info}"
                                    Opacity="{DynamicResource Element.Opacity}" />
                                <TextBlock
                                    Grid.Column="1"
                                    Padding="3"
                                    FontSize="12"
                                    FontStyle="Italic"
                                    Foreground="{DynamicResource Element.Foreground.Detail}"
                                    Text="{DynamicResource S.Delay.Scale.Info}"
                                    TextWrapping="WrapWithOverflow" />
                            </Grid>
                        </Grid>

                        <Grid
                            x:Name="FadeGrid"
                            Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <n:LabelSeparator
                                Grid.Row="0"
                                Text="{DynamicResource S.Transitions.FadeTo}" />
                            <Grid
                                Grid.Row="1"
                                Margin="10,0,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <n:ExtendedRadioButton
                                    x:Name="FadeToFrameRadioButton"
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    MinHeight="30"
                                    Margin="0,2"
                                    Padding="2"
                                    ContentHeight="20"
                                    ContentWidth="20"
                                    Cursor="Hand"
                                    Icon="{StaticResource Vector.Image}"
                                    IsChecked="{Binding FadeToType, Source={x:Static t:UserSettings.All}, Converter={StaticResource EnumToBool}, ConverterParameter={x:Static e:FadeModes.NextFrame}}"
                                    Text="{DynamicResource S.Transitions.FadeTo.Frame}" />

                                <n:ExtendedRadioButton
                                    x:Name="FadeToColorRadioButton"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinHeight="30"
                                    Margin="0,2"
                                    Padding="2"
                                    ContentHeight="20"
                                    ContentWidth="20"
                                    Cursor="Hand"
                                    Icon="{StaticResource Vector.Colors}"
                                    IsChecked="{Binding FadeToType, Source={x:Static t:UserSettings.All}, Converter={StaticResource EnumToBool}, ConverterParameter={x:Static e:FadeModes.Color}}"
                                    Text="{DynamicResource S.Transitions.FadeTo.Color}" />
                            </Grid>

                            <n:LabelSeparator
                                Grid.Row="2"
                                Text="{DynamicResource S.Transitions.Color}"
                                Visibility="{Binding ElementName=FadeToColorRadioButton, Path=IsChecked, Converter={StaticResource Bool2Visibility}}" />
                            <Grid
                                Grid.Row="3"
                                Margin="10,0,0,0"
                                Visibility="{Binding ElementName=FadeToColorRadioButton, Path=IsChecked, Converter={StaticResource Bool2Visibility}}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Caption.Color}" />
                                <n:ColorBox
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    Margin="10,5"
                                    SelectedColor="{Binding FadeToColor, Source={x:Static t:UserSettings.All}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                            </Grid>

                            <n:LabelSeparator
                                Grid.Row="4"
                                Text="{DynamicResource S.Transitions.Length}" />
                            <Slider
                                x:Name="FadeSlider"
                                Grid.Row="5"
                                Grid.Column="0"
                                Margin="10,5,5,5"
                                AutoToolTipPlacement="TopLeft"
                                IsSnapToTickEnabled="True"
                                Maximum="25"
                                Minimum="1"
                                SmallChange="1"
                                Value="{Binding Source={x:Static t:UserSettings.All}, Path=FadeTransitionLength, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                            <n:LabelSeparator
                                Grid.Row="6"
                                Text="{DynamicResource S.Transitions.Delay}" />
                            <Grid
                                Grid.Row="7"
                                Margin="10,0,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.DelayMs}" />
                                <n:IntegerUpDown
                                    x:Name="FadeDelayIntegerUpDown"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinWidth="80"
                                    Margin="10,5"
                                    Maximum="25500"
                                    Minimum="10"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=FadeTransitionDelay, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                            </Grid>

                            <Grid
                                Grid.Row="8"
                                Margin="5,3">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <Image
                                    x:Name="TransitionImage"
                                    Grid.Row="0"
                                    Grid.RowSpan="2"
                                    Grid.Column="0"
                                    Effect="{StaticResource Shadow.Border.Large}"
                                    Source="{Binding Path=ImageSource, Converter={StaticResource UriToBitmapConverter}}"
                                    Stretch="Uniform">
                                    <Image.Style>
                                        <Style TargetType="FrameworkElement">
                                            <Style.Triggers>
                                                <DataTrigger
                                                    Binding="{Binding ElementName=FadeGrid, Path=Visibility}"
                                                    Value="Visible">
                                                    <Setter Property="DataContext" Value="{Binding ElementName=ZoomBoxControl}" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                            <Style.Setters>
                                                <Setter Property="DataContext" Value="{x:Null}" />
                                            </Style.Setters>
                                        </Style>
                                    </Image.Style>
                                </Image>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    Padding="2,0"
                                    VerticalAlignment="Center"
                                    FontSize="16"
                                    Foreground="{DynamicResource Element.Foreground.Detail}"
                                    Text="{Binding ElementName=FadeSlider, Path=Value, StringFormat='{} {0}x'}" />

                                <Border
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    Width="13"
                                    Height="15"
                                    Background="{StaticResource Vector.Arrow.Blue.Right}"
                                    Opacity="{DynamicResource Element.Opacity}" />

                                <Border
                                    Grid.Row="0"
                                    Grid.RowSpan="2"
                                    Grid.Column="2"
                                    Width="{Binding ElementName=TransitionImage, Path=ActualWidth, Mode=OneWay}"
                                    Height="{Binding ElementName=TransitionImage, Path=ActualHeight, Mode=OneWay}"
                                    Background="{Binding FadeToColor, Source={x:Static t:UserSettings.All}, Converter={StaticResourceExtension ColorToBrush}}"
                                    BorderThickness="0"
                                    Effect="{StaticResource Shadow.Border.Large}"
                                    Visibility="{Binding ElementName=FadeToColorRadioButton, Path=IsChecked, Converter={StaticResource Bool2Visibility}}" />

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.RowSpan="2"
                                    Grid.Column="2"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Transitions.FadeTo.Frame}"
                                    Visibility="{Binding ElementName=FadeToFrameRadioButton, Path=IsChecked, Converter={StaticResource Bool2Visibility}}" />
                            </Grid>

                            <Grid
                                Grid.Row="9"
                                Grid.Column="0"
                                Margin="10,10,5,0"
                                Visibility="{Binding ElementName=FadeToFrameRadioButton, Path=IsChecked, Converter={StaticResource Bool2Visibility}}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <Border
                                    Grid.Column="0"
                                    Width="15"
                                    Height="15"
                                    Background="{StaticResource Vector.Info}"
                                    Opacity="{DynamicResource Element.Opacity}" />
                                <TextBlock
                                    Grid.Column="1"
                                    Padding="3"
                                    FontSize="12"
                                    FontStyle="Italic"
                                    Foreground="{DynamicResource Element.Foreground.Detail}"
                                    Text="{DynamicResource S.Transitions.Info}"
                                    TextWrapping="WrapWithOverflow" />
                            </Grid>
                        </Grid>

                        <Grid
                            x:Name="SlideGrid"
                            Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <n:LabelSeparator
                                Grid.Row="0"
                                Text="{DynamicResource S.Transitions.Length}" />
                            <Slider
                                x:Name="SlideSlider"
                                Grid.Row="1"
                                Grid.Column="0"
                                Margin="10,5,5,5"
                                AutoToolTipPlacement="TopLeft"
                                IsSnapToTickEnabled="True"
                                Maximum="20"
                                Minimum="1"
                                SmallChange="1" />

                            <n:LabelSeparator
                                Grid.Row="2"
                                Text="{DynamicResource S.Transitions.Delay}" />
                            <Grid
                                Grid.Row="3"
                                Margin="10,0,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.DelayMs}" />
                                <n:IntegerUpDown
                                    x:Name="SlideDelayIntegerUpDown"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinWidth="80"
                                    Margin="10,5"
                                    Maximum="25500"
                                    Minimum="10"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=SlideTransitionDelay, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                            </Grid>

                            <Grid
                                Grid.Row="4"
                                Margin="5,3">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <Image
                                    x:Name="TransitionImage2"
                                    Grid.Row="0"
                                    Grid.RowSpan="2"
                                    Grid.Column="0"
                                    Effect="{StaticResource Shadow.Border.Large}"
                                    Source="{Binding Path=ImageSource, Converter={StaticResource UriToBitmapConverter}}"
                                    Stretch="Uniform">
                                    <Image.Style>
                                        <Style TargetType="FrameworkElement">
                                            <Style.Triggers>
                                                <DataTrigger
                                                    Binding="{Binding ElementName=SlideGrid, Path=Visibility}"
                                                    Value="Visible">
                                                    <Setter Property="DataContext" Value="{Binding ElementName=ZoomBoxControl}" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                            <Style.Setters>
                                                <Setter Property="DataContext" Value="{x:Null}" />
                                            </Style.Setters>
                                        </Style>
                                    </Image.Style>
                                </Image>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    Padding="2,0"
                                    VerticalAlignment="Center"
                                    FontSize="16"
                                    Foreground="{DynamicResource Element.Foreground.Detail}"
                                    Text="{Binding ElementName=SlideSlider, Path=Value, StringFormat='{} {0}x'}" />

                                <Border
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    Width="13"
                                    Height="15"
                                    Background="{StaticResource Vector.Arrow.Blue.Right}"
                                    Opacity="{DynamicResource Element.Opacity}" />

                                <Border
                                    Grid.Row="0"
                                    Grid.RowSpan="2"
                                    Grid.Column="2"
                                    Width="{Binding ElementName=TransitionImage, Path=ActualWidth, Mode=OneWay}"
                                    Height="{Binding ElementName=TransitionImage, Path=ActualHeight, Mode=OneWay}"
                                    BorderThickness="0"
                                    Effect="{StaticResource Shadow.Border.Large}"
                                    Visibility="{Binding ElementName=FadeToColorRadioButton, Path=IsChecked, Converter={StaticResource Bool2Visibility}}" />

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.RowSpan="2"
                                    Grid.Column="2"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Transitions.FadeTo.Frame}" />
                            </Grid>

                            <!--<Grid Grid.Row="2" Visibility="Visible">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition/>
                                    <ColumnDefinition/>
                                    <ColumnDefinition/>
                                </Grid.ColumnDefinitions>

                                <n:ExtendedRadioButton Grid.Column="0" x:Name="FromRightRadioButton" Icon="{StaticResource Vector.Info}"
                                                       Cursor="Hand" MaxSize="20" Margin="0,3" Padding="0,5" IsChecked="True"/>

                                <n:ExtendedRadioButton Grid.Column="1" x:Name="FromTopRadioButton" Icon="{StaticResource Vector.Info}"
                                                       Cursor="Hand" MaxSize="20" Margin="0,3" Padding="0,5"/>

                                <n:ExtendedRadioButton Grid.Column="2" x:Name="FromLeftRadioButton" Icon="{StaticResource Vector.Info}"
                                                       Cursor="Hand" MaxSize="20" Margin="0,3" Padding="0,5"/>

                                <n:ExtendedRadioButton Grid.Column="3" x:Name="FromBottomRadioButton" Icon="{StaticResource Vector.Info}"
                                                       Cursor="Hand" MaxSize="20" Margin="0,3" Padding="0,5"/>
                            </Grid>-->

                            <Grid
                                Grid.Row="5"
                                Margin="10,10,5,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <Border
                                    Grid.Column="0"
                                    Width="15"
                                    Height="15"
                                    Background="{StaticResource Vector.Info}"
                                    Opacity="{DynamicResource Element.Opacity}" />
                                <TextBlock
                                    Grid.Column="1"
                                    Padding="3"
                                    FontSize="12"
                                    FontStyle="Italic"
                                    Foreground="{DynamicResource Element.Foreground.Detail}"
                                    Text="{DynamicResource S.Transitions.Info}"
                                    TextWrapping="WrapWithOverflow" />
                            </Grid>
                        </Grid>

                        <Grid
                            x:Name="ReduceGrid"
                            Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="27" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <n:LabelSeparator
                                Grid.Row="0"
                                Text="{DynamicResource S.Reduce.Header}" />
                            <Grid
                                Grid.Row="1"
                                Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Reduce.Factor}" />
                                <n:IntegerUpDown
                                    x:Name="ReduceFactorIntegerUpDown"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinWidth="80"
                                    Margin="10,5"
                                    Maximum="20"
                                    Minimum="1"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=ReduceFactor, Mode=TwoWay}" />

                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Reduce.Count}" />
                                <n:IntegerUpDown
                                    x:Name="ReduceCountIntegerUpDown"
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    MinWidth="80"
                                    Margin="10,5"
                                    Maximum="20"
                                    Minimum="1"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=ReduceCount, Mode=TwoWay}" />

                                <TextBlock
                                    Grid.Row="2"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.Reduce.Delay}" />
                                <ComboBox
                                    Grid.Row="2"
                                    Grid.Column="1"
                                    Grid.ColumnSpan="2"
                                    Margin="10,5"
                                    SelectedIndex="{Binding Source={x:Static t:UserSettings.All}, Path=ReduceDelay, Converter={StaticResource EnumToInt}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                    <ComboBoxItem Content="{DynamicResource S.Reduce.Delay.NoAdjustment}" />
                                    <ComboBoxItem Content="{DynamicResource S.Reduce.Delay.Previous}" />
                                    <ComboBoxItem Content="{DynamicResource S.Reduce.Delay.Evenly}" />
                                </ComboBox>

                                <n:ExtendedCheckBox
                                    Grid.Row="3"
                                    Grid.Column="0"
                                    Grid.ColumnSpan="3"
                                    Margin="0,5"
                                    IsChecked="{Binding Source={x:Static t:UserSettings.All}, Path=ReduceApplyToAll, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                    Text="{DynamicResource S.Reduce.ApplyToAll}"
                                    ToolTip="{DynamicResource S.Reduce.ApplyToAll.Info}" />
                            </Grid>

                            <Grid
                                Grid.Row="2"
                                Grid.Column="0"
                                Margin="10,10,5,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <Border
                                    Grid.Column="0"
                                    Width="15"
                                    Height="15"
                                    Background="{StaticResource Vector.Info}"
                                    Opacity="{DynamicResource Element.Opacity}" />
                                <TextBlock
                                    x:Name="ReduceTextBlock"
                                    Grid.Column="1"
                                    Padding="3"
                                    FontSize="12"
                                    FontStyle="Italic"
                                    Foreground="{DynamicResource Element.Foreground.Detail}"
                                    Tag="{DynamicResource S.Reduce.Info}"
                                    TextWrapping="WrapWithOverflow">
                                    <TextBlock.Text>
                                        <MultiBinding Converter="{StaticResource FormatConverter}">
                                            <Binding
                                                ElementName="ReduceTextBlock"
                                                Path="Tag" />
                                            <Binding
                                                Path="ReduceCount"
                                                Source="{x:Static t:UserSettings.All}" />
                                            <Binding
                                                Path="ReduceFactor"
                                                Source="{x:Static t:UserSettings.All}" />
                                        </MultiBinding>
                                    </TextBlock.Text>
                                </TextBlock>
                            </Grid>
                        </Grid>

                        <Grid
                            x:Name="RemoveDuplicatesGrid"
                            Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="27" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <n:LabelSeparator
                                Grid.Row="0"
                                Text="{DynamicResource S.RemoveDuplicates.Header}" />
                            <Grid
                                Grid.Row="1"
                                Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.RemoveDuplicates.Similarity}" />
                                <n:DoubleUpDown
                                    x:Name="DuplicatesSimilarityDoubleUpDown"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinWidth="80"
                                    Margin="10,5"
                                    Maximum="100"
                                    Minimum="0.1"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=DuplicatesSimilarity, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.RemoveDuplicates.Removal}" />
                                <ComboBox
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    Grid.ColumnSpan="2"
                                    Margin="10,5"
                                    SelectedIndex="{Binding Source={x:Static t:UserSettings.All}, Path=DuplicatesRemoval, Converter={StaticResource EnumToInt}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                    <ComboBoxItem Content="{DynamicResource S.RemoveDuplicates.Removal.First}" />
                                    <ComboBoxItem Content="{DynamicResource S.RemoveDuplicates.Removal.Last}" />
                                </ComboBox>

                                <TextBlock
                                    Grid.Row="2"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.RemoveDuplicates.Delay}" />
                                <ComboBox
                                    Grid.Row="2"
                                    Grid.Column="1"
                                    Grid.ColumnSpan="2"
                                    Margin="10,5"
                                    SelectedIndex="{Binding Source={x:Static t:UserSettings.All}, Path=DuplicatesDelay, Converter={StaticResource EnumToInt}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                    <ComboBoxItem Content="{DynamicResource S.RemoveDuplicates.Delay.NoAdjustment}" />
                                    <ComboBoxItem Content="{DynamicResource S.RemoveDuplicates.Delay.Average}" />
                                    <ComboBoxItem Content="{DynamicResource S.RemoveDuplicates.Delay.Sum}" />
                                </ComboBox>
                            </Grid>

                            <Grid
                                Grid.Row="2"
                                Grid.Column="0"
                                Margin="10,10,5,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <Border
                                    Grid.Column="0"
                                    Width="15"
                                    Height="15"
                                    Background="{StaticResource Vector.Info}"
                                    Opacity="{DynamicResource Element.Opacity}" />
                                <TextBlock
                                    x:Name="DuplicatesTextBlock"
                                    Grid.Column="1"
                                    Padding="3"
                                    FontSize="12"
                                    FontStyle="Italic"
                                    Foreground="{DynamicResource Element.Foreground.Detail}"
                                    Tag="{DynamicResource S.RemoveDuplicates.Info}"
                                    TextWrapping="WrapWithOverflow">
                                    <TextBlock.Text>
                                        <MultiBinding Converter="{StaticResource FormatConverter}">
                                            <Binding
                                                ElementName="DuplicatesTextBlock"
                                                Path="Tag" />
                                            <Binding
                                                Path="DuplicatesSimilarity"
                                                Source="{x:Static t:UserSettings.All}" />
                                        </MultiBinding>
                                    </TextBlock.Text>
                                </TextBlock>
                            </Grid>
                        </Grid>

                        <Grid
                            x:Name="SmoothLoopGrid"
                            Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="27" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <n:LabelSeparator
                                Grid.Row="0"
                                Text="{DynamicResource S.SmoothLoop.Header}" />
                            <Grid
                                Grid.Row="1"
                                Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.RemoveDuplicates.Similarity}" />
                                <n:DoubleUpDown
                                    x:Name="SmoothLoopSimilarityDoubleUpDown"
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    MinWidth="80"
                                    Margin="10,5"
                                    Maximum="100"
                                    Minimum="0.1"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=SmoothLoopSimilarity, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.SmoothLoop.StartThreshold}" />
                                <n:IntegerUpDown
                                    x:Name="SmoothLoopThresholdDoubleUpDown"
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    MinWidth="80"
                                    Margin="10,5"
                                    Minimum="1"
                                    Value="{Binding Source={x:Static t:UserSettings.All}, Path=SmoothLoopStartThreshold, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                <TextBlock
                                    Grid.Row="2"
                                    Grid.Column="0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource Element.Foreground.Medium}"
                                    Text="{DynamicResource S.SmoothLoop.From}" />
                                <ComboBox
                                    Grid.Row="2"
                                    Grid.Column="1"
                                    Grid.ColumnSpan="2"
                                    Margin="10,5"
                                    SelectedIndex="{Binding Source={x:Static t:UserSettings.All}, Path=SmoothLoopFrom, Converter={StaticResource EnumToInt}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                    <ComboBoxItem Content="{DynamicResource S.SmoothLoop.From.Last}" />
                                    <ComboBoxItem Content="{DynamicResource S.SmoothLoop.From.First}" />
                                </ComboBox>
                            </Grid>

                            <Grid
                                Grid.Row="2"
                                Grid.Column="0"
                                Margin="10,10,5,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <Border
                                    Grid.Column="0"
                                    Width="15"
                                    Height="15"
                                    Background="{StaticResource Vector.Info}"
                                    Opacity="{DynamicResource Element.Opacity}" />
                                <TextBlock
                                    x:Name="SmoothLoopTextBlock"
                                    Grid.Column="1"
                                    Padding="3"
                                    FontSize="12"
                                    FontStyle="Italic"
                                    Foreground="{DynamicResource Element.Foreground.Detail}"
                                    Tag="{DynamicResource S.SmoothLoop.Info}"
                                    TextWrapping="WrapWithOverflow">
                                    <TextBlock.Text>
                                        <MultiBinding Converter="{StaticResource FormatConverter}">
                                            <Binding
                                                ElementName="SmoothLoopTextBlock"
                                                Path="Tag" />
                                            <Binding
                                                Path="SmoothLoopSimilarity"
                                                Source="{x:Static t:UserSettings.All}" />
                                        </MultiBinding>
                                    </TextBlock.Text>
                                </TextBlock>
                            </Grid>
                        </Grid>
                    </Grid>
                </ScrollViewer>

                <!--  Apply/Save or Cancel  -->
                <Grid
                    x:Name="ActionLowerGrid"
                    Grid.Row="2"
                    Height="44"
                    Background="{DynamicResource Panel.Background.Level3}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>

                    <n:ExtendedButton
                        x:Name="ApplyButton"
                        Grid.Column="0"
                        MinWidth="90"
                        Margin="5"
                        Padding="2,0"
                        Command="{StaticResource Command.Ok}"
                        ContentHeight="22"
                        FontSize="13"
                        Icon="{StaticResource Vector.Ok}"
                        KeyGesture="Alt + E / Enter"
                        Text="{DynamicResource S.Action.Apply}" />

                    <n:ExtendedButton
                        x:Name="CancelButton"
                        Grid.Column="1"
                        MinWidth="90"
                        Margin="5"
                        Padding="2,0"
                        Command="{StaticResource Command.Cancel}"
                        ContentHeight="22"
                        FontSize="13"
                        Icon="{StaticResource Vector.Cancel}"
                        KeyGesture="Esc"
                        Text="{DynamicResource S.Action.Cancel}" />
                </Grid>
            </Grid>
        </Grid>

        <!--  Lower part of the Window  -->
        <ListView
            x:Name="FrameListView"
            Grid.Row="2"
            BorderThickness="0,1,0,0"
            Focusable="False"
            IsEnabled="{Binding Path=IsLoading, ElementName=EditorWindow, Converter={StaticResource InvertedBoolConverter}}"
            IsTabStop="False"
            ItemsSource="{Binding Path=DataContext.Frames, ElementName=EditorWindow}"
            PreviewKeyDown="FrameListView_PreviewKeyDown"
            SelectionChanged="FrameListView_SelectionChanged"
            Style="{StaticResource Style.ListView.Frames}"
            Visibility="{Binding RelativeSource={RelativeSource Self}, Path=HasItems, Converter={StaticResource Bool2Visibility}}">

            <ListView.Resources>
                <ContextMenu x:Key="FrameListContextMenu">
                    <n:ExtendedMenuItem
                        Command="{StaticResource Command.OpenImage}"
                        ContentHeight="16"
                        ContentWidth="16"
                        Header="{DynamicResource S.Editor.List.OpenImage}"
                        Icon="{StaticResource Vector.Image}" />
                    <n:ExtendedMenuItem
                        Command="{StaticResource Command.ExploreFolder}"
                        ContentHeight="16"
                        ContentWidth="16"
                        Header="{DynamicResource S.Editor.List.ExploreFolder}"
                        Icon="{StaticResource Vector.Open}" />
                </ContextMenu>
            </ListView.Resources>

            <ListView.ItemContainerStyle>
                <Style TargetType="ListBoxItem">
                    <EventSetter
                        Event="PreviewMouseLeftButtonDown"
                        Handler="Item_PreviewMouseLeftButtonDown" />
                    <Setter Property="ContextMenu" Value="{StaticResource FrameListContextMenu}" />
                </Style>
            </ListView.ItemContainerStyle>
        </ListView>

        <!--  Status bar  -->
        <Border
            x:Name="LowerGrid"
            Grid.Row="3"
            Height="20">
            <Grid
                x:Name="LowerStatusBar"
                Height="20"
                Background="{DynamicResource Panel.Background.Level3}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="7" />
                    <ColumnDefinition />
                    <ColumnDefinition Width="5" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="5" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="5" />
                    <ColumnDefinition Width="200" />
                </Grid.ColumnDefinitions>

                <Grid
                    x:Name="StatusGrid"
                    Grid.Column="0"
                    Visibility="Collapsed">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <Label
                        x:Name="StatusLabel"
                        Grid.Column="0"
                        Margin="5,0"
                        Padding="0"
                        VerticalContentAlignment="Center"
                        Content="Status"
                        Foreground="{DynamicResource Element.Foreground.Medium}" />
                    <ProgressBar
                        x:Name="StatusProgressBar"
                        Grid.Column="1"
                        Width="200"
                        Height="8"
                        Margin="2,0"
                        VerticalAlignment="Center" />
                    <n:ExtendedButton
                        x:Name="CancelLoadingButton"
                        Grid.Column="2"
                        Width="25"
                        Click="CancelLoadingButton_Click"
                        ContentHeight="15"
                        ContentWidth="15"
                        Icon="{StaticResource Vector.Cancel}"
                        Style="{StaticResource Style.Button.NoText}"
                        ToolTip="{DynamicResource S.Editor.CancelDiscard}"
                        Visibility="{Binding ElementName=EditorWindow, Path=IsCancelable, Converter={StaticResource Bool2Visibility}}" />
                </Grid>

                <Separator
                    Grid.Column="1"
                    Width="1"
                    Margin="3,2" />

                <StackPanel
                    x:Name="HintStackPanel"
                    Grid.Column="2"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Stretch"
                    Orientation="Horizontal"
                    ToolTip="{Binding ElementName=HintTextBlock, Path=Text}"
                    Visibility="Collapsed">
                    <Border
                        Width="14"
                        Height="14"
                        Margin="0,0,8,0"
                        VerticalAlignment="Center"
                        Background="{StaticResource Vector.Info}"
                        Opacity="{DynamicResource Element.Opacity}" />
                    <TextBlock
                        x:Name="HintTextBlock"
                        Margin="0,-1,0,0"
                        VerticalAlignment="Center"
                        FontSize="13"
                        Foreground="{DynamicResource Element.Foreground.Hint}"
                        TextDecorations="{x:Null}"
                        TextTrimming="CharacterEllipsis" />
                </StackPanel>

                <Separator
                    Grid.Column="3"
                    Width="1"
                    Margin="1,2"
                    Visibility="{Binding ElementName=WelcomeGrid, Path=Visibility, Converter={StaticResource InvertedVisibilityConverter}, ConverterParameter=0}" />

                <StackPanel
                    Grid.Column="4"
                    IsEnabled="{Binding ElementName=Zoom100Button, Path=IsEnabled}"
                    Orientation="Horizontal"
                    ToolTip="{DynamicResource S.Editor.Home.Zoom}"
                    Visibility="{Binding ElementName=WelcomeGrid, Path=Visibility, Converter={StaticResource InvertedVisibilityConverter}, ConverterParameter=0}">
                    <Border
                        Width="16"
                        Height="16"
                        Background="{StaticResource Vector.Zoom}"
                        Opacity="{DynamicResource Element.Opacity}" />
                    <n:IntegerUpDown
                        Margin="1"
                        Maximum="500"
                        Minimum="5"
                        Style="{StaticResource IntegerUpDown.Minimal}"
                        Value="{Binding Zoom, Converter={StaticResource IntToDecimalConverter}, ElementName=ZoomBoxControl, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                    <TextBlock
                        VerticalAlignment="Center"
                        Foreground="{DynamicResource Element.Foreground.Gray112}"
                        Text="%" />
                </StackPanel>

                <Separator
                    Grid.Column="5"
                    Width="1"
                    Margin="1,2"
                    Visibility="{Binding ElementName=WelcomeGrid, Path=Visibility, Converter={StaticResource InvertedVisibilityConverter}, ConverterParameter=0}" />

                <Grid
                    x:Name="InfoGrid"
                    Grid.Column="6"
                    ToolTip="{DynamicResource S.Editor.FrameNumbersInfo}"
                    ToolTipService.Placement="Bottom"
                    Visibility="{Binding ElementName=WelcomeGrid, Path=Visibility, Converter={StaticResource InvertedVisibilityConverter}, ConverterParameter=0}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <Label
                        Grid.Column="0"
                        Margin="3,0,3,0"
                        Padding="0"
                        VerticalContentAlignment="Center"
                        Content="{Binding ElementName=FrameListView, Path=Items.Count}"
                        FontSize="14"
                        Foreground="#FF00A000" />
                    <Label
                        Grid.Column="1"
                        Margin="3,0,3,0"
                        Padding="0"
                        VerticalContentAlignment="Center"
                        Content="{Binding ElementName=FrameListView, Path=SelectedItems.Count}"
                        FontSize="14"
                        Foreground="#FFC80000" />
                    <Label
                        Grid.Column="2"
                        Margin="3,0,3,0"
                        Padding="0"
                        VerticalContentAlignment="Center"
                        Content="{Binding ElementName=FrameListView, Path=SelectedIndex}"
                        FontSize="14"
                        Foreground="#FF0064C8" />
                </Grid>

                <Separator
                    Grid.Column="7"
                    Width="1"
                    Margin="1,2" />

                <Grid
                    x:Name="CommandGrid"
                    Grid.Column="8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="40" />
                        <ColumnDefinition Width="40" />
                        <ColumnDefinition Width="40" />
                        <ColumnDefinition Width="40" />
                        <ColumnDefinition Width="40" />
                    </Grid.ColumnDefinitions>

                    <n:ExtendedButton
                        x:Name="FirstRepeatButton"
                        Grid.Column="0"
                        Width="40"
                        Command="{StaticResource Command.FirstFrame}"
                        ContentHeight="12"
                        ContentWidth="20"
                        Icon="{StaticResource Vector.First.Green}"
                        Style="{StaticResource Style.Button.NoText}"
                        Text=""
                        ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                        ToolTipService.HorizontalOffset="-5"
                        ToolTipService.Placement="Bottom" />
                    <n:ExtendedRepeatButton
                        x:Name="PreviousRepeatButton"
                        Grid.Column="1"
                        Width="40"
                        Command="{StaticResource Command.PreviousFrame}"
                        ContentHeight="17"
                        ContentWidth="17"
                        Icon="{StaticResource Vector.Previous.Green}"
                        Style="{StaticResource Style.RepeatButton.NoText}"
                        ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                        ToolTipService.HorizontalOffset="-5"
                        ToolTipService.Placement="Bottom" />

                    <n:ExtendedButton
                        x:Name="PlayPauseButton"
                        Grid.Column="2"
                        Width="40"
                        Command="{StaticResource Command.Play}"
                        ContentHeight="15"
                        ContentWidth="15"
                        Icon="{StaticResource Vector.Play}"
                        Style="{StaticResource Style.Button.NoText}"
                        ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                        ToolTipService.HorizontalOffset="-5"
                        ToolTipService.Placement="Bottom" />

                    <n:ExtendedRepeatButton
                        x:Name="NextRepeatButton"
                        Grid.Column="3"
                        Width="40"
                        Command="{StaticResource Command.NextFrame}"
                        ContentHeight="17"
                        ContentWidth="17"
                        Icon="{StaticResource Vector.Next.Green}"
                        Style="{StaticResource Style.RepeatButton.NoText}"
                        ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                        ToolTipService.HorizontalOffset="-5"
                        ToolTipService.Placement="Bottom" />
                    <n:ExtendedButton
                        x:Name="LastRepeatButton"
                        Grid.Column="4"
                        Width="40"
                        Command="{StaticResource Command.LastFrame}"
                        ContentHeight="12"
                        ContentWidth="20"
                        Icon="{StaticResource Vector.Last.Green}"
                        Style="{StaticResource Style.Button.NoText}"
                        ToolTip="{Binding Command, RelativeSource={RelativeSource Self}, Converter={StaticResource CommandToInputGestureText}}"
                        ToolTipService.HorizontalOffset="-5"
                        ToolTipService.Placement="Bottom" />
                </Grid>
            </Grid>
        </Border>
    </Grid>
</n:ExWindow>